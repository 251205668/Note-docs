<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>vue全家桶开发音乐app | 前端面试知识总结</title>
    <meta name="description" content="自家使用,暂不外传">
    <meta name="generator" content="VuePress 1.3.1">
    <link rel="icon" href="/favicon.ico">
    
    <link rel="preload" href="/assets/css/0.styles.6a4803ab.css" as="style"><link rel="preload" href="/assets/js/app.81dd3622.js" as="script"><link rel="preload" href="/assets/js/2.d1b1e148.js" as="script"><link rel="preload" href="/assets/js/3.103e70cb.js" as="script"><link rel="preload" href="/assets/js/4.a3faee54.js" as="script"><link rel="prefetch" href="/assets/js/10.42124fbe.js"><link rel="prefetch" href="/assets/js/11.bdef2e64.js"><link rel="prefetch" href="/assets/js/12.9c5e83ed.js"><link rel="prefetch" href="/assets/js/13.3db43aaf.js"><link rel="prefetch" href="/assets/js/14.8f2ec86d.js"><link rel="prefetch" href="/assets/js/15.c6286125.js"><link rel="prefetch" href="/assets/js/16.5da2b31d.js"><link rel="prefetch" href="/assets/js/17.c9deef07.js"><link rel="prefetch" href="/assets/js/18.13ed30af.js"><link rel="prefetch" href="/assets/js/19.f1a01180.js"><link rel="prefetch" href="/assets/js/20.30f7288c.js"><link rel="prefetch" href="/assets/js/21.477730e4.js"><link rel="prefetch" href="/assets/js/22.ab119ff1.js"><link rel="prefetch" href="/assets/js/23.9bbc22fc.js"><link rel="prefetch" href="/assets/js/24.cb1899b8.js"><link rel="prefetch" href="/assets/js/25.64669f1d.js"><link rel="prefetch" href="/assets/js/26.f3040183.js"><link rel="prefetch" href="/assets/js/27.2938dd4c.js"><link rel="prefetch" href="/assets/js/28.cd87026d.js"><link rel="prefetch" href="/assets/js/29.b92287f4.js"><link rel="prefetch" href="/assets/js/30.af43d48f.js"><link rel="prefetch" href="/assets/js/31.8c7148f5.js"><link rel="prefetch" href="/assets/js/32.d42beb3f.js"><link rel="prefetch" href="/assets/js/33.223bba8e.js"><link rel="prefetch" href="/assets/js/34.04b12083.js"><link rel="prefetch" href="/assets/js/35.19c65fa0.js"><link rel="prefetch" href="/assets/js/36.a1a664b9.js"><link rel="prefetch" href="/assets/js/37.d2e7a2dd.js"><link rel="prefetch" href="/assets/js/38.4f737159.js"><link rel="prefetch" href="/assets/js/39.fcdeadea.js"><link rel="prefetch" href="/assets/js/40.40a9daf9.js"><link rel="prefetch" href="/assets/js/5.2f32d917.js"><link rel="prefetch" href="/assets/js/6.d92ecc16.js"><link rel="prefetch" href="/assets/js/7.a09f8ef2.js"><link rel="prefetch" href="/assets/js/8.5b00daa2.js"><link rel="prefetch" href="/assets/js/9.9d06f44a.js">
    <link rel="stylesheet" href="/assets/css/0.styles.6a4803ab.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">前端面试知识总结</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/guide/" class="nav-link">
  指南
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="项目" class="dropdown-title"><span class="title">项目</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/project/shop/" class="nav-link">
  大型电商
</a></li><li class="dropdown-item"><!----> <a href="/project/music/" class="nav-link router-link-exact-active router-link-active">
  vue实现音乐app
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/guide/" class="nav-link">
  指南
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="项目" class="dropdown-title"><span class="title">项目</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/project/shop/" class="nav-link">
  大型电商
</a></li><li class="dropdown-item"><!----> <a href="/project/music/" class="nav-link router-link-exact-active router-link-active">
  vue实现音乐app
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Music Webapp</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/project/music/" class="active sidebar-link">vue全家桶开发音乐app</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/project/music/#简介" class="sidebar-link">简介</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/project/music/#项目使用到的技术" class="sidebar-link">项目使用到的技术</a></li><li class="sidebar-sub-header"><a href="/project/music/#项目基本目录" class="sidebar-link">项目基本目录</a></li><li class="sidebar-sub-header"><a href="/project/music/#项目开发基本流程" class="sidebar-link">项目开发基本流程</a></li><li class="sidebar-sub-header"><a href="/project/music/#该项目包含到的基本组件库" class="sidebar-link">该项目包含到的基本组件库</a></li></ul></li><li class="sidebar-sub-header"><a href="/project/music/#初始化项目" class="sidebar-link">初始化项目</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/project/music/#创建项目" class="sidebar-link">创建项目</a></li><li class="sidebar-sub-header"><a href="/project/music/#初始化" class="sidebar-link">初始化</a></li><li class="sidebar-sub-header"><a href="/project/music/#项目中需要用到的插件" class="sidebar-link">项目中需要用到的插件</a></li><li class="sidebar-sub-header"><a href="/project/music/#路由配置" class="sidebar-link">路由配置</a></li></ul></li><li class="sidebar-sub-header"><a href="/project/music/#开发" class="sidebar-link">开发</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/project/music/#header组件" class="sidebar-link">Header组件</a></li><li class="sidebar-sub-header"><a href="/project/music/#tab组件" class="sidebar-link">Tab组件</a></li><li class="sidebar-sub-header"><a href="/project/music/#recommend页面" class="sidebar-link">Recommend页面</a></li><li class="sidebar-sub-header"><a href="/project/music/#推荐歌单页面" class="sidebar-link">推荐歌单页面</a></li><li class="sidebar-sub-header"><a href="/project/music/#singer组件" class="sidebar-link">singer组件</a></li><li class="sidebar-sub-header"><a href="/project/music/#实现列表和索引表" class="sidebar-link">实现列表和索引表</a></li><li class="sidebar-sub-header"><a href="/project/music/#索引列表联动实现" class="sidebar-link">索引列表联动实现</a></li><li class="sidebar-sub-header"><a href="/project/music/#歌手详情页" class="sidebar-link">歌手详情页</a></li><li class="sidebar-sub-header"><a href="/project/music/#播放器组件" class="sidebar-link">播放器组件</a></li><li class="sidebar-sub-header"><a href="/project/music/#💙播放器部分" class="sidebar-link">💙播放器部分</a></li></ul></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="vue全家桶开发音乐app"><a href="#vue全家桶开发音乐app" class="header-anchor">#</a> vue全家桶开发音乐app</h1> <h2 id="简介"><a href="#简介" class="header-anchor">#</a> 简介</h2> <p><a href="https://github.com/vuejs/vue" target="_blank" rel="noopener noreferrer"><img src="https://img.shields.io/badge/vue-2.6.10-brightgreen.svg" alt="vue"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> <a href="https://github.com/ElemeFE/element" target="_blank" rel="noopener noreferrer"><img src="https://img.shields.io/badge/element--ui-2.7.0-brightgreen.svg" alt="element-ui"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p><a href="http://music.yangxainsheng.top" target="_blank" rel="noopener noreferrer">项目体验<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <div class="custom-block warning"><p class="custom-block-title">WARNING</p> <p>项目是用vuecli 2.9构建 用vuecli 3.x的用户自行重构部分代码</p></div> <h3 id="项目使用到的技术"><a href="#项目使用到的技术" class="header-anchor">#</a> 项目使用到的技术</h3> <div class="language-markdown extra-class"><pre class="language-markdown"><code>MVVM框架：Vue.js （版本2.x）
状态管理：Vuex
前端路由：Vue Router
服务端通讯：axios、jsonp
移动端滚动库：better-scroll
构建工具：webpack 2.0
源码：es6
</code></pre></div><h3 id="项目基本目录"><a href="#项目基本目录" class="header-anchor">#</a> 项目基本目录</h3> <div class="language- extra-class"><pre class="language-text"><code> .
├── README.md
├── build
│   ├── build.js
│   ├── check-versions.js
│   ├── dev-client.js
│   ├── dev-server.js
│   ├── utils.js
│   ├── vue-loader.conf.js
│   ├── webpack.base.conf.js
│   ├── webpack.dev.conf.js
│   └── webpack.prod.conf.js
├── config
│   ├── dev.env.js
│   ├── index.js
│   └── prod.env.js
├── index.html
├── package.json
├── prod.server.js
├── src
│   ├── App.vue
│   ├── api
│   │   ├── config.js
│   │   ├── rank.js
│   │   ├── recommend.js
│   │   ├── search.js
│   │   ├── singer.js
│   │   └── song.js
│   ├── base
│   │   ├── confirm
│   │   │   └── confirm.vue
│   │   ├── listview
│   │   │   └── listview.vue
│   │   ├── loading
│   │   │   ├── loading.gif
│   │   │   └── loading.vue
│   │   ├── no-result
│   │   │   ├── no-result.vue
│   │   │   ├── no-result@2x.png
│   │   │   └── no-result@3x.png
│   │   ├── progress-bar
│   │   │   └── progress-bar.vue
│   │   ├── progress-circle
│   │   │   └── progress-circle.vue
│   │   ├── scroll
│   │   │   └── scroll.vue
│   │   ├── search-box
│   │   │   └── search-box.vue
│   │   ├── search-list
│   │   │   └── search-list.vue
│   │   ├── slider
│   │   │   └── slider.vue
│   │   ├── song-list
│   │   │   ├── first@2x.png
│   │   │   ├── first@3x.png
│   │   │   ├── second@2x.png
│   │   │   ├── second@3x.png
│   │   │   ├── song-list.vue
│   │   │   ├── third@2x.png
│   │   │   └── third@3x.png
│   │   ├── switches
│   │   │   └── switches.vue
│   │   └── top-tip
│   │       └── top-tip.vue
│   ├── common
│   │   ├── fonts
│   │   │   ├── music-icon.eot
│   │   │   ├── music-icon.svg
│   │   │   ├── music-icon.ttf
│   │   │   └── music-icon.woff
│   │   ├── image
│   │   │   └── default.png
│   │   ├── js
│   │   │   ├── cache.js
│   │   │   ├── config.js
│   │   │   ├── dom.js
│   │   │   ├── jsonp.js
│   │   │   ├── mixin.js
│   │   │   ├── singer.js
│   │   │   ├── song.js
│   │   │   └── util.js
│   │   └── stylus
│   │       ├── base.styl
│   │       ├── icon.styl
│   │       ├── index.styl
│   │       ├── mixin.styl
│   │       ├── reset.styl
│   │       └── variable.styl
│   ├── components
│   │   ├── add-song
│   │   │   └── add-song.vue
│   │   ├── disc
│   │   │   └── disc.vue
│   │   ├── m-header
│   │   │   ├── logo@2x.png
│   │   │   ├── logo@3x.png
│   │   │   └── m-header.vue
│   │   ├── music-list
│   │   │   └── music-list.vue
│   │   ├── player
│   │   │   └── player.vue
│   │   ├── playlist
│   │   │   └── playlist.vue
│   │   ├── rank
│   │   │   └── rank.vue
│   │   ├── recommend
│   │   │   └── recommend.vue
│   │   ├── search
│   │   │   └── search.vue
│   │   ├── singer
│   │   │   └── singer.vue
│   │   ├── singer-detail
│   │   │   └── singer-detail.vue
│   │   ├── suggest
│   │   │   └── suggest.vue
│   │   ├── tab
│   │   │   └── tab.vue
│   │   ├── top-list
│   │   │   └── top-list.vue
│   │   └── user-center
│   │       └── user-center.vue
│   ├── main.js
│   ├── router
│   │   └── index.js
│   └── store
│       ├── actions.js
│       ├── getters.js
│       ├── index.js
│       ├── mutation-types.js
│       ├── mutations.js
│       └── state.js
└── static
    ├── 1.png
    ├── 2.png
    ├── 3.png
    ├── 4.png
    └── 5.png


</code></pre></div><h3 id="项目开发基本流程"><a href="#项目开发基本流程" class="header-anchor">#</a> 项目开发基本流程</h3> <p><img src="/assets/img/2019-11-11-20-41-17.cd5ad9a4.png" alt=""></p> <h3 id="该项目包含到的基本组件库"><a href="#该项目包含到的基本组件库" class="header-anchor">#</a> 该项目包含到的基本组件库</h3> <p><strong>基础组件</strong></p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token number">1</span>.confirm：确认对话框组件
<span class="token number">2</span>.listview：通讯录列表组件
<span class="token number">3</span>.loading：加载态组件
<span class="token number">4</span>.no-result：无结果展示组件
<span class="token number">5</span>.progress-bar：进度条组件
<span class="token number">6</span>.progress-circle：圆形进度条组件
<span class="token number">7</span>.scroll：移动端滚动组件
<span class="token number">8</span>.search-box：搜索框组件
<span class="token number">9</span>.search-list：搜索列表组件
<span class="token number">10</span>.slider：轮播图组件
<span class="token number">11</span>.switches：开关切换组件
<span class="token number">12</span>.top-tip：顶部消息提示组件
<span class="token number">1</span>.  song-list：歌曲列表组件
</code></pre></div><p><strong>业务组件</strong></p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token number">1</span>.add-song：添加歌曲到列表组件
<span class="token number">2</span>.disc：歌单详情页组件
<span class="token number">3</span>.m-header：页面头部组件
<span class="token number">4</span>.music-list：歌曲列表页面组件
<span class="token number">5</span>.player：播放器内核组件
<span class="token number">6</span>.playlist：播放列表组件
<span class="token number">7</span>.rank：排行榜页面组件
<span class="token number">8</span>.recommend：推荐页面组件
<span class="token number">9</span>.search：搜索页面组件
<span class="token number">10</span>.singer：歌手页面组件
<span class="token number">11</span>.singer-detail：歌手详情页组件
<span class="token number">12</span>.suggest：搜索提示列表组件
<span class="token number">13</span>.tab：顶部导航栏组件
<span class="token number">14</span>.top-list：排行榜详情页组件
<span class="token number">15</span>.user-center：用户中心页组件
</code></pre></div><h2 id="初始化项目"><a href="#初始化项目" class="header-anchor">#</a> 初始化项目</h2> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>再开始开发项目之前，你必须要创建项目，并且安装好开发要用的依赖 插件等</p></div> <h3 id="创建项目"><a href="#创建项目" class="header-anchor">#</a> 创建项目</h3> <ul><li>创建项目</li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code>$ vue init webpack XXXX
</code></pre></div><div class="custom-block warning"><p class="custom-block-title">WARNING</p> <p>vuecli3 开发 vue create XXXX</p></div> <h3 id="初始化"><a href="#初始化" class="header-anchor">#</a> 初始化</h3> <ul><li>设计目录结构
<img src="/assets/img/2019-11-11-20-51-06.16a9ea53.png" alt=""></li> <li>移动端初始化缩放</li></ul> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span>
  <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>viewport<span class="token punctuation">&quot;</span></span>
  <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>width=device-width,initial-scale=1.0 minimum-scale=1.0 maximum-scale=1.0 user-scalable=no<span class="token punctuation">&quot;</span></span>
<span class="token punctuation">/&gt;</span></span>
</code></pre></div><ul><li>初始化样式 并且写好项目要用到的<strong>icon 样式</strong> 全局样式 背景图调用样式 等<div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>样式和字体图标的 svg 文件建议放在 common 里面</p></div> <img src="/assets/img/2019-11-11-20-56-47.ed99b53d.png" alt=""> <br>
reset.styl</li></ul> <div class="language-stylus extra-class"><pre class="language-stylus"><code><span class="token comment">/**
 * Eric Meyer's Reset CSS v2.0 (http://meyerweb.com/eric/tools/css/reset/)
 * http://cssreset.com
 */</span>
<span class="token selector">html<span class="token punctuation">,</span> body<span class="token punctuation">,</span> div<span class="token punctuation">,</span> span<span class="token punctuation">,</span> applet<span class="token punctuation">,</span> object<span class="token punctuation">,</span> iframe<span class="token punctuation">,</span>
h1<span class="token punctuation">,</span> h2<span class="token punctuation">,</span> h3<span class="token punctuation">,</span> h4<span class="token punctuation">,</span> h5<span class="token punctuation">,</span> h6<span class="token punctuation">,</span> p<span class="token punctuation">,</span> blockquote<span class="token punctuation">,</span> pre<span class="token punctuation">,</span>
a<span class="token punctuation">,</span> abbr<span class="token punctuation">,</span> acronym<span class="token punctuation">,</span> address<span class="token punctuation">,</span> big<span class="token punctuation">,</span> cite<span class="token punctuation">,</span> code<span class="token punctuation">,</span>
del<span class="token punctuation">,</span> dfn<span class="token punctuation">,</span> em<span class="token punctuation">,</span> img<span class="token punctuation">,</span> ins<span class="token punctuation">,</span> kbd<span class="token punctuation">,</span> q<span class="token punctuation">,</span> s<span class="token punctuation">,</span> samp<span class="token punctuation">,</span>
small<span class="token punctuation">,</span> strike<span class="token punctuation">,</span> strong<span class="token punctuation">,</span> sub<span class="token punctuation">,</span> sup<span class="token punctuation">,</span> tt<span class="token punctuation">,</span> var<span class="token punctuation">,</span>
b<span class="token punctuation">,</span> u<span class="token punctuation">,</span> i<span class="token punctuation">,</span> center<span class="token punctuation">,</span>
dl<span class="token punctuation">,</span> dt<span class="token punctuation">,</span> dd<span class="token punctuation">,</span> ol<span class="token punctuation">,</span> ul<span class="token punctuation">,</span> li<span class="token punctuation">,</span>
fieldset<span class="token punctuation">,</span> form<span class="token punctuation">,</span> label<span class="token punctuation">,</span> legend<span class="token punctuation">,</span>
table<span class="token punctuation">,</span> caption<span class="token punctuation">,</span> tbody<span class="token punctuation">,</span> tfoot<span class="token punctuation">,</span> thead<span class="token punctuation">,</span> tr<span class="token punctuation">,</span> th<span class="token punctuation">,</span> td<span class="token punctuation">,</span>
article<span class="token punctuation">,</span> aside<span class="token punctuation">,</span> canvas<span class="token punctuation">,</span> details<span class="token punctuation">,</span> embed<span class="token punctuation">,</span>
figure<span class="token punctuation">,</span> figcaption<span class="token punctuation">,</span> footer<span class="token punctuation">,</span> header<span class="token punctuation">,</span>
menu<span class="token punctuation">,</span> nav<span class="token punctuation">,</span> output<span class="token punctuation">,</span> ruby<span class="token punctuation">,</span> section<span class="token punctuation">,</span> summary<span class="token punctuation">,</span>
time<span class="token punctuation">,</span> mark<span class="token punctuation">,</span> audio<span class="token punctuation">,</span> video<span class="token punctuation">,</span> input</span>
  <span class="token property-declaration"><span class="token property">margin</span><span class="token punctuation">:</span> <span class="token number">0</span></span>
  <span class="token property-declaration"><span class="token property">padding</span><span class="token punctuation">:</span> <span class="token number">0</span></span>
  <span class="token property-declaration"><span class="token property">border</span><span class="token punctuation">:</span> <span class="token number">0</span></span>
  <span class="token property-declaration"><span class="token property">font-size</span><span class="token punctuation">:</span> <span class="token number">100%</span></span>
  <span class="token property-declaration"><span class="token property">font-weight</span><span class="token punctuation">:</span> normal</span>
  <span class="token property-declaration"><span class="token property">vertical-align</span><span class="token punctuation">:</span> baseline</span>

<span class="token comment">/* HTML5 display-role reset for older browsers */</span>
<span class="token selector">article<span class="token punctuation">,</span> aside<span class="token punctuation">,</span> details<span class="token punctuation">,</span> figcaption<span class="token punctuation">,</span> figure<span class="token punctuation">,</span>
footer<span class="token punctuation">,</span> header<span class="token punctuation">,</span> menu<span class="token punctuation">,</span> nav<span class="token punctuation">,</span> section</span>
  <span class="token property-declaration"><span class="token property">display</span><span class="token punctuation">:</span> block</span>

<span class="token selector">body</span>
  <span class="token property-declaration"><span class="token property">line-height</span><span class="token punctuation">:</span> <span class="token number">1</span></span>

<span class="token selector">blockquote<span class="token punctuation">,</span> q</span>
  <span class="token property-declaration"><span class="token property">quotes</span><span class="token punctuation">:</span> none</span>

<span class="token selector">blockquote:before<span class="token punctuation">,</span> blockquote:after<span class="token punctuation">,</span>
q:before<span class="token punctuation">,</span> q:after</span>
  <span class="token property-declaration"><span class="token property">content</span><span class="token punctuation">:</span> none</span>

<span class="token selector">table</span>
  <span class="token property-declaration"><span class="token property">border-collapse</span><span class="token punctuation">:</span> collapse</span>
  <span class="token property-declaration"><span class="token property">border-spacing</span><span class="token punctuation">:</span> <span class="token number">0</span></span>

<span class="token comment">/* custom */</span>

<span class="token selector">a</span>
  <span class="token property-declaration"><span class="token property">color</span><span class="token punctuation">:</span> #<span class="token hexcode">#7e8c8d</span></span>
  <span class="token property-declaration"><span class="token property">-webkit-backface-visibility</span><span class="token punctuation">:</span> hidden</span>
  <span class="token property-declaration"><span class="token property">text-decoration</span><span class="token punctuation">:</span> none</span>

<span class="token selector">li</span>
  <span class="token property-declaration"><span class="token property">list-style</span><span class="token punctuation">:</span> none</span>

<span class="token selector">body</span>
  <span class="token property-declaration"><span class="token property">-webkit-text-size-adjust</span><span class="token punctuation">:</span> none</span>
  <span class="token property-declaration"><span class="token property">-webkit-tap-highlight-color</span><span class="token punctuation">:</span> <span class="token func"><span class="token function">rgba</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span></span></span>

</code></pre></div><p>icon.styl</p> <div class="language-stylus extra-class"><pre class="language-stylus"><code><span class="token atrule-declaration"><span class="token atrule">@font-face</span></span>
  <span class="token property-declaration"><span class="token property">font-family</span><span class="token punctuation">:</span> <span class="token string">'music-icon'</span></span>
  <span class="token property-declaration"><span class="token property">src</span><span class="token punctuation">:</span> <span class="token url">url('../fonts/music-icon.eot?2qevqt')</span></span>
  src<span class="token punctuation">:</span> <span class="token func"><span class="token function">url</span><span class="token punctuation">(</span><span class="token string">'../fonts/music-icon.eot?2qevqt##iefix'</span><span class="token punctuation">)</span> format<span class="token punctuation">(</span><span class="token string">'embedded-opentype'</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
          <span class="token func"><span class="token function">url</span><span class="token punctuation">(</span><span class="token string">'../fonts/music-icon.ttf?2qevqt'</span><span class="token punctuation">)</span> format<span class="token punctuation">(</span><span class="token string">'truetype'</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
          <span class="token func"><span class="token function">url</span><span class="token punctuation">(</span><span class="token string">'../fonts/music-icon.woff?2qevqt'</span><span class="token punctuation">)</span> format<span class="token punctuation">(</span><span class="token string">'woff'</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
          <span class="token func"><span class="token function">url</span><span class="token punctuation">(</span><span class="token string">'../fonts/music-icon.svg?2qevqt##music-icon'</span><span class="token punctuation">)</span> format<span class="token punctuation">(</span><span class="token string">'svg'</span><span class="token punctuation">)</span></span>
  <span class="token property-declaration"><span class="token property">font-weight</span><span class="token punctuation">:</span> normal</span>
  <span class="token property-declaration"><span class="token property">font-style</span><span class="token punctuation">:</span> normal</span>

<span class="token selector">[class^=&quot;icon-&quot;]<span class="token punctuation">,</span> [class*=&quot; icon-&quot;]</span>
  <span class="token comment">/* use !important to prevent issues with browser extensions that change fonts */</span>
  <span class="token property-declaration"><span class="token property">font-family</span><span class="token punctuation">:</span> <span class="token string">'music-icon'</span> <span class="token important">!important</span></span>
  <span class="token property-declaration"><span class="token property">speak</span><span class="token punctuation">:</span> none</span>
  <span class="token property-declaration"><span class="token property">font-style</span><span class="token punctuation">:</span> normal</span>
  <span class="token property-declaration"><span class="token property">font-weight</span><span class="token punctuation">:</span> normal</span>
  <span class="token property-declaration"><span class="token property">font-variant</span><span class="token punctuation">:</span> normal</span>
  <span class="token property-declaration"><span class="token property">text-transform</span><span class="token punctuation">:</span> none</span>
  <span class="token property-declaration"><span class="token property">line-height</span><span class="token punctuation">:</span> <span class="token number">1</span></span>

  <span class="token comment">/* Better Font Rendering =========== */</span>
  <span class="token property-declaration"><span class="token property">-webkit-font-smoothing</span><span class="token punctuation">:</span> antialiased</span>
  <span class="token property-declaration"><span class="token property">-moz-osx-font-smoothing</span><span class="token punctuation">:</span> grayscale</span>

<span class="token selector">.icon-ok:before</span>
  <span class="token property-declaration"><span class="token property">content</span><span class="token punctuation">:</span> <span class="token string">&quot;\e900&quot;</span></span>

<span class="token selector">.icon-close:before</span>
  <span class="token property-declaration"><span class="token property">content</span><span class="token punctuation">:</span> <span class="token string">&quot;\e901&quot;</span></span>

<span class="token selector">.icon-add:before</span>
  <span class="token property-declaration"><span class="token property">content</span><span class="token punctuation">:</span> <span class="token string">&quot;\e902&quot;</span></span>

<span class="token selector">.icon-play-mini:before</span>
  <span class="token property-declaration"><span class="token property">content</span><span class="token punctuation">:</span> <span class="token string">&quot;\e903&quot;</span></span>

<span class="token selector">.icon-playlist:before</span>
  <span class="token property-declaration"><span class="token property">content</span><span class="token punctuation">:</span> <span class="token string">&quot;\e904&quot;</span></span>

<span class="token selector">.icon-music:before</span>
  <span class="token property-declaration"><span class="token property">content</span><span class="token punctuation">:</span> <span class="token string">&quot;\e905&quot;</span></span>

<span class="token selector">.icon-search:before</span>
  <span class="token property-declaration"><span class="token property">content</span><span class="token punctuation">:</span> <span class="token string">&quot;\e906&quot;</span></span>

<span class="token selector">.icon-clear:before</span>
  <span class="token property-declaration"><span class="token property">content</span><span class="token punctuation">:</span> <span class="token string">&quot;\e907&quot;</span></span>

<span class="token selector">.icon-delete:before</span>
  <span class="token property-declaration"><span class="token property">content</span><span class="token punctuation">:</span> <span class="token string">&quot;\e908&quot;</span></span>

<span class="token selector">.icon-favorite:before</span>
  <span class="token property-declaration"><span class="token property">content</span><span class="token punctuation">:</span> <span class="token string">&quot;\e909&quot;</span></span>

<span class="token selector">.icon-not-favorite:before</span>
  <span class="token property-declaration"><span class="token property">content</span><span class="token punctuation">:</span> <span class="token string">&quot;\e90a&quot;</span></span>

<span class="token selector">.icon-pause:before</span>
  <span class="token property-declaration"><span class="token property">content</span><span class="token punctuation">:</span> <span class="token string">&quot;\e90b&quot;</span></span>

<span class="token selector">.icon-play:before</span>
  <span class="token property-declaration"><span class="token property">content</span><span class="token punctuation">:</span> <span class="token string">&quot;\e90c&quot;</span></span>

<span class="token selector">.icon-prev:before</span>
  <span class="token property-declaration"><span class="token property">content</span><span class="token punctuation">:</span> <span class="token string">&quot;\e90d&quot;</span></span>

<span class="token selector">.icon-loop:before</span>
  <span class="token property-declaration"><span class="token property">content</span><span class="token punctuation">:</span> <span class="token string">&quot;\e90e&quot;</span></span>

<span class="token selector">.icon-sequence:before</span>
  <span class="token property-declaration"><span class="token property">content</span><span class="token punctuation">:</span> <span class="token string">&quot;\e90f&quot;</span></span>

<span class="token selector">.icon-random:before</span>
  <span class="token property-declaration"><span class="token property">content</span><span class="token punctuation">:</span> <span class="token string">&quot;\e910&quot;</span></span>

<span class="token selector">.icon-back:before</span>
  <span class="token property-declaration"><span class="token property">content</span><span class="token punctuation">:</span> <span class="token string">&quot;\e911&quot;</span></span>

<span class="token selector">.icon-mine:before</span>
  <span class="token property-declaration"><span class="token property">content</span><span class="token punctuation">:</span> <span class="token string">&quot;\e912&quot;</span></span>

<span class="token selector">.icon-next:before</span>
  <span class="token property-declaration"><span class="token property">content</span><span class="token punctuation">:</span> <span class="token string">&quot;\e913&quot;</span></span>

<span class="token selector">.icon-dismiss:before</span>
  <span class="token property-declaration"><span class="token property">content</span><span class="token punctuation">:</span> <span class="token string">&quot;\e914&quot;</span></span>

<span class="token selector">.icon-pause-mini:before</span>
  <span class="token property-declaration"><span class="token property">content</span><span class="token punctuation">:</span> <span class="token string">&quot;\e915&quot;</span></span>

</code></pre></div><p>variable.styl</p> <div class="language-stylus extra-class"><pre class="language-stylus"><code><span class="token comment">// ! 颜色定义规范</span>
<span class="token variable-declaration"><span class="token variable">$color-background</span> <span class="token operator">=</span> #<span class="token hexcode">#222</span></span>
<span class="token variable-declaration"><span class="token variable">$color-background-d</span> <span class="token operator">=</span> <span class="token func"><span class="token function">rgba</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0.3</span><span class="token punctuation">)</span></span></span>
<span class="token variable-declaration"><span class="token variable">$color-highlight-background</span> <span class="token operator">=</span> #<span class="token hexcode">#333</span></span>
<span class="token variable-declaration"><span class="token variable">$color-dialog-background</span> <span class="token operator">=</span> #<span class="token hexcode">#666</span></span>
<span class="token variable-declaration"><span class="token variable">$color-theme</span> <span class="token operator">=</span> #<span class="token hexcode">#ffcd32</span></span>
<span class="token variable-declaration"><span class="token variable">$color-theme-d</span> <span class="token operator">=</span> <span class="token func"><span class="token function">rgba</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">205</span><span class="token punctuation">,</span> <span class="token number">49</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">)</span></span></span>
<span class="token variable-declaration"><span class="token variable">$color-sub-theme</span> <span class="token operator">=</span> #<span class="token hexcode">#d93f30</span></span>
<span class="token variable-declaration"><span class="token variable">$color-text</span> <span class="token operator">=</span> #<span class="token hexcode">#fff</span></span>
<span class="token variable-declaration"><span class="token variable">$color-text-d</span> <span class="token operator">=</span> <span class="token func"><span class="token function">rgba</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">0.3</span><span class="token punctuation">)</span></span></span>
<span class="token variable-declaration"><span class="token variable">$color-text-l</span> <span class="token operator">=</span> <span class="token func"><span class="token function">rgba</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">)</span></span></span>
<span class="token variable-declaration"><span class="token variable">$color-text-ll</span> <span class="token operator">=</span> <span class="token func"><span class="token function">rgba</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">0.8</span><span class="token punctuation">)</span></span></span>
<span class="token comment">// !字体定义规范</span>
<span class="token variable-declaration"><span class="token variable">$font-size-small-s</span> <span class="token operator">=</span> <span class="token number">10</span>px</span>
<span class="token variable-declaration"><span class="token variable">$font-size-small</span> <span class="token operator">=</span> <span class="token number">12</span>px</span>
<span class="token variable-declaration"><span class="token variable">$font-size-medium</span> <span class="token operator">=</span> <span class="token number">14</span>px</span>
<span class="token variable-declaration"><span class="token variable">$font-size-medium-x</span> <span class="token operator">=</span> <span class="token number">16</span>px</span>
<span class="token variable-declaration"><span class="token variable">$font-size-large</span> <span class="token operator">=</span> <span class="token number">18</span>px</span>
<span class="token variable-declaration"><span class="token variable">$font-size-large-x</span> <span class="token operator">=</span> <span class="token number">22</span>px</span>

</code></pre></div><p>base.styl</p> <div class="language-stylus extra-class"><pre class="language-stylus"><code><span class="token atrule-declaration"><span class="token atrule">@import</span> <span class="token string">&quot;variable.styl&quot;</span></span>

<span class="token selector">body<span class="token punctuation">,</span> html</span>
  <span class="token property-declaration"><span class="token property">line-height</span><span class="token punctuation">:</span> <span class="token number">1</span></span>
  <span class="token property-declaration"><span class="token property">font-family</span><span class="token punctuation">:</span> <span class="token string">'PingFang SC'</span><span class="token punctuation">,</span> <span class="token string">'STHeitiSC-Light'</span><span class="token punctuation">,</span> <span class="token string">'Helvetica-Light'</span><span class="token punctuation">,</span> arial<span class="token punctuation">,</span> sans-serif<span class="token punctuation">,</span> <span class="token string">'Droid Sans Fallback'</span></span>
  <span class="token property-declaration"><span class="token property">user-select</span><span class="token punctuation">:</span> none</span>
  <span class="token property-declaration"><span class="token property">-webkit-tap-highlight-color</span><span class="token punctuation">:</span> transparent</span>
  <span class="token property-declaration"><span class="token property">background</span><span class="token punctuation">:</span> $color-background</span>
  <span class="token property-declaration"><span class="token property">color</span><span class="token punctuation">:</span> $color-text</span>
</code></pre></div><p>mixin.styl</p> <div class="language-stylus extra-class"><pre class="language-stylus"><code><span class="token comment">// 背景图片</span>
<span class="token func"><span class="token function">bg-image</span><span class="token punctuation">(</span>$url<span class="token punctuation">)</span></span>
  <span class="token property-declaration"><span class="token property">background-image</span><span class="token punctuation">:</span> <span class="token url">url($url + &quot;@2x.png&quot;)</span></span>
  <span class="token atrule-declaration"><span class="token atrule">@media</span> <span class="token punctuation">(</span>-webkit-min-device-pixel-ratio<span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span>min-device-pixel-ratio<span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">)</span></span>
    <span class="token property-declaration"><span class="token property">background-image</span><span class="token punctuation">:</span> <span class="token url">url($url + &quot;@3x.png&quot;)</span></span>

<span class="token comment">// 不换行</span>
<span class="token func"><span class="token function">no-wrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
  <span class="token property-declaration"><span class="token property">text-overflow</span><span class="token punctuation">:</span> ellipsis</span>
  <span class="token property-declaration"><span class="token property">overflow</span><span class="token punctuation">:</span> hidden</span>
  <span class="token property-declaration"><span class="token property">white-space</span><span class="token punctuation">:</span> nowrap</span>

<span class="token comment">// 扩展点击区域</span>
<span class="token func"><span class="token function">extend-click</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
  <span class="token property-declaration"><span class="token property">position</span><span class="token punctuation">:</span> relative</span>
  <span class="token selector">&amp;:before</span>
    <span class="token property-declaration"><span class="token property">content</span><span class="token punctuation">:</span> <span class="token string">''</span></span>
    <span class="token property-declaration"><span class="token property">position</span><span class="token punctuation">:</span> absolute</span>
    <span class="token property-declaration"><span class="token property">top</span><span class="token punctuation">:</span> <span class="token operator">-</span><span class="token number">10</span>px</span>
    <span class="token property-declaration"><span class="token property">left</span><span class="token punctuation">:</span> <span class="token operator">-</span><span class="token number">10</span>px</span>
    <span class="token property-declaration"><span class="token property">right</span><span class="token punctuation">:</span> <span class="token operator">-</span><span class="token number">10</span>px</span>
    <span class="token property-declaration"><span class="token property">bottom</span><span class="token punctuation">:</span> <span class="token operator">-</span><span class="token number">10</span>px</span>
</code></pre></div><h3 id="项目中需要用到的插件"><a href="#项目中需要用到的插件" class="header-anchor">#</a> 项目中需要用到的插件</h3> <div class="language-js extra-class"><pre class="language-js"><code> 发送ajax请求插件<span class="token operator">:</span> <span class="token string">&quot;axios&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^0.16.1&quot;</span><span class="token punctuation">,</span>
 浏览器兼容性插件<span class="token operator">:</span> <span class="token string">&quot;babel-runtime&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^6.0.0&quot;</span><span class="token punctuation">,</span>
 滚动屏幕插件<span class="token operator">:</span><span class="token string">&quot;better-scroll&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^0.1.15&quot;</span><span class="token punctuation">,</span>
 动画创建插件<span class="token operator">:</span><span class="token string">&quot;create-keyframe-animation&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^0.1.0&quot;</span><span class="token punctuation">,</span>
 解决移动端点击延迟<span class="token number">300</span>ms插件<span class="token string">&quot;fastclick&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^1.0.6&quot;</span><span class="token punctuation">,</span>
 vuex相关插件<span class="token string">&quot;good-storage&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^1.0.1&quot;</span><span class="token punctuation">,</span>
 <span class="token string">&quot;js-base64&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^2.1.9&quot;</span><span class="token punctuation">,</span>
 网络请求插件<span class="token operator">:</span><span class="token string">&quot;jsonp&quot;</span><span class="token operator">:</span> <span class="token string">&quot;0.2.1&quot;</span><span class="token punctuation">,</span>
 <span class="token string">&quot;lyric-parser&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^1.0.1&quot;</span><span class="token punctuation">,</span>
 预处理器<span class="token operator">:</span><span class="token string">&quot;stylus&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^0.54.7&quot;</span><span class="token punctuation">,</span>
 <span class="token string">&quot;stylus-loader&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^2.5.1&quot;</span><span class="token punctuation">,</span>
 <span class="token string">&quot;vue&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^2.5.2&quot;</span><span class="token punctuation">,</span>
 懒加载<span class="token operator">:</span><span class="token string">&quot;vue-lazyload&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1.0.3&quot;</span><span class="token punctuation">,</span>
 路由<span class="token operator">:</span><span class="token string">&quot;vue-router&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^3.0.1&quot;</span><span class="token punctuation">,</span>
 管理状态<span class="token operator">:</span><span class="token string">&quot;vuex&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^2.3.1&quot;</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>删除掉项目的初始化文件</p></div> <h3 id="路由配置"><a href="#路由配置" class="header-anchor">#</a> 路由配置</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">new</span> <span class="token class-name">Router</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  routes<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
    <span class="token comment">// 配置默认根路径</span>
    path<span class="token operator">:</span> <span class="token string">'/'</span><span class="token punctuation">,</span>
    redirect<span class="token operator">:</span> <span class="token string">'/Recommend'</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    path<span class="token operator">:</span> <span class="token string">'/Recommend'</span><span class="token punctuation">,</span>
    name<span class="token operator">:</span> <span class="token string">'Recommend'</span><span class="token punctuation">,</span>
    component<span class="token operator">:</span> Recommend
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    path<span class="token operator">:</span> <span class="token string">'/rank'</span><span class="token punctuation">,</span>
    name<span class="token operator">:</span> <span class="token string">'rank'</span><span class="token punctuation">,</span>
    component<span class="token operator">:</span> rank
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    path<span class="token operator">:</span> <span class="token string">'/singer'</span><span class="token punctuation">,</span>
    name<span class="token operator">:</span> <span class="token string">'singer'</span><span class="token punctuation">,</span>
    component<span class="token operator">:</span> singer
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    path<span class="token operator">:</span> <span class="token string">'/search'</span><span class="token punctuation">,</span>
    name<span class="token operator">:</span> <span class="token string">'search'</span><span class="token punctuation">,</span>
    component<span class="token operator">:</span> search
  <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="开发"><a href="#开发" class="header-anchor">#</a> 开发</h2> <h3 id="header组件"><a href="#header组件" class="header-anchor">#</a> Header组件</h3> <p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAboAAAA2CAIAAAA+kMvFAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAABRVSURBVHhe7Z0JXBVV+8fnzMzdVxBRcUFB0xAVzVTIyjXL6i1zKTXLQtNcy3LN/lqWJaaWmX9MI1ustKzMXrVebdfM3MGdFBdEdrgXLneZ5f8MM8LlcsUL2P+95vP93M9l5jnnzD2z/c7znHNmIA6Hg/JCFEVlqeoy4LMq49eIIAgStBBClCUvfIzeqxXLlXKZnZ0L6icv++BXJ5W/CIIg1yu+uulPSGVIo0YNveUyp2/fPvIygiAI4k1aWhotL2FMjSAIUgMgkpJcolYiCIJcFRq1EkEQJBCUYBxBEASpGey7RBAEuTpK3yWCIAhyVXCo5zqDoalGDeihfTTPj9BNHqrtfYvKbLjiVDEEQa4hpLS0VJbLnJy8fv1w3mVQwzJU366qOY/pwqxEzRJBpJxucVcq98YnzjMXeVhFEORv4vDhwzgyft0AfmV8rGrJZH3ThrRWTWhaUk+jjoCAvjFZr9dKT2pJHyU7giDXGBzquW5QsWTSEI1G7fvAK8hohyjmiXs1Bi0JD6FDzLRaJRkRBLmG4FDPdQNIZIiZdL6Jpf15j5A6vL9682LTr/9r3rnK/N5sY1wbVklDEOQaQUpKSuAPCGdubj72XQYbII6Rjenet6jbtqAhzB7SS60kVEMOD0A34a8gUHaHOGJeyYlzfHkigiD15dChQ5JcypE4ymWwAdoXH8sumqAPNROGlmJwllGSroqHozbscM9b48BOFuRGo19X1cAEVasmzJksfssuz/a9HiWhfvjIZV6/fn3lBCQYaGil1803tmxCe3VEEooxUJpIyhBLaZpStJ4S3ZQ7m3IcoxzHKcFBiZycDxzM9Ex+4HN27JRGbhw638QuHKdr05zhBarMJeo04GdQp87zc1aVHTip3Bp1BuUyqInvwK6abjDoynsrCUPRRsqSQIXeRxliKKKhCEsRujwI5ynBRbkuUPmbqeKfKU8uiCZcLkdO8w/NtqNaIjcI3WPYxZP0IWby0Vb3io1Oh1PUa8mkwdpR96jzi8WJS0rhjlCy1gmQS5xIFLxENKBp2a8kKkodQUUvpSLnUeYeFGOmaJBLiMyJpJiQyhgpfTuq2bNUm2TK2AXEVOSpg/s4v+NCCPLPo4GFzBqlMxvIK++XJa0rA60EI3zDMlisRvLyGL3VVN/7AScSBS9nMgUemkOQRUMnqvVKyhgnKWMNgL+paUa1Wkg1GMwXsnFpbIyaxakPyI3A4F7qdpHMlt8963e4FdNlwAL2mJbMsD5XHCkNBBBJvJuCF2s+gcCa0nWgIl+kNBGK9aqwIXzYmLzU/ppSMi5EqyH1alEH3aneuNCU+pHlr8+t6RusB9Za1s413tyycsipTXPml5Xmgx9Ybu90xalLowdqjn1i3ZxkUtZrpFaZryHy78JuHvrQMjDef7O0YYERMkA2yKyY6kcgRw8JhH5dVSVl4lc/+2qlDNghFfIo63UF5TJIMdLkCZ226Eszb51QC60sh9GZGz89Ux3VJkpF32VUq+okmBDdrJtnTJqo79iaKXNRaaf5Yxk8TVNwY3/6knHU3ddGL4IQg5bEx/oRr4QObFTTgKcmIP+PQKvTuAGdmSv8ecz/eA7YITU8lG7VpF6Kh3IZjIC+ddGyZpqY+z1Ch8bW+jQRQmt1oaPHEZrur1epa+9gWk3k3ZnGHrHspXxhfFJptzHFD8y03z/DHv+UbfufHoOOTB2m7d0l0LZ67RbXzSOKoLiyHsRwPCWIVLcYtno/120dWZOeQIZryKnz/B0TbHGPF/96qL7jtjcyDa3EqCfZhYKy7g9INRtIk7B6yyV2XAYbcFYSdKzaGmrqO5Co6tLhQhjG1C1B2zammYYx0bXWyyfv03SIYors4itry3Z4TVtzOMU5qxzHzvAhJvLYPf9ABzPfJuQUCk0a0Ld1qOJgMow08Gp3iFn5Nd2TyH8FhpYe6LgqkKeeDwfXrzTy98AQ0lHDaltGsaENpNnqdYAQolIZbuulZZhuOpapzTZAGnrFqeB7Zyr33R++U3zzi8Vvd7ltpaJGRTVtWHn9hFnp9QuMJz5Tuv+WP2uAcF5Oqt4d2bopkzzdANkg88nPrDuWm4deoRseqvHyWB3k2bPGMqC74s82D6dh+3LxUxusO5PNEwfDjsqJSocgfPp3U21caPJbpSvBcVTaXzy4zwkdqvjOt3dSRTdlTmfy9tJK38JvN2t1I+wa7CDsAlQDKrPda2er913CXswYqYM9gv1K32Ddl2J5aYxOr63TNXDDcKlAhAsyxFjTUYJUyAM5lfU6gXIZLMCp1hISwdJRKqajlrEwhO0an1NQePbs2fT09JMnTx4/fvzEiROnTp0CS0FBgccjCRnP88XFxefPn4c8kCrngeWMjIysS9lcZLRIkVu1bDOWbszSBpoEcr673MRCzOLyiHuO+o8Q393k6jy6eMT8ksxcxdXSa8iCsbqO0SwICgSYWjW5N0G1dIqhQsK8aR/FrJljAC2D1v7oGf5cjtCiMT0/UZd4n6+7CsXnPal7pK+mqER8cbVD1m4o/tE8I2xfLp5+ng810888rF0xrcrPQR1eHqNrF0lDlU5fFHTlVVo4Xq8kXxmIi0vLxK7tGO94PKEDa9CS3UdqHTLDTsGuNQunMy7xh9P57AIhsnxnH/PX+Qv1X/mc4akHNA2tdEaWcCyD12qokXdplk3R+z2SiAxccgU2sXEDGpofxVQVuXMT8kBOxVQnUC6DBTWhHrNoljUyrGhsWBCmhxPzyrfbRo0ePWzYsMGDBz94mYceemjo0KGPP/74rl27HA5HXl7exIkTIQ/YBw0aBBngW84zcuTI595+hxOEzhp2SbhhabhhbgOdOQA/MzyEgOfo9lBnLwV6bcHNnFcsgoDe85z97mn2xevKoHhMSwaUV8nhxfPDdeAepv4lPXR0/wx7vym2j7e5VAwZOUADdiVTOXMfl7QyzybMXKloJfwQOF+Q7c9jXK9JNigOvzj29ZJL+UKvzqpRAyo1CBxJl4ca9qJUpf5TbUnlVYL63HrzVcag005zEHF7x+Pwoz1iWKiGd79EgNzfU83QZPkG513P2AfNtt8xwfb5D24IGOKrBvsyoK13dlYVl4jPrXBAnWHvpi13wGrPTuzQ3vWaBPOPZ2eqJzyEvr+n//50sEMq5FHW6wrKZbDQUcvebVCZvfoZI1pFZWdng/PocrkEQfLjRFEEp9Jms4GPOX369MTERJDFvXv3FhYWut1uOQ98w7Ldbs/OyaHVGigCCqmnSQhDOmjZRIu2fNs1Aa6Nir26qnrD8dIj6hXPmf18kMstElQsuHiyoRJQq9gopqRMfHeT83yO4pymfOuCZfCkbmpR6R2AXwmOFYjUC8llP+5XLnTQO1DhQru4/HNnfrESWP12mNu62wM/19drpggvUN/86q54kKOGKvngcFF7j1eJxwd0U0U2of+6IBxKr7VvInWr0RR46xXu4ZxkR8yI4qcXlyrrXvTrqmIZasvv7s2/KRNioJHYmcqJIoWD8jXz2X/ccAkN6a3uHuPbDoEF7JAKeRRTXUG5DBbCGJqp2k359MSJMe3bM1cIw3Q6nV6vN5vNynpVCCHh4eEzZs1SqSoVBDYUpb76GT97SXBztevi8XBiTrVxSbWKimzsW/m2LRiDjgK9g0hTMVEUXMp9p9gSnrJVuG/RzegRd2lg189nC78cqnQK2rdijDqiUVOzHtV99Zqp4tOrMyuIVEQYXdGd6vaI57J9qxQgu1I93vF4fCyrZsmvXtUInN8hfhep4f3VB9daNieZpo/Uenf4etOqCR0eSsORP3GuSrWnLCuNfbR44QdlyjriD7iEVm506tRk2TP6u3tUXvOwDBawQyrkUax1BeUyWKjuzlksllWrVnXv3l2t9vWINBoNxODLly+HDFarVbFehmXZsLCw1atXx8TEkKpDhoE4jQU2odQp+hW7KwHeZXaB77VIKFL9FUpgAbu9VDyTVdO1q1ERCEILbGLnNuzUYb4esV5D2kcxHVtXfqKbMuDHgfNYMSrit0oBAg4d3FpyPA6K2aUtW2gXwKgk14ZFH5e986XkCOs0JKYVM/5B7U/vmLcuMfXs6OsEsax0rmrVB4IADSxk7L80n8w3/ut2dfLXTmjY3p5m2PWuGRpR+IZlsIAdUiEP5LzqcF8NoFwGLzRNm0ymN954Y+7cuc2bN9dqpf8vAUaj0Qgx+IB+txkcW8L0WZMnPQ2KCRIJSSCs4FSOHTt2/fr1UVFRl585rx0Qcl7IFkCwulWLa2QSOrA7k83fLjbV4TEJUDGREk0GUvOEYVC6actL1/7bBT7jI301ParOG0+/wN/yZHH00CKfzx0TbPXsy5cpsov7T3CgvBCPg2I2D6fB46vbCxp4nnprg1OauDrLvmaz6+gZnuOkPod5iXqfjlqOE2Fna9VKIZOGaL9/0zxrlK68yaRPnhMGzbJ//J3L6aJaRdDwDctgATukQh7ICfmhlFK+lqBcBjWgd6GhoYMGDVq3bt38+fPHjx8PTuWi1199dty95sK3qIsr1OdmDu1NvbP89SlTJo8ZM2b27NkpKSnjxo2LiIiQo/gCvi6zarfv9Xg4qkd71kenZIb2UTcKpUFN6vD6YShSWkZZDCSySaUoQE2/eNV4+EMLOF+yBdyx3w5zyZuch9I5cAeefViZJ5RxSXC6pTHQhKoVWzBWd/xT67p5RmW93vyexoGLDfH4HXEqFUt+PnDFSBwEznsMvU1zBiwyt97M/rLS/FuyuVNrBtT2tQ/L7p9hT3ytpNAuNrSSllUbDHC3cwoEcIVaNK5ih/j96CeWlDkGZR25zLwndVOGaCEEmbxU6q+AxvLH/R4IC156r6zPZGnyP3zDMljADqmQB3JCfigFZZWt1AaUy+sAlUoFPuODDz44depUkMs7YyM16S9SBT9RXAnhitnM5I5k+1NjEqdNmzZ8+PDWrVuDH6qUpCh3neaZbfjBfeQMDzq1eKLee/wEJBIsA+PV4CRu/FHqXFcSAmb/Se5oBm82kKlDtRVh0eh7NDe3ZJxu6mB6lYAXXLPkr1wgLhUh+a+HPCfP80YdeeoBbYV3NqC7CqoEkey+er/TsIJdadyFHKFZOA0edG6R/0hc1m6I2W/vpBwiCLF7d6nU8VMXeLtDDA+R/tFxRRc05Fez0oT/gmpv1/v5AAcHdvCd6ooZpu2jmHsT1CxN0s5ghF6Fh/uqh/RRw1X6yP/Yt/weaLcy5IT8UArKwhYUa8CgXAYLcDdAlKqs1Ejpn4czV+Tb9nGCEwRTzP3SdWHRDlF6edFVgK0HKG8Qjc58xwEOEdzbyTOUnqCtS0x/rDY/VP4PMD7b7gLXT85cK6CaSeukBh8iIwiLNi0y/ect88xHpZn03+50707zVSXwC74sf2+CHJJD8aWfOjNzhQ7RzJYlps1JUq3enGqwGEnqaf6DLS65VP2R43GNioDnePCUNJlUSfBC1m6DjiRN0EM1vn/T9N4cI01L/81YzgAbWb/d7eHER/qpdyZLxxDyLByv16rJd394qkf3cEjBjYV9gT2CDcLeffaSsVlD+tru2j8AaHsgxHG5qcWflFVMkAgQyA+loCxsoaINCxCUy2Ah3c2XCpKiVXyuhMiJ7jwxe714dqmQsUgo3i3ypXQNBSo2yInUn2WB+l/pmfygOfZl653nswWrkYC6ybN89hzlxrxWMv+9sgD02T8gE2MWlv603wNOVmwUE9mIBvWc+67j5ff9D/6u+tp5/Kzk6soh+R9HuZHzS/69ywOOGPikEPyCp7bue9eol0tqe+fUzI59HPiG5f/J3b/zAkfg+bcdUBM3J8LBadqQ3pXKLXi/zON1jD/c5pq7qgz80BCT1HfWsjEDTqv0EkZ/I92wwQlLStdsdhWXCq2bM7B3bg/1d+za9U5sKyaiIX0sg4cDrphqA5SCsrAF2I5iCgxit9vlZ8bz8vLxber/ReC8ddayg0zqMEYZzI7f/IM+JLT6Q5BFGz/NXfWW6K50N2iDIfqrHUTt+6CIx+P5uv9tIR4XbKJMFI+4+I+KXbCgJCPI9cntndi3pxmg4Ry3yM/01UBYNdPQPYadvLQ08JebHDx4EOUyiADFZIn0nKIskBu++aZtu3bVR7eLPl+Xu/ptb7lkjMaoL7f7yCWc1vz8/AG9ermcTtgghOG85JjW5LciyHVB83A65QVjoxByJkt+OKN2wC3VqgmdXSg++WpJ4P3vIJcYjAcREN26RBG8P0f5Z9/+/by/iFcUq55gcD/9PQsOcpmRkVEmCPIGnaLoQa1E/hGAxr30nuPkeb55I7pVRK0/kY3pvzKlLdR2rBK9y+ClZ8+eK1euNBh8Z5DYvtucs+w1wXm584sQVZOmLdduJFVns3Mcl5KSsnTpUvllHAiC1Af0LoOaEydOQDQtN2be6OK60mazFFGUQ1jWcGt8xaoMlAKV3LFjh1//FEGQOoByGbzk5eVt3brV7fZ9LwAbFh72xNOMyUxrdbRer2nTrsHocaTqnAhQyd27dx84cKAuXTsIgvgDg/GgJiQkZPXq1XFxccRnfBycx4sX3BfO0Vqtpm17+Fbs5cAJLSkpGTly5JEjRxQTgiD1A4PxYKeoqGjZsmVZWVnKegWEqCKaGbol6Dp28dFKAJrApKSko0ePKusIglwLUC6DGvAT9+zZ88ILL+Tm5iqmCqQB8fJPVWw225o1a7744ovqnZ4IgtQHlMtgx+Px7N69OzEx8fDhwzWPcXMcl5mZOWPGjJSUlOo9ngiC1BPsu7w+YBjGYrHcW07btm01Go38xjY4dzzPu1yuixcvbtu2bdOmTaCYOHMIQa45+FTPdQboo9FojI6OjouLa9GihcFgAKHMyspKS0tLTU0tKSlBoUSQvwmUSwRBkIDAkXEEQZBAQblEEAQJCJRLBEGQgEC5RBAECQiUSwRBkIBAuUQQBAkAivo/SI8qxpD2LpAAAAAASUVORK5CYII=" alt=""></p> <p>结构代码</p> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>m-header<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>icon<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>Magic music<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-link</span> <span class="token attr-name">tag</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>div<span class="token punctuation">&quot;</span></span>
                 <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>user<span class="token punctuation">&quot;</span></span>
                 <span class="token attr-name">to</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>#<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>icon-mine<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>i</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>router-link</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>样式代码</p> <div class="language-stylus extra-class"><pre class="language-stylus"><code><span class="token selector">.m-header</span>
  <span class="token property-declaration"><span class="token property">position</span><span class="token punctuation">:</span> relative</span>
  <span class="token property-declaration"><span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">44</span>px</span>
  <span class="token property-declaration"><span class="token property">text-align</span><span class="token punctuation">:</span> center</span>
  <span class="token property-declaration"><span class="token property">color</span><span class="token punctuation">:</span> $color-theme</span>
  <span class="token property-declaration"><span class="token property">font-size</span><span class="token punctuation">:</span> <span class="token number">0</span></span>
  <span class="token selector">.icon</span>
    <span class="token property-declaration"><span class="token property">display</span><span class="token punctuation">:</span> inline-block</span>
    <span class="token property-declaration"><span class="token property">vertical-align</span><span class="token punctuation">:</span> top</span>
    <span class="token property-declaration"><span class="token property">margin-top</span><span class="token punctuation">:</span> <span class="token number">6</span>px</span>
    <span class="token property-declaration"><span class="token property">margin-right</span><span class="token punctuation">:</span> <span class="token number">9</span>px</span>
    <span class="token property-declaration"><span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">30</span>px</span>
    <span class="token property-declaration"><span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">32</span>px</span>
    <span class="token func"><span class="token function">bg-image</span><span class="token punctuation">(</span><span class="token string">'logo'</span><span class="token punctuation">)</span></span>
    <span class="token property-declaration"><span class="token property">background-size</span><span class="token punctuation">:</span> <span class="token number">30</span>px <span class="token number">32</span>px</span>
  <span class="token selector">.text</span>
    <span class="token property-declaration"><span class="token property">display</span><span class="token punctuation">:</span> inline-block</span>
    <span class="token property-declaration"><span class="token property">vertical-align</span><span class="token punctuation">:</span> top</span>
    <span class="token property-declaration"><span class="token property">line-height</span><span class="token punctuation">:</span> <span class="token number">44</span>px</span>
    <span class="token property-declaration"><span class="token property">font-size</span><span class="token punctuation">:</span> $font-size-large</span>
  <span class="token selector">.user</span>
    <span class="token property-declaration"><span class="token property">position</span><span class="token punctuation">:</span> absolute</span>
    <span class="token property-declaration"><span class="token property">right</span><span class="token punctuation">:</span> <span class="token number">0</span></span>
    <span class="token property-declaration"><span class="token property">top</span><span class="token punctuation">:</span> <span class="token number">0</span></span>
    <span class="token selector">.icon-mine</span>
      <span class="token property-declaration"><span class="token property">display</span><span class="token punctuation">:</span> block</span>
      <span class="token property-declaration"><span class="token property">padding</span><span class="token punctuation">:</span> <span class="token number">12</span>px</span>
      <span class="token property-declaration"><span class="token property">font-size</span><span class="token punctuation">:</span> <span class="token number">20</span>px</span>
      <span class="token property-declaration"><span class="token property">color</span><span class="token punctuation">:</span> $color-theme</span>
</code></pre></div><h3 id="tab组件"><a href="#tab组件" class="header-anchor">#</a> Tab组件</h3> <p>实现路由(推荐-歌手-排行-搜索)的切换 并且添加基本样式
<br>
代码很简单 所以直接贴</p> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token comment">&lt;!-- router-link 组成的tab栏 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>tab<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-link</span> <span class="token attr-name">tag</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>div<span class="token punctuation">&quot;</span></span>
                 <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>tab-item<span class="token punctuation">&quot;</span></span>
                 <span class="token attr-name">to</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>/recommend<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>tab-link<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>推荐<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>router-link</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-link</span> <span class="token attr-name">tag</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>div<span class="token punctuation">&quot;</span></span>
                 <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>tab-item<span class="token punctuation">&quot;</span></span>
                 <span class="token attr-name">to</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>/singer<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>tab-link<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>歌手<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>router-link</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-link</span> <span class="token attr-name">tag</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>div<span class="token punctuation">&quot;</span></span>
                 <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>tab-item<span class="token punctuation">&quot;</span></span>
                 <span class="token attr-name">to</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>/rank<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>tab-link<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>排行
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>router-link</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-link</span> <span class="token attr-name">tag</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>div<span class="token punctuation">&quot;</span></span>
                 <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>tab-item<span class="token punctuation">&quot;</span></span>
                 <span class="token attr-name">to</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>/search<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>tab-link<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>搜索<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>router-link</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">'tab'</span><span class="token punctuation">,</span>
  props<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">''</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token function">data</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>

    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  components<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>

  computed<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token function">beforeMount</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token function">mounted</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>

  methods<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>

  watch<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token punctuation">}</span>

</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>stylus<span class="token punctuation">'</span></span> <span class="token attr-name">scoped</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
@import <span class="token string">'~@/common/stylus/variable.styl'</span>
.tab
  <span class="token property">display</span><span class="token punctuation">:</span> flex
  <span class="token property">height</span><span class="token punctuation">:</span> 44px
  <span class="token property">line-height</span><span class="token punctuation">:</span> 44px
  <span class="token property">font-size</span><span class="token punctuation">:</span> $font-size-medium
  <span class="token comment">/* flex布局使得不管屏幕大小如何 四个tab都平均分布 */</span>
  .tab-item
    <span class="token property">flex</span><span class="token punctuation">:</span> 1
    <span class="token property">text-align</span><span class="token punctuation">:</span> center
    .tab-link
      <span class="token property">padding-bottom</span><span class="token punctuation">:</span> 5px
      <span class="token property">color</span><span class="token punctuation">:</span> $color-text-l
    &amp;.router-link-active
      .tab-link
        <span class="token property">color</span><span class="token punctuation">:</span> $color-theme
        <span class="token property">border-bottom</span><span class="token punctuation">:</span> 2px solid $color-theme
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>

</code></pre></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>点击路由时显示的样式  vue自动会给路由链接套上一个router-link-active的class，所以只需要给这个选择器下的span添加样式即可 还要实现一个下边框哦</p></div> <h3 id="recommend页面"><a href="#recommend页面" class="header-anchor">#</a> Recommend页面</h3> <p>该页面由轮播 推荐歌单页面 歌单详情页面组成</p> <h4 id="轮播"><a href="#轮播" class="header-anchor">#</a> 轮播</h4> <ul><li>使用vue-awesome-swiper第三方插件构成轮播图
轮播模板
相关插件地址 <a href="https://github.com/surmon-china/vue-awesome-swiper" target="_blank" rel="noopener noreferrer">vue-awesome-swiper<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;recommend&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;recommend-content&quot;</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;slide-wrapper&quot;</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>swiper <span class="token operator">:</span>options<span class="token operator">=</span><span class="token string">&quot;swiperOption&quot;</span>
                ref<span class="token operator">=</span><span class="token string">&quot;mySwiper&quot;</span><span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> slides <span class="token operator">--</span><span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>swiper<span class="token operator">-</span>slide v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">&quot;(item,index) of recommends&quot;</span>
                        <span class="token operator">:</span>key<span class="token operator">=</span><span class="token string">&quot;index&quot;</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>a <span class="token operator">:</span>href<span class="token operator">=</span><span class="token string">&quot;item.linkUrl&quot;</span><span class="token operator">&gt;</span>
              <span class="token operator">&lt;</span>img width<span class="token operator">=</span><span class="token string">&quot;100%&quot;</span>
                   <span class="token operator">:</span>src<span class="token operator">=</span><span class="token string">&quot;item.picUrl&quot;</span>
                   alt<span class="token operator">=</span><span class="token string">&quot;&quot;</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span><span class="token operator">/</span>swiper<span class="token operator">-</span>slide<span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> Optional controls <span class="token operator">--</span><span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;swiper-pagination&quot;</span>
               slot<span class="token operator">=</span><span class="token string">&quot;pagination&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>swiper<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;recommend-list&quot;</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>h1 <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;list-title&quot;</span><span class="token operator">&gt;</span>热门歌单推荐<span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>ul<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>ul<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
<span class="token operator">...</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token function">data</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      recommends<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      swiperOption<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token comment">// 使用轮播控制dots 轮回轮播 三秒自动跳转</span>
        pagination<span class="token operator">:</span> <span class="token string">'.swiper-pagination'</span><span class="token punctuation">,</span>
        loop<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        autoplay<span class="token operator">:</span> <span class="token number">3000</span><span class="token punctuation">,</span>
        autoplayDisableOnInteraction<span class="token operator">:</span> <span class="token boolean">false</span>
      <span class="token punctuation">}</span>

    <span class="token punctuation">}</span>
</code></pre></div><div class="custom-block warning"><p class="custom-block-title">WARNING</p> <p>再使用组件前  最好全局注册</p></div> <p><img src="/assets/img/2019-11-13-00-03-47.c9339caf.png" alt=""></p> <br> <h4 id="自定义轮播组件-slider"><a href="#自定义轮播组件-slider" class="header-anchor">#</a> 自定义轮播组件(slider)</h4> <p><strong>文件目录</strong> <br> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASgAAABvCAIAAADQT8ouAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAABXCSURBVHhe7Z0JeFNV2sebpmnTfd9b0r2UtECBCoV2EKEVKIuIBbEyisu4DDqPzow6jj7qyLig8nyKzvcxw8jwKfRjHXFYLVCQHcrWhRK6r5SmS7o3S9PvTc7hmpRsTZebkvf3nCfP+55z7rm3Tf73PUtyLic8WmhjMn4+XpK2DplcTn1tDJciiPXg4OBILT1YtPDmpPEenGdPHTUVZX3/+nsvdRDEUjEqPK6ntx81TcDZybFXKutTKqmvjeHSwRIewf3zOic/f1vNFBPH9fXnXDqnoJUQZMj4uAuc+J4cW1u5oodmDRk7Ox619DBiEY/DseNyFQr9CjFWQTiR+8GnztQxRkV53/tvdnd19lMfQUwgxFfo7x3F5dgRt0fWLqo+I5N3E3cosBbxBOHRS5avaW66097WSkq14HBSH1yYnJpeJipUKPTI2N92Tpp9ZXlfXW2/uNFIArHLZf2V5cMTbMc0sxOfWT1/Q2nthY7uJpqF6ELgPznQO8aWY0t9Gxse18HTNai1o75POdThEpsRLzklTZiQlHNoZ1VFibr8LmrVRUYLD+7b1ninjmbeA4l4773ZVZTfR7P0s2RJskhUKxLVUN+KAeGlTlr97f6X6ptu0izkHux5TgmRaUys06S5vbqs7hJ1zIXVyRWd2jNNdYCm8D5Y72xztxc5K+m33p4RxG5uLT9z6ZvQ4KRE4eMKRe+ZvL99+VkZdDtJ6b3Ah/LhB14hdlNb1eYfn2/vFrs5+T635B/Q0Sf5Ry5uPHn1W2K/8MgWYsDdEV6v3jpw5MKXTGVwd+W+oy6nNW9WnSLtyxXSPSffzy89rC60MXqKlra6xJgMMLqlEk3NTIyav3z2+zw7B7Cr7lzb9MMaMEhrNXcKvdyDyYUxfwu0RnIApinNTM1TWzPQyQzyGU8dbeC9u1qynzrmwvLkSm1NuQOfP2NWenNTQ5ukxXTVAaSreeKo3MXZNmuNAzO/4u0+zY7rSerYclt9/W2jQleqbFu7ccGJRw4XNTS0kdIBZM5ZN31C5q7cd7fn/PFS8d5gv/hb1ae93ce9uGyrpLNh/bYFxy5vErdVZST/3tcj7EblcThk2vhH4CN74caub/e/qFDKUyY+mTJp9an874gLrbV01N5pKWVqgkJIO9DCg4nPkFJ4g42eoqG5ZOPulXBVCZHp4UFTL9/cB0WguiUpb/1wah254BnCFROjHoYiB57zlNglkcFJ5MKKq04+MGG5h0sQNAilcGFBPrGb9q05cPYL6G3CX+3jIfhq14qD5zdAETRb1XAVXq0cX88wJwd36mjDtbWrayqmjrkY7Wr+0sEdEfr7z53OKSq4lLZghSA8xnTVaSKcxKXWPdjaOvq4LaYOuBz+2rWZ1NEGPv2xglnHr/ydRCEIDtuOvA6vsxKe7O5ty/7pDVINSgvLj4b6x0NUITkQZ0iIuCr6DwQWTbetqyE2NEVdSwWUMu1AYGRKjZ4CDoT6YMD1XBb9CJokN+Pk+JWiqtPMBWsWAcyVQEwTVZ3RbFATiIpdva1wONhQH8MdoatHQq17kA7H5IpRRlh4wF3tZSzNMkN1QFKy3puHUtlT17JJ2U9ngRsb61577W/EHoCPR5hCISupOUv9u8DnEvps5HNJENWctrdzdHHypr420Cek1j0wn28ADHChcbCNnkLzQAZQkTPfE/qfH71wlSSmk0wwcCWanCvcEeQd98Gz5yF+0iwE/nsddcp+3TPqko7b1BpJRl54gFp7B/dt37tz82BVBwgTtCJee09eS2cOSWDL5PVEe5DefW9TR8ewLcVYAjAke3tTIpPW/WvOYKdMIGC+988ZEOofn/sxyo9BJu+ubbxBHQ0g3EFXgjojyagID+jvr6wQtcMwb5AIE3TMO6kmWkhS4+wg7JGWd3WXJ056IChId6RqklTa2dlHh86k/l0gbgzopEH/UKbo6exupr5ZQIcQuoU3q06Bbd4pSMwcL0il/tCAHuYn36UP6BtbOQ0tJbdqz/bI2okLAbC5vfp66SHijjSjJTxzeWDmQOG5OU7zck0jCWzI8XJJc+YLXZ2FL764SJ/wyEDooSm/Ibd8kEHWwxvg9UzB905891Xp60k1KI2PmAejqXv7fkYR+E/OnLOO2ItT3oRX0rM1+xSgW2hzduIzxIUDl6S8RWwDtHbU29hwoGtN3Kz0L5hhITIA6FUWlOVcLN4DKe/mvqGvIpiO5Qqvu1P1Ghahd2ZlsOzKfaew/Cj0uGC89Nbqn2SybvjogyC/3f8SRCcyjlo++/09J983bwYCuigwnCPtQIPMqoDZp4A60NWEoR05cEnKm3k3f6Bl+oG+pVhSAX/mO0/nguRcnLzWLs+Gw+FPhqEms/6BsIulf0k6KdnO2UXr7jBrmvY6Xt43S9K+IC7w/PMb8vJuUWcUIctxZJ0NQYyu41l0VzM3R77+Lz3vvdGlmSo11sfBhhzqIMjYwaIj3hgCIx6iydiOeAhyv4IRD0GGH4x4CGKJoPAQhAU48YkDv8xhAE93l86uHrlC9+9uhlKKIPcTCrmMWnrAiIcgLIDCQxAWQOEhCAug8BCEBVB4CMICKDwEYYExvJwQHS+MmRBPHTXN4sbzubnUQRD2MLqcwPULDKWmCTjy7WVyhVKpe8PmoZQOFm8/v/mPPubq7q6Z/AKDXN3cqspU234NlvWffJQ2b27O0WPUR6yGsDCBh7sHj8fr7h62bY6USiMBZqxGvMDQ0IwVql39TKG5sTHnx32dbbq3/SOA8OD1jbfeJi5iDcTFxgYGBdra0h9b9/R05+cXdnR2EHcoWOgCuq2traeHB3V0YbQCoVksvl1TYzTJpFJv30FsH4pYA/FCYXBICKM6wNHRafLkSa4urtQfSdiJeBkLFyx7ZOnu3XsP//QTKdUEVPeH11+DDsAnn35WXaN7V3YS8Q7s3AG6ollDAyOeVQHqSkqaqqk6hiax+Fp+PnXMxWjEY0d4IK3fvboW7i47d+4+cFBrXyeiutjxMVu2bD19ZuA2mAyawjO9z3n+RC50O6mjDRFeYVHR4kWqrdTlcsW27dsPHKR7sL/xx98nTZtK7Et5l9d/Rjeb+PXqLFIfqKioZHQLrYWHq7YbGtAOYiFAJxPCHXW0USjkJ07+TB1zsdDJlf7+/osXL4UJBHPnPiSXyUtK6HSIiaoDXN3dY4TxJUVFDnx+UuqvNKdYDKRLp37u69N9X0ibNxekYs+z/82LL+/avScyMiI9La23tweubdKkBGFc3NpXX4P87u4uyHd2drqeX5CxcD6obtv27L9+/OmtklvhYWE/nzoNTRENk3ag5qPLlpF21OdBLIKQ4GAnZ90PgYMwWF5RQR1zMTq5wto6nlKp/PKrr69du75ixWPQ84Qc01WnSWCIqTcOMtijji7E4qaN39CNqLP/b4dEIhEKVb8Svn694MO/fkzy8wsKIT8gIABsb2/VVoK1daotepk6oEYvT89t2dlgA7knTjLtIJZDl/4JTKnBD8lwweYCuqb2FmUsMEN1gCAqilrGMDoa7OzsrKmpJTYY4PqopQVA0Nu6ZfOuHds3fL7e19eHZIKourq633n7T9ARJTkAqNHdwx0yofKA+ojl0NBwR19Qam3V9UTH4Yblb64w2nsy6wkzVAfAYI9axjBvfQ8AXYGQjh3PzVz5xOt/eAMCI8kHcb689tV1H30snBAHGmPkBxWgGlRmEjMmRCyEjs4O5iarCYQ7GOdTZyRh/ytjRHvfb8v+auPXg1adyf1M6GTqm1bRCYQ4f38/eA9CQ0NgLHop7/L/freNlmkDncyn1jwHFaAaVG5uboZx3cQEra/UIBZISWlpcXFxTw992AYEwCax+NRp1Sh9FGBfeABob/+Bg/AJpr7JCKKjqWUMU1YdwsPDmKiVtWoVvF7Pzx/Q51z1+Eqm6/jr1VmQiM0Ag0Dof2YsXAgiJDnv/vlPIGNiIxZFXX39mbNnjx47Bul47omhryKYjkUIzwzINIm3r44nwumkskz7cdC6qKioBIGRsRmEuw3/9SW5F2zLzgaX5PMd7JmuJrB4UQbJh3D38afrQaWQwIAiGN2RIqlMZsY9Bbm/Gdtfkg6LjLZ3UD2m2DBVpaWFVy5TB0FGHgtdQEeQ+xsL/a4mglg5KDwEYQEUHoKwAAoPQVgAhYcgLIDCQxAWGL3HdBkunT414cJlXGVG7hPwMV0IYomg8BCEBVB4CMICKDwEYQEUHoKwAAoPQVjgvl1OmDA5MW5SInXUiBsafj5ykDoIMpJY6XKCb0Bg2tJHQ8LCNVPijOS0pctojeFgyfI1kMDg8x1XPfUKse9FmDDt2ZfedvPwoj5iYbi6eUBy4POpPypYpPA4HDs7O2rrxFgFff/ECZOn/O69DwekJ1542c3Dk9ZArAlvH/+4+KmCsBhI0TETI6Mm2NnxaNkIY4nCE4RFZa15LWRcJPUHwOGkPrgwM+slR74TzdGD+E5DbWWl0STtlfr6B9JjzKK3tyd768Yf92yhPjIW8AsIDgwScDWfneDkEh41fnS0Z5FjPA4nOSVNmJCUc2hnVYX2Xilq1UVGCw/u29Z4R7WTrE6gY7n8qWf2bP22tnKoWwIbgPQtjeoNupozUtJ3Zf9Pu6SFZiFsA+qKHj9RU3UMTU0NDfXV1DEXo2M8S51c0ak901QHaApv+VPP2tiY9FC+n48cEjfcpo4248KiFy7N4vHswW4S3/73js0Q5RjhwRhv2crnaqsrTuXuV1dXaVIQrtoBrburs/D6xfhJDzDC02wK/jSiW9KC+E69r3+Qj2/gxs/x2SkjC3QyIdxRRxu5Qia6cY065jJmJ1f6+8+dzikquJS2YAX5BJuuOk18AwJDwsKY+RXDqV2iewthNw+vtAWZp47vBz384+sPQR60QA+gOmcXF6gJ9XMO7UpMSqEFatWlL1wBfwJpCqppTslExSacOXkYVTcK8Oz17pHFs1PdE0caC57V1NJejBmqA0B11DKGerDXSx1tPDy8ORxOR4fquZYQ6I4e3gOvpOheQFp+/kGgH1KnurIEFEuKgMlTU0TF1yETbKiQf+Wcr18gM+FZX1tFipCRprfHwLMT9L65w4gFCw+4q72MpVlmqA6IiJ1ALWPUVpZT6x5ADI136pc+RhcPDOPq6t7V1d7YoGN7cOhPQoibPHXmK3/4iKSHHn6UlqlpbRFTCxlhOjva+pRK6mjT1jYaQ3HLFh6g1t7Bfdv37tw8WNUBpke8ctFNaukCRmKkZwhqMUV+Bjh+ZC90Jpn0z//+CCddRh+FQn67rpI6GkC4a2wY9MfMDCxeeEB/f2WFyIxPZ7DAVNVJe6X6plUYoGeYvXUjyEazc6gTdw9vv4BfHnro5aN6phcALXR1dkbG4HbuFoGktam87EZPTydxIQA2NTWUiEbp19hjQXjmEhk3DP1MAIZt02fOo44xykqK2iTNs2bPh44luHCscOI0UgSU3SoQhEcLE2jOoFpGhp3urs6ykhuF+RchFRfmDX0VwXTuT+GRaRJffxpqjFIuKqaWHhKTUsiozOiKHIS1f+/YDMbza9+F+qDAC2eOkSKgqCAPYiYM7UhraQsyi29coWWINXE/f0k6IjbOQR12DFMuunH1/DnqIMhwMGYX0BFkLIObHSGIJYLCQxAWQOEhCAug8BCEBVB4CMICY0N4fj5e9rxR+mkwgowCGPEQhAVQeAjCAig8BGEBFB6CsAAKD0FYAIWHICzA9fT2o6YJODs59kpl+n4zP5TSkCD/utuN1LkHw8cOFvsQT981s1ymh0Oyvc3lu/jw3byVChkkKOXaObgFRkIO393T8+nJpJqipQsSORxBjGJ0c05rjHiyWtVuYvxoP1Wa4stzdIXk5EX3tHX2CSE5dhGupI4Nh9NbovemoI8luMG7xTMxMXnx8qf9AoKpb2Pj4uK24JEnZ85eQP0Rw0q7mi176M9PneYK+mykYIDS+K7e8Grv4gGuUqlwzYxVV7GRHMTfKyHDjJUKD4Je5wW6yTR/Hv2hurNPKIQ7YvNmquQHQDUzwp0mZLMW3OAd0cR6J1da9l5R9qh+lesg9Onjq4IehwvjO9XzGPq4Usfpqp4nVIBqYCDI8GKNkyuEfrnSRqF0jFMJjBflLr/WzOHQ25DjshCuu2qn4bac4p7iBpJpgHFh0aueejU5NX36zLmR0RNKRQUKhSJ2gurpfKLiazDGy8x6ydPLr7ryFqkP4730jBVQOWHSdElrM4wxbhTmSdUb4Go2FRA4Dg6HTNJCQGDo9Fnz5qQ90tXRJm6ku1lDU3AiUg1gziWRNK188retLeK2u9vDDKiZOmfR0seehrNA0mzQqvAPDPXw9KmrKe/q7CA59vYOgohYeC9qqkpJjnng5Ioh2nJFZK6S6+FgE0z/FUrvPl6oKxhQJDlUSDINMPobvBcV5NEs9bZlmtsNRkYLnZxcr189S1x9gOpCxoWTa9i3e0vqQ4uYjc+Q0cGqhQc0fX+BGK6ZsUqlor9f4bwonOQwRYZhd4P3mhrVxoShoRHEjYxJEDfeNrwHKTQYHjle8xqgZdztc5SxduH1ljT2ltKN03nJ7rZR9qroB/mlYhPnVNjd4B00dutmPpENKMrD0/va5dOkSB9wp3BydoELZk5EHwtjfcjlMugTuri6U1/9iDwelyvt1ftkheHC2oUHNH13nhiOM4KcF9GnYTKZpsDuBu9VFSLQG6gO4p5cLtWp6gF0d3Vu3fy55omsc9K1rbVZqewLComw5dIH5QWFhHHteMzAeORA4anHcge1xnLtJ24N9nsq0G1ja4N3UBroDVQHx9ZWV5AOJMDj2UOAJTYJp8SWSJqhiOmdWjONjXWS1iZ4y9IWZianpj84b2lE9IQ2SXNN1Yg/swmFp6L9pIgsLQBgSA4NYsV8UNuwD9cG76lzFjHfdyGjwYlTkkFazLQKxEkY7EEmOVFS8lwfX/rVHFI0IyWduUHAWeBcxLYqFHL5+VM/1dWU8x2cAoIEcE9sqK+5cPqYvge2DSPWu5ygSb9c2dfe6zRRFYiad+RJK5tJvinAu/WrhxaRBQD/wFBmg3dmOQFGEXHxU9rbJNWVtxQKRamoANzUORlQ38c34Prlc4HBArKcIG6s7+pog6EdmeUfJ4g+mfsfyNdsQX1OG0F4jLePP7MIIZX1Tp4yS9Lakn/1ly2xb9+uhswZKWnQVMPtGqlU9WEiywnwGiqImj13MTkRXNXFc7/sM29V9PUp6moqRDeu3iy6Aq+11WXQfaBlQ8DocsLY2Ena8LHDRdBb8+G1/pPDxEUQs8GdpAdBy54rzHc4EWREQeH9gmppYWhfy0QQE0HhIQgLoPAQhAVQeAjCAig8BGEBFB6CsIClCM/w42Abm1pGehEPQUYTjHgIwgIoPARhARQegrAACg9BWACFhyAswL7weDx7aiGIlWBj8/8joP+bfy+AoAAAAABJRU5ErkJggg==" alt=""></p> <blockquote><p>书写自定义组件前安装好better-scroll插件 项目依赖</p></blockquote> <h5 id="第一步-写好基本dom结构和样式"><a href="#第一步-写好基本dom结构和样式" class="header-anchor">#</a> 第一步.写好基本dom结构和样式</h5> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>slider<span class="token punctuation">&quot;</span></span>
       <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>slider<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>slider-group<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>sliderGroup<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>slot</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>slot</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>dots<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>(item,index) of dots<span class="token punctuation">&quot;</span></span>
            <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>index<span class="token punctuation">&quot;</span></span>
            <span class="token attr-name">:class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>{active:currentpageindex===index}<span class="token punctuation">&quot;</span></span>
            <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>dots-item<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><div class="language-stylus extra-class"><pre class="language-stylus"><code>&lt;style lang=<span class="token string">'stylus'</span> scoped&gt;
<span class="token atrule-declaration"><span class="token atrule">@import</span> <span class="token string">'~@/common/stylus/variable.styl'</span></span>
<span class="token selector">.slider</span>
  <span class="token property-declaration"><span class="token property">min-height</span><span class="token punctuation">:</span> <span class="token number">1</span>px</span>
  <span class="token selector">.slider-group</span>
    <span class="token property-declaration"><span class="token property">position</span><span class="token punctuation">:</span> relative</span>
    <span class="token property-declaration"><span class="token property">overflow</span><span class="token punctuation">:</span> hidden</span>
    <span class="token property-declaration"><span class="token property">white-space</span><span class="token punctuation">:</span> nowrap</span>
    <span class="token selector">.slide-item</span>
      <span class="token comment">// * 轮播图slidergroup的样式</span>
      <span class="token property-declaration"><span class="token property">float</span><span class="token punctuation">:</span> left</span>
      <span class="token property-declaration"><span class="token property">box-sizing</span><span class="token punctuation">:</span> border-box</span>
      <span class="token property-declaration"><span class="token property">overflow</span><span class="token punctuation">:</span> hidden</span>
      <span class="token property-declaration"><span class="token property">text-align</span><span class="token punctuation">:</span> center</span>
      <span class="token selector">a</span>
        <span class="token property-declaration"><span class="token property">display</span><span class="token punctuation">:</span> block</span>
        <span class="token property-declaration"><span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">100%</span></span>
        <span class="token property-declaration"><span class="token property">overflow</span><span class="token punctuation">:</span> hidden</span>
        <span class="token property-declaration"><span class="token property">text-decoration</span><span class="token punctuation">:</span> none</span>
      <span class="token selector">img</span>
        <span class="token property-declaration"><span class="token property">display</span><span class="token punctuation">:</span> block</span>
        <span class="token property-declaration"><span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">100%</span></span>
  <span class="token selector">.dots</span>
    <span class="token property-declaration"><span class="token property">position</span><span class="token punctuation">:</span> absolute</span>
    <span class="token property-declaration"><span class="token property">top</span><span class="token punctuation">:</span> <span class="token number">130.075</span>px</span>
    <span class="token property-declaration"><span class="token property">right</span><span class="token punctuation">:</span> <span class="token number">0</span></span>
    <span class="token property-declaration"><span class="token property">left</span><span class="token punctuation">:</span> <span class="token number">0</span></span>
    <span class="token property-declaration"><span class="token property">bottom</span><span class="token punctuation">:</span> <span class="token number">12</span>px</span>
    <span class="token property-declaration"><span class="token property">text-align</span><span class="token punctuation">:</span> center</span>
    <span class="token property-declaration"><span class="token property">font-size</span><span class="token punctuation">:</span> <span class="token number">0</span></span>
    <span class="token property-declaration"><span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">8</span>px</span>
    <span class="token selector">.dots-item</span>
      <span class="token property-declaration"><span class="token property">display</span><span class="token punctuation">:</span> inline-block</span>
      <span class="token property-declaration"><span class="token property">margin</span><span class="token punctuation">:</span> <span class="token number">0</span> <span class="token number">4</span>px</span>
      <span class="token property-declaration"><span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">8</span>px</span>
      <span class="token property-declaration"><span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">8</span>px</span>
      <span class="token property-declaration"><span class="token property">border-radius</span><span class="token punctuation">:</span> <span class="token number">50%</span></span>
      <span class="token property-declaration"><span class="token property">background</span><span class="token punctuation">:</span> $color-text-l</span>
      <span class="token selector">&amp;.active</span>
        <span class="token property-declaration"><span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">20</span>px</span>
        <span class="token property-declaration"><span class="token property">border-radius</span><span class="token punctuation">:</span> <span class="token number">5</span>px</span>
        <span class="token property-declaration"><span class="token property">background</span><span class="token punctuation">:</span> $color-text-ll</span>
&lt;/style&gt;

</code></pre></div><h5 id="第二步-定义好slider组件的属性"><a href="#第二步-定义好slider组件的属性" class="header-anchor">#</a> 第二步.定义好slider组件的属性</h5> <div class="language-js extra-class"><pre class="language-js"><code> props<span class="token operator">:</span> <span class="token punctuation">{</span>
    loop<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token comment">// *循环轮播</span>
      type<span class="token operator">:</span> Boolean<span class="token punctuation">,</span>
      <span class="token keyword">default</span><span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    autoPlay<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token comment">// *自动轮播</span>
      type<span class="token operator">:</span> Boolean<span class="token punctuation">,</span>
      <span class="token keyword">default</span><span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    interval<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token comment">// *轮播间隔</span>
      type<span class="token operator">:</span> Number<span class="token punctuation">,</span>
      <span class="token keyword">default</span><span class="token operator">:</span> <span class="token number">3000</span>
    <span class="token punctuation">}</span>

</code></pre></div><h5 id="第三步-计算出slider的宽度-然后再根据此设置slidergroup的宽度"><a href="#第三步-计算出slider的宽度-然后再根据此设置slidergroup的宽度" class="header-anchor">#</a> 第三步.计算出slider的宽度 然后再根据此设置sliderGroup的宽度</h5> <div class="language-js extra-class"><pre class="language-js"><code> <span class="token function">_setSliderwidth</span> <span class="token punctuation">(</span><span class="token parameter">isResize</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>children <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>sliderGroup<span class="token punctuation">.</span>children
      <span class="token comment">// better-scroll 会多复制两份</span>
      <span class="token keyword">let</span> width <span class="token operator">=</span> <span class="token number">0</span>
      <span class="token comment">// 拿到slide宽度</span>
      <span class="token keyword">let</span> sliderwidth <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>slider<span class="token punctuation">.</span>clientWidth
      <span class="token comment">// 计算slidegroup的宽度</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>children<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> child <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>children<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
        <span class="token comment">// 添加dom样式</span>
        <span class="token function">addClass</span><span class="token punctuation">(</span>child<span class="token punctuation">,</span> <span class="token string">'slide-item'</span><span class="token punctuation">)</span>
        <span class="token comment">// child的宽度</span>
        child<span class="token punctuation">.</span>style<span class="token punctuation">.</span>width <span class="token operator">=</span> sliderwidth <span class="token operator">+</span> <span class="token string">'px'</span>
        <span class="token comment">// 总宽度</span>
        width <span class="token operator">+=</span> sliderwidth
      <span class="token punctuation">}</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>loop <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>isResize<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 循环切换 width加两倍sliderwidth</span>
        width <span class="token operator">+=</span> <span class="token number">2</span> <span class="token operator">*</span> sliderwidth
      <span class="token punctuation">}</span>
      <span class="token comment">// 设置slider-group宽度</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>sliderGroup<span class="token punctuation">.</span>style<span class="token punctuation">.</span>width <span class="token operator">=</span> width <span class="token operator">+</span> <span class="token string">'px'</span>
    <span class="token punctuation">}</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>其中为每个slider的children添加样式时采用的是调用模块
,通过正则表达式判断是否有该class,然后再将class添加到dom上。</p></div> <p>模块代码dom.js为</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">hasClass</span> <span class="token punctuation">(</span><span class="token parameter">el<span class="token punctuation">,</span> className</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// todo:/(^|\\s)+(className)+(\\s|$)/</span>
  <span class="token keyword">let</span> reg <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token string">'(^|\\s)'</span> <span class="token operator">+</span> className <span class="token operator">+</span> <span class="token string">'(\\s|$)'</span><span class="token punctuation">)</span>
  <span class="token comment">// 判断是否有class</span>
  <span class="token keyword">return</span> reg<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>el<span class="token punctuation">.</span>className<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">addClass</span> <span class="token punctuation">(</span><span class="token parameter">el<span class="token punctuation">,</span> className</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">hasClass</span><span class="token punctuation">(</span>el<span class="token punctuation">,</span> className<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 空白间隔开</span>
  <span class="token keyword">let</span> newClass <span class="token operator">=</span> el<span class="token punctuation">.</span>className<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">)</span>
  newClass<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>className<span class="token punctuation">)</span>
  <span class="token comment">// 连接成新class</span>
  el<span class="token punctuation">.</span>className <span class="token operator">=</span> newClass<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

</code></pre></div><h5 id="第四步-初始化slider"><a href="#第四步-初始化slider" class="header-anchor">#</a> 第四步.初始化slider</h5> <div class="language-js extra-class"><pre class="language-js"><code> <span class="token function">_initSlider</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>slider <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BScroll</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>slider<span class="token punctuation">,</span> <span class="token punctuation">{</span>
        scrollX<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        scrollY<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        <span class="token comment">// !惯性 循环 轮播间隔 可以点击</span>
        momentum<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        snap<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        snapLoop<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>loop<span class="token punctuation">,</span>
        snapThreshold<span class="token operator">:</span> <span class="token number">0.3</span><span class="token punctuation">,</span>
        snapSpeed<span class="token operator">:</span> <span class="token number">300</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h5 id="第五步-添加下方的dots控制器"><a href="#第五步-添加下方的dots控制器" class="header-anchor">#</a> 第五步.添加下方的dots控制器</h5> <div class="language-js extra-class"><pre class="language-js"><code> <span class="token function">data</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      dots<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      currentpageindex<span class="token operator">:</span> <span class="token number">0</span>

    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token function">_initdots</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>dots <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Array</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>children<span class="token punctuation">.</span>length<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
</code></pre></div><h5 id="第六步-计算出轮播下标-实现dots的样式"><a href="#第六步-计算出轮播下标-实现dots的样式" class="header-anchor">#</a> 第六步.计算出轮播下标 实现dots的样式</h5> <p><strong>监听slider的scrollEnd事件 然后获取下标</strong></p> <div class="language-js extra-class"><pre class="language-js"><code> <span class="token comment">// 获取当前下标 滚动派发scrollEnd事件 </span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>slider<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'scrollEnd'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">// pageX 当前pageindex</span>
        <span class="token keyword">let</span> pageIndex <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>slider<span class="token punctuation">.</span><span class="token function">getCurrentPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>pageX
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>loop<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token comment">// 默认第一个元素会添加拷贝 所以要减掉一</span>
          pageIndex <span class="token operator">-=</span> <span class="token number">1</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>currentpageindex <span class="token operator">=</span> pageIndex
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>autoPlay<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token comment">//! 轮播前必须清除 不然跳到第二章图片会stop 然后因为settimeout只执行一次 所以再执行一遍_play()</span>
          <span class="token function">clearTimeout</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>timer<span class="token punctuation">)</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_play</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><p><strong>获取到下标后 给dom设置active样式</strong></p> <div class="language-html extra-class"><pre class="language-html"><code> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>dots<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>(item,index) of dots<span class="token punctuation">&quot;</span></span>
            <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>index<span class="token punctuation">&quot;</span></span>
            <span class="token attr-name">:class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>{active:currentpageindex===index}<span class="token punctuation">&quot;</span></span>
            <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>dots-item<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h5 id="第七步-添加自动轮播"><a href="#第七步-添加自动轮播" class="header-anchor">#</a> 第七步.添加自动轮播</h5> <p><strong>利用better-scroll的goToPage接口实现</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">_play</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">let</span> pageIndex <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>currentpageindex <span class="token operator">+</span> <span class="token number">1</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>loop<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        pageIndex <span class="token operator">+=</span> <span class="token number">1</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>timer <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">// x下标 y下标 每个轮播切换动画300ms 设置时间间隔</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>slider<span class="token punctuation">.</span><span class="token function">goToPage</span><span class="token punctuation">(</span>pageIndex<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>interval<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
</code></pre></div><div class="custom-block warning"><p class="custom-block-title">WARNING</p> <p>注意:此时的轮播图轮播到第二张图还是不会继续自动轮播,这是因为slier的autoplay是设置了setTimeout函数 所以必须在初始化时清除掉timer,然后再重新计算一遍,还需要监听到窗口变化然后重新计算宽度,传一个参数控制是否重新计算</p></div> <div class="language-js extra-class"><pre class="language-js"><code>  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>autoPlay<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token comment">//! 轮播前必须清除 不然跳到第二章图片会stop 然后因为settimeout只执行一次 所以再执行一遍_play()</span>
          <span class="token function">clearTimeout</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>timer<span class="token punctuation">)</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_play</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>

<span class="token operator">...</span><span class="token punctuation">.</span>
 <span class="token function">mounted</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_setSliderwidth</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_initdots</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_initSlider</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>autoPlay<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_play</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span>
    <span class="token comment">// 监听到窗口发生改变就重新计算宽度</span>
    window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'resize'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>slider<span class="token punctuation">)</span> <span class="token punctuation">{</span>

      <span class="token punctuation">}</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_setSliderwidth</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>slider<span class="token punctuation">.</span><span class="token function">refresh</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><div class="custom-block danger"><p class="custom-block-title">WARNING</p> <p>请求recommends是一个异步请求,它加载出资源有延时,所以再slot渲染到父组件前可能recommeds是一个空数组,会导致样式添加失效</p></div> <p><strong>解决方法</strong>:在slider组件的父dom上绑定v-if控制</p> <div class="language-html extra-class"><pre class="language-html"><code>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>recommends.length<span class="token punctuation">&quot;</span></span>
           <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>slider-wrapper<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>slider</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>(item,index) in recommends<span class="token punctuation">&quot;</span></span>
               <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>index<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">:href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>item.linkUrl<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">:src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>item.picUrl<span class="token punctuation">&quot;</span></span>
                   <span class="token attr-name">alt</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>slider</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p><strong>综上,slide组件算是完成了,自己写插件组件还是挺爽的,很有利于造轮子的能力提升</strong></p> <h3 id="推荐歌单页面"><a href="#推荐歌单页面" class="header-anchor">#</a> 推荐歌单页面</h3> <h4 id="基本结构开发-数据获取"><a href="#基本结构开发-数据获取" class="header-anchor">#</a> 基本结构开发 数据获取</h4> <p>dom结构</p> <div class="language-html extra-class"><pre class="language-html"><code> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>recommend-list<span class="token punctuation">&quot;</span></span>
             <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>recommendscroll<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>list-title<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>热门歌单推荐<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>(item,index) in recommendsList<span class="token punctuation">&quot;</span></span>
                <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>index<span class="token punctuation">&quot;</span></span>
                <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>item<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>icon<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>60<span class="token punctuation">&quot;</span></span>
                     <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>60<span class="token punctuation">&quot;</span></span>
                     <span class="token attr-name">v-lazy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>item.imgurl<span class="token punctuation">&quot;</span></span>
                     <span class="token attr-name">alt</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>name<span class="token punctuation">&quot;</span></span>
                    <span class="token attr-name">v-html</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>item.creator.name<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>desc<span class="token punctuation">&quot;</span></span>
                   <span class="token attr-name">v-html</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>item.dissname<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><div class="custom-block warning"><p class="custom-block-title">WARNING</p> <p>这个recommendList获取的数据不是用jsonp抓取的,而是修改devserve代理,利用axios发送ajax数据获取</p></div> <p>代码如下:
首先修改webpac-dev-config.js</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// !模拟数据需要引入的依赖</span>
<span class="token keyword">var</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> axios <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'axios'</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> apiRoutes <span class="token operator">=</span> express<span class="token punctuation">.</span><span class="token function">Router</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">'/api'</span><span class="token punctuation">,</span> apiRoutes<span class="token punctuation">)</span>

  <span class="token function">before</span><span class="token punctuation">(</span><span class="token parameter">app</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'api/getRecommendlist'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                <span class="token keyword">var</span> url <span class="token operator">=</span> <span class="token string">'https://c.y.qq.com/splcloud/fcgi-bin/fcg_get_diss_by_tag.fcg'</span>
                axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token punctuation">{</span>
                    headers<span class="token operator">:</span> <span class="token punctuation">{</span>
                        referer<span class="token operator">:</span> <span class="token string">'https://c.y.qq.com/'</span><span class="token punctuation">,</span>
                        host<span class="token operator">:</span> <span class="token string">'c.y.qq.com'</span>
                    <span class="token punctuation">}</span><span class="token punctuation">,</span>
                    params<span class="token operator">:</span> req<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">response</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                  <span class="token comment">// response是获取到的qq音乐</span>
                  的response
                    res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
</code></pre></div><p>返回回调获取数据</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">getRecommendlist</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> url <span class="token operator">=</span> <span class="token string">'/api/getRecommendlist'</span>
  <span class="token keyword">const</span> data <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> commonParams<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    platform<span class="token operator">:</span> <span class="token string">'yqq'</span><span class="token punctuation">,</span>
    hostUin<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    sin<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    ein<span class="token operator">:</span> <span class="token number">29</span><span class="token punctuation">,</span>
    sortId<span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
    needNewCode<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    categoryId<span class="token operator">:</span> <span class="token number">10000000</span><span class="token punctuation">,</span>
    rnd<span class="token operator">:</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    format<span class="token operator">:</span> <span class="token string">'json'</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    params<span class="token operator">:</span> data
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>css样式</strong>:运用flex布局</p> <div class="language-stylus extra-class"><pre class="language-stylus"><code> <span class="token selector">.recommend-list</span>
      <span class="token selector">.list-title</span>
        <span class="token property-declaration"><span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">65</span>px</span>
        <span class="token property-declaration"><span class="token property">line-height</span><span class="token punctuation">:</span> <span class="token number">65</span>px</span>
        <span class="token property-declaration"><span class="token property">text-align</span><span class="token punctuation">:</span> center</span>
        <span class="token property-declaration"><span class="token property">font-size</span><span class="token punctuation">:</span> $font-size-medium</span>
        <span class="token property-declaration"><span class="token property">color</span><span class="token punctuation">:</span> $color-theme</span>
      <span class="token selector">.item</span>
        <span class="token property-declaration"><span class="token property">display</span><span class="token punctuation">:</span> flex</span>
        <span class="token property-declaration"><span class="token property">box-sizing</span><span class="token punctuation">:</span> border-box</span>
        <span class="token property-declaration"><span class="token property">align-items</span><span class="token punctuation">:</span> center</span>
        <span class="token property-declaration"><span class="token property">padding</span><span class="token punctuation">:</span> <span class="token number">0</span> <span class="token number">20</span>px <span class="token number">20</span>px <span class="token number">20</span>px</span>
        <span class="token selector">.icon</span>
          <span class="token property-declaration"><span class="token property">flex</span><span class="token punctuation">:</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">60</span>px</span>
          <span class="token property-declaration"><span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">60</span>px</span>
          <span class="token property-declaration"><span class="token property">padding-right</span><span class="token punctuation">:</span> <span class="token number">20</span>px</span>
        <span class="token selector">.text</span>
          <span class="token property-declaration"><span class="token property">display</span><span class="token punctuation">:</span> flex</span>
          <span class="token property-declaration"><span class="token property">flex-direction</span><span class="token punctuation">:</span> column</span>
          <span class="token property-declaration"><span class="token property">justify-content</span><span class="token punctuation">:</span> center</span>
          <span class="token property-declaration"><span class="token property">flex</span><span class="token punctuation">:</span> <span class="token number">1</span></span>
          <span class="token property-declaration"><span class="token property">line-height</span><span class="token punctuation">:</span> <span class="token number">20</span>px</span>
          <span class="token property-declaration"><span class="token property">overflow</span><span class="token punctuation">:</span> hidden</span>
          <span class="token property-declaration"><span class="token property">font-size</span><span class="token punctuation">:</span> $font-size-medium</span>
          <span class="token selector">.name</span>
            <span class="token property-declaration"><span class="token property">margin-bottom</span><span class="token punctuation">:</span> <span class="token number">10</span>px</span>
            <span class="token property-declaration"><span class="token property">color</span><span class="token punctuation">:</span> $color-text</span>
          <span class="token selector">.desc</span>
            <span class="token property-declaration"><span class="token property">color</span><span class="token punctuation">:</span> $color-text-d</span>
</code></pre></div><h4 id="scroll组件开发"><a href="#scroll组件开发" class="header-anchor">#</a> scroll组件开发</h4> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>由于better-scroll组件运用起来太命令化,所以自己动手造轮子 开发scroll组件</p></div> <h5 id="_1-定义scroll的属性"><a href="#_1-定义scroll的属性" class="header-anchor">#</a> 1.定义scroll的属性</h5> <div class="language-js extra-class"><pre class="language-js"><code> props<span class="token operator">:</span> <span class="token punctuation">{</span>
    probeType<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token comment">// 监听滚动事件类型</span>
      type<span class="token operator">:</span> Number<span class="token punctuation">,</span>
      <span class="token keyword">default</span><span class="token operator">:</span> <span class="token number">1</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    click<span class="token operator">:</span> <span class="token punctuation">{</span>
      type<span class="token operator">:</span> Boolean<span class="token punctuation">,</span>
      <span class="token keyword">default</span><span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    data<span class="token operator">:</span> <span class="token punctuation">{</span>
      type<span class="token operator">:</span> Array<span class="token punctuation">,</span>
      <span class="token keyword">default</span><span class="token operator">:</span> <span class="token keyword">null</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><h5 id="_2-初始化scroll并代理内置better-scroll方法"><a href="#_2-初始化scroll并代理内置better-scroll方法" class="header-anchor">#</a> 2.初始化scroll并代理内置better-scroll方法</h5> <div class="language-js extra-class"><pre class="language-js"><code> methods<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">_initscroll</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>wrapper<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>scroll <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BSroll</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>wrapper<span class="token punctuation">,</span> <span class="token punctuation">{</span>
        probeType<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>probeType<span class="token punctuation">,</span>
        click<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>click
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">enable</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 启用better-scroll</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>scroll <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>scroll<span class="token punctuation">.</span><span class="token function">enable</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">disable</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 启用better-scroll</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>scroll <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>scroll<span class="token punctuation">.</span><span class="token function">disable</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">refresh</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>scroll <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>scroll<span class="token punctuation">.</span><span class="token function">refresh</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><div class="custom-block danger"><p class="custom-block-title">WARNING</p> <p>scroll的点击事件会和fastClick的点击冲突,解决办法是在dom的父容器上加一个needsclick的class</p></div> <h5 id="监听到传过来的数据就重新计算高度"><a href="#监听到传过来的数据就重新计算高度" class="header-anchor">#</a> 监听到传过来的数据就重新计算高度</h5> <div class="language-js extra-class"><pre class="language-js"><code>watch<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">data</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 监听到data变化 重新refresh计算高度</span>
      <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">refresh</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

</code></pre></div><h5 id="数据懒加载"><a href="#数据懒加载" class="header-anchor">#</a> 数据懒加载</h5> <p>使用vue-lazyload插件</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 传入默认图片参数</span>
Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>VueLazyload<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  loading<span class="token operator">:</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./common/image/default.png'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
然后直接在img标签上将<span class="token operator">:</span>src替换为v<span class="token operator">-</span>lazy就<span class="token constant">OK</span>了

</code></pre></div><div class="custom-block warning"><p class="custom-block-title">WARNING</p> <p>解决bug:等待数据渲染dom之后才能重新计算高度 且要等到完全加载再进行计算</p></div> <p>示例代码
给image添加load事件</p> <div class="language-js extra-class"><pre class="language-js"><code>    <span class="token function">loadimage</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>checkLoaded<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// !图片加载完 重新计算 第一张图片加载就计算高度 后面不需要重新计算</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>scroll<span class="token punctuation">.</span><span class="token function">refresh</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>checkLoaded <span class="token operator">=</span> <span class="token boolean">true</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

</code></pre></div><h5 id="实现效果"><a href="#实现效果" class="header-anchor">#</a> 实现效果</h5> <p><img src="/assets/img/2019-11-17-12-41-51.487c479f.png" alt=""></p> <h3 id="singer组件"><a href="#singer组件" class="header-anchor">#</a> singer组件</h3> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>你通过jsonp拿到的singer数据并不是符合vue调用的jsonp格式
你必须要封装字母表类排序的对象数组</p></div> <h4 id="你拿到的jsonp数据"><a href="#你拿到的jsonp数据" class="header-anchor">#</a> 你拿到的jsonp数据</h4> <p><img src="/assets/img/2019-11-19-17-23-45.7dff38ef.png" alt=""></p> <h4 id="你要做的事情"><a href="#你要做的事情" class="header-anchor">#</a> 你要做的事情</h4> <ul><li>定义一个map对象:里面包含了<strong>热门歌手list对象</strong>(<strong>title,items[]</strong>),还有<strong>歌手list对象</strong>(<strong>title,items</strong>)</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> map<span class="token operator">=</span><span class="token punctuation">{</span>
  hot<span class="token operator">:</span><span class="token punctuation">{</span>
    title<span class="token operator">:</span>'热门，
    items<span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>创建Singer类,后面需要往items数组中push该对象</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">Singer</span><span class="token punctuation">{</span>
<span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span>id<span class="token punctuation">,</span>name<span class="token punctuation">}</span></span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>id<span class="token operator">=</span>id
  <span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token operator">=</span>name
  <span class="token keyword">this</span><span class="token punctuation">.</span>avtar<span class="token operator">=</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">ttps://y.gtimg.cn/music/photo_new/T001R300x300M000</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">.jpg?max_age=2592000</span><span class="token template-punctuation string">`</span></span>
<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><ul><li>循环遍历,封装数据</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>  list<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item<span class="token punctuation">,</span>index</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    <span class="token comment">// 热门歌手区</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>index<span class="token operator">&lt;</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      map<span class="token punctuation">.</span>hot<span class="token punctuation">.</span>items<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Singer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        id<span class="token operator">:</span>item<span class="token punctuation">.</span>Fsinger_mid
        name<span class="token operator">:</span>item<span class="token punctuation">.</span>Fsinger_name
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 歌手区</span>
    <span class="token keyword">const</span> key<span class="token operator">=</span>item<span class="token punctuation">.</span>Findex
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>map<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      map<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">{</span>
        title<span class="token operator">:</span>key<span class="token punctuation">,</span>
        items<span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    map<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">.</span>items<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Singer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      id<span class="token operator">:</span>item<span class="token punctuation">.</span>Fsinger_mid
      name<span class="token operator">:</span>item<span class="token punctuation">.</span>Fsinger_name
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

  <span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre></div><p><strong>这样数据就会变成如下形式</strong>
以字母顺序排列的map对象
<img src="/assets/img/2019-11-19-18-08-15.c37c1a96.png" alt=""></p> <h4 id="对数据进行排序"><a href="#对数据进行排序" class="header-anchor">#</a> 对数据进行排序</h4> <div class="custom-block warning"><p class="custom-block-title">WARNING</p> <p>我们只是用map对象盛满了hot对象和map[key]对象,然而vue遍历对象会是一个无序的结果,所以我们还是要将
对象经过过排序装入数组,得到一个满意的对象数组</p></div> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> hot<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">let</span> singers<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> key <span class="token keyword">in</span> map<span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">let</span> value<span class="token operator">=</span>map<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>value<span class="token punctuation">.</span>title<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token regex">/[a-zA-Z]/</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">// 如果匹配的是字母</span>
    singers<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>value<span class="token punctuation">.</span>title <span class="token operator">===</span> <span class="token string">'热门'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    hot<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token operator">...</span><span class="token punctuation">.</span>
<span class="token keyword">return</span> hot<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>singers<span class="token punctuation">)</span>

</code></pre></div><p><strong>Get到预期的效果</strong>:
<img src="/assets/img/2019-11-19-19-57-52.9d68aa65.png" alt=""></p> <h3 id="实现列表和索引表"><a href="#实现列表和索引表" class="header-anchor">#</a> 实现列表和索引表</h3> <h4 id="列表"><a href="#列表" class="header-anchor">#</a> 列表</h4> <ul><li>dom结构：通常是scroll&gt;ul&gt;li&gt;h2,ul&gt;li&gt;img,name</li></ul> <div class="language-html extra-class"><pre class="language-html"><code> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>(group,index) in data<span class="token punctuation">&quot;</span></span>
          <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>index<span class="token punctuation">&quot;</span></span>
          <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>list-group<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>title<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{group.title}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>(item,index) in group.items<span class="token punctuation">&quot;</span></span>
              <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>index<span class="token punctuation">&quot;</span></span>
              <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>list-group-item<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">v-lazy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>item.avatar<span class="token punctuation">&quot;</span></span>
                 <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>avatar<span class="token punctuation">&quot;</span></span>
                 <span class="token attr-name">alt</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>name<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{item.name}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>

      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>

</code></pre></div><ul><li>css样式:listview相对定位,定义容器为当前屏幕,对应的list-group-item是一个flex布局 ,元素垂直居中对齐</li></ul> <div class="language-stylus extra-class"><pre class="language-stylus"><code><span class="token selector">.listview</span>
  <span class="token property-declaration"><span class="token property">position</span><span class="token punctuation">:</span> relative</span>
  <span class="token property-declaration"><span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">100%</span></span>
  <span class="token property-declaration"><span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">100%</span></span>
  <span class="token property-declaration"><span class="token property">overflow</span><span class="token punctuation">:</span> hidden</span>
  <span class="token property-declaration"><span class="token property">background</span><span class="token punctuation">:</span> $color-background</span>
  <span class="token selector">.list-group</span>
    <span class="token property-declaration"><span class="token property">padding-bottom</span><span class="token punctuation">:</span> <span class="token number">20</span>px</span>
    <span class="token selector">.title</span>
      <span class="token property-declaration"><span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">30</span>px</span>
      <span class="token property-declaration"><span class="token property">line-height</span><span class="token punctuation">:</span> <span class="token number">30</span>px</span>
      <span class="token property-declaration"><span class="token property">padding-left</span><span class="token punctuation">:</span> <span class="token number">20</span>px</span>
      <span class="token property-declaration"><span class="token property">font-size</span><span class="token punctuation">:</span> $font-size-small</span>
      <span class="token property-declaration"><span class="token property">color</span><span class="token punctuation">:</span> $color-text-l</span>
      <span class="token property-declaration"><span class="token property">background</span><span class="token punctuation">:</span> $color-highlight-background</span>
    <span class="token selector">.list-group-item</span>
      <span class="token property-declaration"><span class="token property">display</span><span class="token punctuation">:</span> flex</span>
      <span class="token property-declaration"><span class="token property">align-items</span><span class="token punctuation">:</span> center</span>
      <span class="token property-declaration"><span class="token property">padding</span><span class="token punctuation">:</span> <span class="token number">20</span>px <span class="token number">0</span> <span class="token number">0</span> <span class="token number">30</span>px</span>
      <span class="token selector">.avatar</span>
        <span class="token property-declaration"><span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">50</span>px</span>
        <span class="token property-declaration"><span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">50</span>px</span>
        <span class="token property-declaration"><span class="token property">border-radius</span><span class="token punctuation">:</span> <span class="token number">50%</span></span>
      <span class="token selector">.name</span>
        <span class="token property-declaration"><span class="token property">margin-left</span><span class="token punctuation">:</span> <span class="token number">20</span>px</span>
        <span class="token property-declaration"><span class="token property">color</span><span class="token punctuation">:</span> $color-text-l</span>
        <span class="token property-declaration"><span class="token property">font-size</span><span class="token punctuation">:</span> $font-size-medium</span>
</code></pre></div><h4 id="索引表"><a href="#索引表" class="header-anchor">#</a> 索引表</h4> <ul><li>首先索引表里面的数据是需要截取group.title的第一个字符串 所以这里会对数组进行处理</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 计算属性中定义</span>
 <span class="token function">shortcutlist</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">group</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">// *map方法 得到一个经过处理后的数组 热门区 字母索引区 substr拿第一个字符</span>
        <span class="token keyword">return</span> group<span class="token punctuation">.</span>title<span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>Array.map(callback)方法是返回一个处理过后的数组,
substr(a):取对应下标之后的元素
substr(a,b):取下标为a-b的元素
substring(a):截取对应下标元素
substring(a,b):截取a-b下标的元素</p></div> <ul><li>dom结构</li></ul> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>list-shortcut<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>(item,index) of shortcutlist<span class="token punctuation">&quot;</span></span>
            <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>index<span class="token punctuation">&quot;</span></span>
            <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>item<span class="token punctuation">&quot;</span></span>
            <span class="token attr-name">:data-index</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>index<span class="token punctuation">&quot;</span></span>
            <span class="token attr-name">@touchStart.stop.prevent</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>OnshortcutTouchstart<span class="token punctuation">&quot;</span></span>
            <span class="token attr-name">@touchStop.stop.prevent</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>OnshortcutTouchstop<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{item}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><ul><li>对应样式:1.垂直居中 2.绝对定位靠右  3.对应容器样式</li></ul> <div class="language-stylus extra-class"><pre class="language-stylus"><code>  <span class="token selector">.list-shortcut</span>
    <span class="token property-declaration"><span class="token property">position</span><span class="token punctuation">:</span> absolute</span>
    <span class="token property-declaration"><span class="token property">z-index</span><span class="token punctuation">:</span> <span class="token number">30</span></span>
    <span class="token property-declaration"><span class="token property">right</span><span class="token punctuation">:</span> <span class="token number">0</span></span>
    <span class="token property-declaration"><span class="token property">top</span><span class="token punctuation">:</span> <span class="token number">50%</span></span>
    <span class="token property-declaration"><span class="token property">padding</span><span class="token punctuation">:</span> <span class="token number">20</span>px <span class="token number">0</span></span>
    <span class="token property-declaration"><span class="token property">text-align</span><span class="token punctuation">:</span> center</span>
    <span class="token property-declaration"><span class="token property">border-radius</span><span class="token punctuation">:</span> <span class="token number">10</span>px</span>
    <span class="token property-declaration"><span class="token property">transform</span><span class="token punctuation">:</span> <span class="token func"><span class="token function">translateY</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">50%</span><span class="token punctuation">)</span></span></span>
    <span class="token property-declaration"><span class="token property">background</span><span class="token punctuation">:</span> $color-background-d</span>
    <span class="token property-declaration"><span class="token property">font-family</span><span class="token punctuation">:</span> Helvetica</span>
    <span class="token selector">.item</span>
      <span class="token property-declaration"><span class="token property">padding</span><span class="token punctuation">:</span> <span class="token number">3</span>px</span>
      <span class="token property-declaration"><span class="token property">line-height</span><span class="token punctuation">:</span> <span class="token number">1</span></span>
      <span class="token property-declaration"><span class="token property">color</span><span class="token punctuation">:</span> $color-text-l</span>
      <span class="token property-declaration"><span class="token property">font-size</span><span class="token punctuation">:</span> $font-size-small</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>通常是使一个容器垂直方向居中的做法是：
posiition:absolute
top:50%
margin-top:-height
但是这是在知道容器高度的前提下，我们在不知道元素高度的前提下使用transform平移的方法来进行处理
posiition:absolute
top:50%
transform:translateY(-50%)</p></div> <p><img src="/assets/img/2019-11-25-23-50-55.80c39311.png" alt=""></p> <h3 id="索引列表联动实现"><a href="#索引列表联动实现" class="header-anchor">#</a> 索引列表联动实现</h3> <h4 id="功能分析"><a href="#功能分析" class="header-anchor">#</a> 功能分析</h4> <ul><li><h4>点击右侧shortcut区域,能够实现左侧歌手列表区的滚动到相应的标题</h4></li> <li><h4>滑动右侧的shrotcut区域,能够实现左侧滚动 左侧滚动也能映射右边的shortcut区域高亮</h4></li> <li><h4>歌手列表区有一个固定标题，帮助读者查询当前区域</h4></li></ul> <br> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>js的touchstart()和touchmove能够有效地帮助实现功能</p></div> <h4 id="点击滚屏实现"><a href="#点击滚屏实现" class="header-anchor">#</a> 点击滚屏实现</h4> <div class="custom-block warning"><p class="custom-block-title">业务分析</p> <ol><li>获取到右侧索引区域的下标 触发一个touchstart事件<br></li> <li>封装原先定义好的scroll组件,添加scrollTo和scrollToElemnet事件<br></li> <li>设置两个ref,分别是scroll父dom和group子dom,调用scrollToElement Api</li></ol></div> <h4 id="获取右侧索引区域下标"><a href="#获取右侧索引区域下标" class="header-anchor">#</a> 获取右侧索引区域下标</h4> <div class="custom-block tip"><p class="custom-block-title">推荐</p> <p>推荐封装一个方法来获取dom中的变量的值</p></div> <p><strong>dom.js</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">getData</span><span class="token punctuation">(</span><span class="token parameter">el<span class="token punctuation">,</span>name<span class="token punctuation">,</span>val</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
<span class="token comment">// shortcut区域定义data-name变量 记录index等属性</span>
  <span class="token keyword">const</span> prefix<span class="token operator">=</span><span class="token string">'data-'</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> el<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span>prefix <span class="token operator">+</span> name<span class="token punctuation">,</span>val<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> el<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span>prefix <span class="token operator">+</span> name<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>获取到了index之后 对scroll组件代理两个滚动方法</strong></p> <div class="language-js extra-class"><pre class="language-js"><code>methods<span class="token operator">:</span><span class="token punctuation">{</span>
<span class="token operator">...</span>
<span class="token function">scrollTo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token comment">// 通过apply改变this指向为this.scroll这个betterscroll的实例中 其实就是betterscroll的这个方法的参数修改为this.scroll</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>scroll <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">scrollTo</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>scroll<span class="token punctuation">,</span>argument<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">scrollToElement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>scroll <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">scrollToElement</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>scroll<span class="token punctuation">,</span>argument<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><p><strong>调用scrollToElement事件</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> touchstartindex<span class="token operator">=</span><span class="token function">getData</span><span class="token punctuation">(</span>el<span class="token punctuation">.</span>target<span class="token punctuation">,</span><span class="token string">'index'</span><span class="token punctuation">)</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>scorll<span class="token punctuation">.</span><span class="token function">scrollToElement</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>listgroup<span class="token punctuation">[</span>touchstartindex<span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="滑动滚屏实现"><a href="#滑动滚屏实现" class="header-anchor">#</a> 滑动滚屏实现</h4> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>获取touchstart记录的y值和touchmove记录的y值,计算二者之间差值,然后除以锚点的高度[padding+高度],计算出锚点数量,滑动到位置的下标就等于刚开始的touchstart的下标+锚点数量</p></div> <div class="language-js extra-class"><pre class="language-js"><code> <span class="token function">onshortcutTouchstart</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
   <span class="token keyword">let</span> touchstartindex<span class="token operator">=</span><span class="token function">getData</span><span class="token punctuation">(</span>el<span class="token punctuation">.</span>target<span class="token punctuation">,</span><span class="token string">'index'</span><span class="token punctuation">)</span>
   <span class="token keyword">let</span> firstTouch<span class="token operator">=</span>e<span class="token punctuation">.</span>touches<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
   <span class="token keyword">this</span><span class="token punctuation">.</span>touch<span class="token punctuation">.</span>y1<span class="token operator">=</span>firstTouch<span class="token punctuation">.</span>pageY
   <span class="token keyword">this</span><span class="token punctuation">.</span>touch<span class="token punctuation">.</span>startindex<span class="token operator">=</span>toustartindex
 <span class="token punctuation">}</span>
 <span class="token function">onshortcutTouchmove</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">let</span> firstTouch<span class="token operator">=</span>e<span class="token punctuation">.</span>touched<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>touch<span class="token punctuation">.</span>y2<span class="token operator">=</span>firstTouch<span class="token punctuation">.</span>pageY
  <span class="token keyword">let</span> moveindex<span class="token operator">=</span>Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>touch<span class="token punctuation">.</span>y2<span class="token operator">-</span><span class="token keyword">this</span><span class="token punctuation">,</span>touch<span class="token punctuation">.</span>y1<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">18</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>touch<span class="token punctuation">.</span>startindex<span class="token punctuation">)</span>
  <span class="token function">_scrollToElement</span><span class="token punctuation">(</span>moveindex<span class="token punctuation">)</span>

 <span class="token punctuation">}</span>
</code></pre></div><div class="custom-block danger"><p class="custom-block-title">WARNING</p> <p>此处应该连续滚屏事件 给scroll传一个probeType:3
经过处理后就可以实现滑动右侧索引区域左侧跟着滚动了</p></div> <h4 id="滑动左侧区域实现右侧高亮显示"><a href="#滑动左侧区域实现右侧高亮显示" class="header-anchor">#</a> 滑动左侧区域实现右侧高亮显示</h4> <div class="custom-block tip"><p class="custom-block-title">业务逻辑</p> <ol><li>首先要监听scroll的scroll事件,然后算出左侧滚屏的位置</li> <li>算出滚屏的位置后，计算出各个group的高度，存入listheight数组中</li> <li>根据这个高度数组，监听scrollY的变化，计算出currentindex的值 就是当前是哪一个title</li> <li>根据currentindex确定是哪一个index需要加高亮的样式</li></ol></div> <h5 id="步骤一-监听scroll事件"><a href="#步骤一-监听scroll事件" class="header-anchor">#</a> 步骤一 监听scroll事件</h5> <p>首先要给scroll传入一个listenscroll的boolean变量，然后在初始化的时候确定是否调用监听的事件，然后向父组件传一个scroll事件</p> <div class="language-js extra-class"><pre class="language-js"><code>props<span class="token operator">:</span><span class="token punctuation">{</span>
<span class="token operator">...</span>
listenscroll<span class="token operator">:</span><span class="token punctuation">{</span>
  type<span class="token operator">:</span> Boolean<span class="token punctuation">,</span>
  <span class="token keyword">default</span><span class="token operator">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span>
methods<span class="token operator">:</span><span class="token punctuation">{</span>
<span class="token function">_initscroll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token operator">...</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>listenscroll<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">let</span> me <span class="token operator">=</span> <span class="token keyword">this</span> <span class="token comment">//这里要确保this指向vue实例</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>scroll<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'scroll'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">pos</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
      me<span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">'scroll'</span><span class="token punctuation">,</span>pos<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><div class="custom-block warning"><p class="custom-block-title">注意</p> <p><strong>定义好后父组件在created钩子中定义listenscroll为true传入子组件</strong></p></div> <h5 id="步骤二-计算scrolly的值和各个group的高度"><a href="#步骤二-计算scrolly的值和各个group的高度" class="header-anchor">#</a> 步骤二 计算scrollY的值和各个Group的高度</h5> <p>计算这两个高度之前，先想一下为什么要计算出滚屏的高度，和各个group的高度<br> <code>scrollY:用来计算滚屏的位置,后面通过watch监听这个滚屏的变化就能计算出当前的title</code><br> <code>listheight:确定各个group的高度,一个上限 一个下限确定当前的currentindex的值</code><br></p> <div class="language-js extra-class"><pre class="language-js"><code>scroll组件绑定处理scroll事件
@scroll<span class="token operator">=</span><span class="token string">&quot;handlescroll&quot;</span>
methods：<span class="token punctuation">{</span>
  <span class="token function">handlescroll</span><span class="token punctuation">(</span><span class="token parameter">pos</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>scrollY<span class="token operator">=</span>pos<span class="token punctuation">.</span>y
    <span class="token comment">// scroll.Y是一个负数 顶部部分是会大于0</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><p>计算出各个group的高度</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">_calculateheight</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">const</span> singerlist<span class="token operator">=</span><span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>listgroup
  <span class="token keyword">let</span> height<span class="token operator">=</span><span class="token number">0</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>listheight<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>height<span class="token punctuation">)</span>
  <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i<span class="token operator">=</span><span class="token number">0</span> <span class="token punctuation">;</span>i<span class="token operator">&lt;</span>singerlist<span class="token punctuation">.</span>length<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">let</span> item<span class="token operator">=</span>singerlist<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>clientHeight
    height<span class="token operator">+=</span>item
    <span class="token keyword">this</span><span class="token punctuation">.</span>listheight<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>height<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h5 id="步骤三-监听data-scrolly计算出currentindex"><a href="#步骤三-监听data-scrolly计算出currentindex" class="header-anchor">#</a> 步骤三 监听data,scrollY计算出currentindex</h5> <p>每当data变化时，重新计算高度</p> <div class="language-js extra-class"><pre class="language-js"><code>watch<span class="token operator">:</span><span class="token punctuation">{</span>
  <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_calculateheight</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><p>计算currentindex之前,想一下之前做过的外卖项目
之前计算出currentindex是这样做的:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">currentindex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token keyword">this</span><span class="token punctuation">.</span>listheight<span class="token punctuation">.</span>length<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">let</span> height1<span class="token operator">=</span><span class="token keyword">this</span><span class="token punctuation">.</span>listheight<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
    <span class="token keyword">let</span> height2<span class="token operator">=</span><span class="token keyword">this</span><span class="token punctuation">.</span>listheight<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>height <span class="token operator">||</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>scorllY<span class="token operator">&gt;=</span>height1 <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>scorllY<span class="token operator">&lt;</span>height2<span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">return</span> i<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="custom-block danger"><p class="custom-block-title">WARNING</p> <p>但是你会发现,当滚屏滚动到顶部或者底步的时候scrollY的值可能永远取不到那个范围，会出现高亮bug，所以进行进一步改善。</p></div> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">scrollY</span><span class="token punctuation">(</span><span class="token parameter">newY</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 滚屏顶部 <span class="token operator">--</span><span class="token operator">&gt;</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>newY <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>currentindex<span class="token operator">=</span><span class="token number">0</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 中间部分</span>
  <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>listheight<span class="token punctuation">.</span>length<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">let</span> height1 <span class="token operator">=</span> listHeight<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
        <span class="token keyword">let</span> height2 <span class="token operator">=</span> listHeight<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span>
        <span class="token comment">//  listheight的元素比索引表元素多一个 listHeight 0~23 右侧 0~22</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">-</span>newY <span class="token operator">&gt;=</span> height1 <span class="token operator">&amp;&amp;</span> <span class="token operator">-</span>newY <span class="token operator">&lt;</span> height2<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// !height2表示列表的最后一项</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span>currentindex <span class="token operator">=</span> i
          <span class="token keyword">this</span><span class="token punctuation">.</span>diff <span class="token operator">=</span> height2 <span class="token operator">+</span> newY
          <span class="token comment">// console.log(this.currentIndex)</span>
          <span class="token keyword">return</span>
        <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 底部 由于listgroup的元素比shorcut的元素多一个 所以就应该减去一个</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>currentindex <span class="token operator">=</span> listheight<span class="token punctuation">.</span>length<span class="token operator">-</span><span class="token number">2</span>
<span class="token punctuation">}</span>

</code></pre></div><p>这些工作做完之后,在shortcut上绑定动态样式即可显示高亮</p> <h5 id="fixedtitle"><a href="#fixedtitle" class="header-anchor">#</a> Fixedtitle</h5> <blockquote><p>为了达到体验优化的最大化,上下滑动列表固定一个title区块,当数据加载成功时,title的值跟着list滚动而滚动,watch监听能够帮助到你</p></blockquote> <ul><li>确认业务逻辑(我们要做的就是把fixedtitle显示出来,可以通过计算属性吧fixedtitle内容计算出，然后应用在dom)<br>
dom结构</li></ul> <div class="language-html extra-class"><pre class="language-html"><code>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>fixedtitle<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name">v-show</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>fixedtitle<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>fixed<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>title<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{fixedtitle}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><div class="language-stylus extra-class"><pre class="language-stylus"><code>  <span class="token selector">.fixedtitle</span>
    <span class="token property-declaration"><span class="token property">position</span><span class="token punctuation">:</span> absolute</span>
    <span class="token property-declaration"><span class="token property">left</span><span class="token punctuation">:</span> <span class="token number">0</span></span>
    <span class="token property-declaration"><span class="token property">top</span><span class="token punctuation">:</span> <span class="token number">0</span></span>
    <span class="token property-declaration"><span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">100%</span></span>
    <span class="token selector">.title</span>
      <span class="token property-declaration"><span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">30</span>px</span>
      <span class="token property-declaration"><span class="token property">line-height</span><span class="token punctuation">:</span> <span class="token number">30</span>px</span>
      <span class="token property-declaration"><span class="token property">padding-left</span><span class="token punctuation">:</span> <span class="token number">20</span>px</span>
      <span class="token property-declaration"><span class="token property">font-size</span><span class="token punctuation">:</span> $font-size-small</span>
      <span class="token property-declaration"><span class="token property">color</span><span class="token punctuation">:</span> $color-text-l</span>
      <span class="token property-declaration"><span class="token property">background</span><span class="token punctuation">:</span> $color-highlight-background</span>
</code></pre></div><ul><li>计算出fixedtitle的值,v-show控制显示</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>computed<span class="token operator">:</span><span class="token punctuation">{</span>
  <span class="token function">fixedtitle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>scrollY<span class="token operator">&gt;</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token string">''</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>currentindex<span class="token punctuation">]</span><span class="token operator">?</span><span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>currentindex<span class="token punctuation">]</span><span class="token punctuation">.</span>title<span class="token operator">:</span><span class="token string">''</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><div class="custom-block tip"><p class="custom-block-title">建议</p> <p>这样显示会有一个小bug,就是当滑动到标题交替处会出现标题重叠的现象，影响体验,可以通过计算出diff距离的大小将上一个title平移上去</p></div> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 这里是计算滚动位置距离上限的差值</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>diff<span class="token operator">=</span>height2<span class="token operator">+</span>newY
watch<span class="token operator">:</span><span class="token punctuation">{</span>
<span class="token function">diff</span><span class="token punctuation">(</span><span class="token parameter">newval</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">let</span> fixedTop<span class="token operator">=</span><span class="token punctuation">(</span>newval <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> newcal <span class="token operator">&lt;</span>titleHeight <span class="token punctuation">)</span> <span class="token operator">?</span> newval<span class="token operator">-</span>titleHight <span class="token operator">:</span> <span class="token number">0</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>fixedTop <span class="token operator">===</span> fixedTop<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> 
    <span class="token comment">// 避免重复计算</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>fixedTop<span class="token operator">=</span>fixedTop
  <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>fixed<span class="token punctuation">.</span>style<span class="token punctuation">.</span>transform<span class="token operator">=</span><span class="token string">'translate3d(0,`${fixedTop}px`,0)'</span>
<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><hr> <p>综上,singer的listview组件开发完成,读者可以借鉴listview里面才用的经验去处理一系列的<strong>索引表</strong>问题,<a href="https://github.com/251205668/mymusic" target="_blank" rel="noopener noreferrer">star<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>别忘了</p> <h3 id="歌手详情页"><a href="#歌手详情页" class="header-anchor">#</a> 歌手详情页</h3> <h4 id="封装数据"><a href="#封装数据" class="header-anchor">#</a> 🔮封装数据</h4> <div class="custom-block tip"><p class="custom-block-title">分析</p> <p>我们拿到的数据里面如下图,歌手详情页面的 hotsongs 是我们想要的数据 <code>name</code>是歌曲名 <code>al</code>专辑相关 <code>ar</code>歌曲演唱的歌手 还有就是歌手名 mvid 等等</p></div> <p><img src="https://i.loli.net/2019/12/28/YfydjNwxLZvcFgi.png" alt="QQ截图20191228225755.png"></p> <blockquote><p>以后遇到这种需要封装数据到一个对象 就应该用工厂模式去实例一个类 然后遍历数据添加对象到初始化数组里即可</p></blockquote> <p>创建 song 类</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">Song</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> id<span class="token punctuation">,</span> singer<span class="token punctuation">,</span> name<span class="token punctuation">,</span> album<span class="token punctuation">,</span> image<span class="token punctuation">,</span> mv <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>id <span class="token operator">=</span> id
    <span class="token keyword">this</span><span class="token punctuation">.</span>singer <span class="token operator">=</span> singer
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name
    <span class="token keyword">this</span><span class="token punctuation">.</span>album <span class="token operator">=</span> album
    <span class="token keyword">this</span><span class="token punctuation">.</span>image <span class="token operator">=</span> image
    <span class="token keyword">this</span><span class="token punctuation">.</span>mv <span class="token operator">=</span> mv
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>工厂模式创建实例函数</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">createSong</span><span class="token punctuation">(</span><span class="token parameter">music</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Song</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token comment">// 根据api修改参数</span>
    id<span class="token operator">:</span> music<span class="token punctuation">.</span>id<span class="token punctuation">,</span>
    singer<span class="token operator">:</span> <span class="token function">filterSinger</span><span class="token punctuation">(</span>music<span class="token punctuation">.</span>ar<span class="token punctuation">)</span><span class="token punctuation">,</span>
    name<span class="token operator">:</span> music<span class="token punctuation">.</span>name<span class="token punctuation">,</span>
    album<span class="token operator">:</span> music<span class="token punctuation">.</span>al<span class="token punctuation">.</span>name<span class="token punctuation">,</span> <span class="token comment">//专辑名</span>
    image<span class="token operator">:</span> music<span class="token punctuation">.</span>al<span class="token punctuation">.</span>picUrl<span class="token punctuation">,</span>
    mv<span class="token operator">:</span> music<span class="token punctuation">.</span>mv<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="custom-block warning"><p class="custom-block-title">注意</p> <p>这里的歌手不止一个,这种情况就定义函数返回一个分隔开歌手数据的数组</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">filterSinger</span><span class="token punctuation">(</span><span class="token parameter">singer</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> ret <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  ret <span class="token operator">=</span> singer<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> item<span class="token punctuation">.</span>name
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> ret<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <p>事先做好的事情都准备好了，开始处理数据</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">_normalizeSong</span><span class="token punctuation">(</span><span class="token parameter">list</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">let</span> ret<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
  list<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    ret<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token function">createSong</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> ret
<span class="token punctuation">}</span>
</code></pre></div><p><s>## 📣总结</s> <s>这样就完成了所有的封装数据任务,后续要完成的事情就是利用数据完成 singerDetail 组件,加油！</s></p> <h4 id="详情页开发"><a href="#详情页开发" class="header-anchor">#</a> 💥详情页开发</h4> <h5 id="singerdetail"><a href="#singerdetail" class="header-anchor">#</a> 💽singerdetail</h5> <div class="custom-block warning"><p class="custom-block-title">WARNING</p> <p>首先解决上一次开发遗留下的问题:处理 song 数据然后向 list 数组中添加工厂对象 forEach 会报错,原因是请求数据是异步加载 页面刚没渲染 item 就没有值 就会报错</p></div> <p><strong>解决办法：</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 定义一个监控data变量</span>
<span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    listdetail<span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    node<span class="token operator">:</span><span class="token keyword">null</span>

  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
methods<span class="token operator">:</span><span class="token punctuation">{</span>
  <span class="token function">getSingerdetail</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>singer<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>node<span class="token operator">=</span>res<span class="token punctuation">.</span>data<span class="token punctuation">.</span>hotsongs
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
watch<span class="token operator">:</span><span class="token punctuation">{</span>
  <span class="token function">node</span><span class="token punctuation">(</span><span class="token parameter">val</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>listdetail<span class="token operator">=</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_normalize</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>


</code></pre></div><p><code>watch</code>监听到数据把数据置于代理变量中 然后传给子组件 就可以解决异步加载的问题</p> <p>数据解决完毕后,开发 dom</p> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>transition</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>change<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>singer-detail<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token comment">&lt;!-- musiclist音乐列表组件 --&gt;</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>musiclist</span>
        <span class="token attr-name">:songs</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>listdetail<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">:title</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>title<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">:bgImage</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>bgimage<span class="token punctuation">&quot;</span></span>
      <span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>musiclist</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>transition</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>这样点击链接跳转到子路由的太干了，设置一个进场动画</p> <div class="language-stylus extra-class"><pre class="language-stylus"><code><span class="token selector">.change-enter-active<span class="token punctuation">,</span>.change-leave-active</span>
  <span class="token property-declaration"><span class="token property">transition</span><span class="token punctuation">:</span> all <span class="token number">0.3</span>s</span>
<span class="token selector">.change-enter<span class="token punctuation">,</span>.change-leave-to</span>
  <span class="token comment">//向由往左划 入场相反</span>
  <span class="token property-declaration"><span class="token property">transform</span><span class="token punctuation">:</span><span class="token func"><span class="token function">translate3d</span><span class="token punctuation">(</span><span class="token number">100%</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span></span></span>
</code></pre></div><p>由此联想到设置加载中的时候也用到了 translateY 设置居中显示
总结一下页面居中技巧</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <ol><li>已知元素的宽高,设置元素决定定位居中显示</li></ol> <div class="language-css extra-class"><pre class="language-css"><code><span class="token property">position</span><span class="token punctuation">:</span>absolute<span class="token punctuation">;</span>
<span class="token property">top</span><span class="token punctuation">:</span>50%<span class="token punctuation">;</span>
<span class="token property">left</span><span class="token punctuation">:</span>50%<span class="token punctuation">;</span>
<span class="token property">margin-left</span><span class="token punctuation">:</span>-50%width
<span class="token property">margin-top</span><span class="token punctuation">:</span>-50%height
</code></pre></div><ol start="2"><li>未知宽高,设置元素居中</li></ol> <div class="language-css extra-class"><pre class="language-css"><code><span class="token property">position</span><span class="token punctuation">:</span>absolute<span class="token punctuation">;</span>
<span class="token property">top</span><span class="token punctuation">:</span>50%
<span class="token property">left</span><span class="token punctuation">:</span>50%
<span class="token property">transform</span><span class="token punctuation">:</span><span class="token function">translate3d</span><span class="token punctuation">(</span>-50%<span class="token punctuation">,</span>-50%<span class="token punctuation">,</span>0<span class="token punctuation">)</span>
</code></pre></div><ol start="3"><li>利用 flex 布局进行垂直居中</li></ol> <div class="language-css extra-class"><pre class="language-css"><code><span class="token property">display</span><span class="token punctuation">:</span>flex
//横轴
<span class="token property">justify-content</span><span class="token punctuation">:</span>center
纵轴
<span class="token property">aligin-items</span><span class="token punctuation">:</span>center
</code></pre></div></div> <h5 id="mmusiclist"><a href="#mmusiclist" class="header-anchor">#</a> 📀mmusiclist</h5> <p><code>musiclist</code>包括<code>back</code>图标 <code>bg-image</code>背景图 <code>filter</code>蒙层 <code>play-wrapper</code>随机播放按钮 <code>songlist</code>歌曲列表组件 <code>loading</code>加载组件
dom 结构</p> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>music-list<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>back<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>back<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>icon-back<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>i</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>title<span class="token punctuation">&quot;</span></span> <span class="token attr-name">v-html</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>title<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>bg-image<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:</span><span class="token style-attr language-css"><span class="token attr-name"><span class="token attr-name">style</span></span><span class="token punctuation">=&quot;</span><span class="token attr-value">bgimage</span><span class="token punctuation">&quot;</span></span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>image<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>filter<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>play-wrapper<span class="token punctuation">&quot;</span></span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>playwrapper<span class="token punctuation">&quot;</span></span> <span class="token attr-name">v-show</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>songs.length<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>play-button<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>icon-play<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>i</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>随机播放热门歌曲<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>layer<span class="token punctuation">&quot;</span></span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>layer<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scroll</span>
      <span class="token attr-name">:probeType</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>probetype<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">:listenScroll</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">@scroll</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>scroll<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">:data</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>songs<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>list<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>list<span class="token punctuation">&quot;</span></span>
    <span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>songlist-wrapper<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>songlist</span> <span class="token attr-name">:songs</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>songs<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>songlist</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scroll</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-show</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>!songs.length<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>loading-container<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>loading</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>loading</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h3>样式书写</h3> <div class="language-stylus extra-class"><pre class="language-stylus"><code><span class="token selector">.music-list</span>
  <span class="token property-declaration"><span class="token property">position</span><span class="token punctuation">:</span>fixed</span>
  <span class="token property-declaration"><span class="token property">top</span><span class="token punctuation">:</span><span class="token number">0</span></span>
  <span class="token property-declaration"><span class="token property">right</span><span class="token punctuation">:</span><span class="token number">0</span></span>
  <span class="token property-declaration"><span class="token property">left</span><span class="token punctuation">:</span><span class="token number">0</span></span>
  <span class="token property-declaration"><span class="token property">bottom</span><span class="token punctuation">:</span><span class="token number">0</span></span>
  <span class="token property-declaration"><span class="token property">z-index</span><span class="token punctuation">:</span><span class="token number">100</span></span>
  <span class="token property-declaration"><span class="token property">background-color</span><span class="token punctuation">:</span>$color-background</span>
  <span class="token selector">.back</span>
    <span class="token property-declaration"><span class="token property">position</span><span class="token punctuation">:</span>absolute</span>
    <span class="token property-declaration"><span class="token property">top</span> <span class="token number">0</span></span>
    <span class="token property-declaration"><span class="token property">left</span> <span class="token number">6</span>px</span>
    <span class="token property-declaration"><span class="token property">z-index</span> <span class="token number">50</span></span>
    <span class="token selector">.icon-back</span>
      <span class="token property-declaration"><span class="token property">display</span> block</span>
      <span class="token property-declaration"><span class="token property">font-size</span> $font-size-large-x</span>
      <span class="token property-declaration"><span class="token property">padding</span> <span class="token number">10</span>px</span>
      <span class="token property-declaration"><span class="token property">color</span> $color-theme</span>
  <span class="token selector">.title</span>
    <span class="token property-declaration"><span class="token property">position</span><span class="token punctuation">:</span>absolute</span>
    <span class="token property-declaration"><span class="token property">top</span> <span class="token number">0</span></span>
    <span class="token property-declaration"><span class="token property">left</span> <span class="token number">10%</span></span>
    <span class="token property-declaration"><span class="token property">width</span> <span class="token number">80%</span></span>
    <span class="token property-declaration"><span class="token property">line-height</span> <span class="token number">40</span>px</span>
    <span class="token property-declaration"><span class="token property">font-size</span> $font-size-large</span>
    <span class="token property-declaration"><span class="token property">color</span> $color-text</span>
    <span class="token property-declaration"><span class="token property">text-align</span> center</span>
    <span class="token property-declaration"><span class="token property">z-index</span> <span class="token number">40</span></span>
    <span class="token func"><span class="token function">no-wrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
  <span class="token selector">.bg-image</span>
    <span class="token property-declaration"><span class="token property">position</span> relative</span>
    <span class="token property-declaration"><span class="token property">width</span> <span class="token number">100%</span></span>
    <span class="token property-declaration"><span class="token property">height</span> <span class="token number">0</span></span>
    <span class="token property-declaration"><span class="token property">padding-top</span> <span class="token number">70%</span></span>
    <span class="token property-declaration"><span class="token property">transform-origin</span> top</span>
    <span class="token property-declaration"><span class="token property">background-size</span> cover</span>
    <span class="token selector">.play-wrapper</span>
      <span class="token property-declaration"><span class="token property">position</span> absolute</span>
      <span class="token property-declaration"><span class="token property">bottom</span> <span class="token number">20</span>px</span>
      <span class="token property-declaration"><span class="token property">z-index</span> <span class="token number">50</span></span>
      <span class="token property-declaration"><span class="token property">width</span> <span class="token number">100%</span></span>
      <span class="token selector">.play-button</span>
        <span class="token property-declaration"><span class="token property">box-sizing</span> border-box</span>
        <span class="token property-declaration"><span class="token property">width</span> <span class="token number">9.685</span>rem</span>
        <span class="token property-declaration"><span class="token property">padding</span> <span class="token number">7</span>px <span class="token number">0</span></span>
        <span class="token property-declaration"><span class="token property">margin</span> <span class="token number">0</span> auto</span>
        <span class="token property-declaration"><span class="token property">text-align</span> center</span>
        <span class="token property-declaration"><span class="token property">border</span> <span class="token number">1</span>px solid $color-theme</span>
        <span class="token property-declaration"><span class="token property">color</span> $color</span>
        <span class="token selector">.icon-play</span>
          <span class="token property-declaration"><span class="token property">display</span> inline-block</span>
          <span class="token property-declaration"><span class="token property">vertical-align</span> middle</span>
          <span class="token property-declaration"><span class="token property">margin-right</span> <span class="token number">6</span>px</span>
          <span class="token property-declaration"><span class="token property">font-size</span> $font-size-medium-x</span>
        <span class="token selector">.text</span>
          <span class="token property-declaration"><span class="token property">display</span> inline-block</span>
          <span class="token property-declaration"><span class="token property">vertical-aligin</span> middle</span>
          <span class="token property-declaration"><span class="token property">font-size</span> $font-size-small</span>
    <span class="token selector">.filter</span>
      <span class="token property-declaration"><span class="token property">position</span> absolute</span>
      <span class="token property-declaration"><span class="token property">top</span> <span class="token number">0</span></span>
      <span class="token property-declaration"><span class="token property">left</span> <span class="token number">0</span></span>
      <span class="token property-declaration"><span class="token property">width</span> <span class="token number">100%</span></span>
      <span class="token property-declaration"><span class="token property">height</span> <span class="token number">100%</span></span>
      <span class="token property-declaration"><span class="token property">background</span> <span class="token func"><span class="token function">rgba</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">17</span><span class="token punctuation">,</span><span class="token number">27</span><span class="token punctuation">,</span><span class="token number">0.4</span><span class="token punctuation">)</span></span></span>
  <span class="token selector">.layer</span>
    <span class="token comment">//除了bg-image的屏幕内容 用于计算高度</span>
    <span class="token property-declaration"><span class="token property">position</span> relative</span>
    <span class="token property-declaration"><span class="token property">height</span> <span class="token number">100%</span></span>
    <span class="token property-declaration"><span class="token property">background</span> $color-background</span>
  <span class="token selector">.list</span>
    <span class="token property-declaration"><span class="token property">position</span> fixed</span>
    <span class="token property-declaration"><span class="token property">top</span> <span class="token number">0</span></span>
    <span class="token property-declaration"><span class="token property">bottom</span> <span class="token number">0</span></span>
    <span class="token property-declaration"><span class="token property">width</span> <span class="token number">100%</span></span>
    <span class="token property-declaration"><span class="token property">background</span> $color-background</span>
    <span class="token selector">.songlist-wrapper</span>
      <span class="token property-declaration"><span class="token property">padding</span> <span class="token number">20</span>px <span class="token number">30</span>px</span>
  <span class="token selector">.loading-container</span>
    <span class="token property-declaration"><span class="token property">position</span> absolute</span>
    <span class="token property-declaration"><span class="token property">width</span> <span class="token number">100%</span></span>
    <span class="token property-declaration"><span class="token property">top</span> <span class="token number">60%</span></span>
    <span class="token property-declaration"><span class="token property">transform</span> <span class="token func"><span class="token function">translateY</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">50%</span><span class="token punctuation">)</span></span></span>

</code></pre></div><p>样式书写完成后,开始书写逻辑部分</p> <ul><li>bgimage 用 computed 获取</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>computed<span class="token operator">:</span><span class="token punctuation">{</span>
  <span class="token function">bgimage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">background-image:url(</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>bgimage<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">)</span><span class="token template-punctuation string">`</span></span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>soglist 开发</li></ul> <p>直接贴代码,比较简单</p> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>songlist<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>(item, index) in songs<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>index<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>item<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>content<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>name<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            {{ item.name }}
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>desc<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{ getdesc(item) }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">'songlist'</span><span class="token punctuation">,</span>
  props<span class="token operator">:</span> <span class="token punctuation">{</span>
    songs<span class="token operator">:</span> <span class="token punctuation">{</span>
      type<span class="token operator">:</span> Array<span class="token punctuation">,</span>
      <span class="token comment">// default: []</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  components<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>

  computed<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">desc</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>songs<span class="token punctuation">.</span>singer <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>songs<span class="token punctuation">.</span>album
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token function">beforeMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token function">mounted</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>songs<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  methods<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">getdesc</span><span class="token punctuation">(</span><span class="token parameter">song</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>song<span class="token punctuation">.</span>singer<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">-</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>song<span class="token punctuation">.</span>album<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  watch<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>stylus<span class="token punctuation">&quot;</span></span> <span class="token attr-name">scoped</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
@import <span class="token string">'~@/common/stylus/variable.styl'</span>
@import <span class="token string">'~@/common/stylus/mixin.styl'</span>
.songlist
  .item
    <span class="token property">font-size</span><span class="token punctuation">:</span> $font-size-medium
    <span class="token property">box-sizing</span><span class="token punctuation">:</span> border-box
    <span class="token property">align-items</span><span class="token punctuation">:</span> center
    <span class="token property">display</span><span class="token punctuation">:</span> flex
    <span class="token property">height</span><span class="token punctuation">:</span> 64px
    .content
      <span class="token property">line-height</span><span class="token punctuation">:</span> 20px
      <span class="token property">overflow</span><span class="token punctuation">:</span> hidden
      .name
        <span class="token function">no-wrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token property">color</span><span class="token punctuation">:</span> $color-text
      .desc
        <span class="token function">no-wrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token property">margin-top</span><span class="token punctuation">:</span> 4px
        <span class="token property">color</span><span class="token punctuation">:</span> $color-text-d
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><ul><li>滚动 songlist 设置</li></ul> <ol><li>向 scroll 组件传值(listenScroll:true,probeType:3 监听 scroll 事件,data 数据)</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    proveType<span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">,</span>
    scrollY<span class="token operator">:</span><span class="token number">0</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token function">created</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>listenScroll<span class="token operator">=</span><span class="token boolean">true</span>
<span class="token punctuation">}</span>
</code></pre></div><ol start="2"><li>设置 songlist 滚动到一定位置不动 且文字盖过图片 上面留一个 bg-image 一小部分<div class="custom-block tip"><p class="custom-block-title">实现想法</p> <p>先发现图片会消失不见 dom 方法获取到 bg-image 的高度 然后给 songlist 设置高度
通过监听到<code>scroll</code>事件 获取到实时的位置 然后监听<code>scrollY</code>的值 固定最大偏移量 然后监听过程中拿到偏移量 设置<code>layer</code>的向上偏移 layer 的作用(这时需要一个位于歌单列表下方的图层（<code>bg-layer</code>），当歌单列表向上滑动的时候 filter 也跟着向上滑动，<strong>盖住下方的图像</strong>) 然后 如果到达到顶部(<code>val&lt;translateY</code>)时 设置图像区域的高度为 40px
其他情况就和之前相似 这个过程中 bg-image 的 index 都是 0 如果是顶部位置 就是 10</p></div>
这个讲起来有点复杂 接下来一步一步来</li></ol> <ul><li>监听 scroll</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">scroll</span><span class="token punctuation">(</span><span class="token parameter">pos</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>scrollY<span class="token operator">=</span>pos<span class="token punctuation">.</span>y
<span class="token punctuation">}</span>
</code></pre></div><ul><li>设置图片的高度撑开</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">mounted</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>imageHeight<span class="token operator">=</span><span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>image<span class="token punctuation">.</span>clientHeight
  <span class="token comment">//获取组件的dom 后面$el</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>list<span class="token punctuation">.</span>$el<span class="token punctuation">.</span>style<span class="token punctuation">.</span>top<span class="token operator">=</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>imageHeight<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">px</span><span class="token template-punctuation string">`</span></span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>layer 偏移一定量 固定不动</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">this</span><span class="token punctuation">.</span>minTranslateY<span class="token operator">=</span> <span class="token operator">-</span><span class="token keyword">this</span><span class="token punctuation">.</span>imageHeight <span class="token operator">+</span><span class="token constant">TITLE_HEIGHT</span>
<span class="token function">watch</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">scrollY</span><span class="token punctuation">(</span><span class="token parameter">val</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">let</span> zIndex<span class="token operator">=</span><span class="token number">0</span>
    <span class="token keyword">let</span> translateY<span class="token operator">=</span>Math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>minTranslateY<span class="token punctuation">,</span>val<span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>layer<span class="token punctuation">.</span>style<span class="token punctuation">[</span><span class="token string">'transform'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">translate3d(0,</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>translateY<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">px,0)</span><span class="token template-punctuation string">`</span></span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>$refss<span class="token punctuation">.</span>layer<span class="token punctuation">.</span>style<span class="token punctuation">[</span><span class="token string">'webkitTransform'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">translate3d(0,</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>translate3Y<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">px,0)</span><span class="token template-punctuation string">`</span></span>

    <span class="token keyword">if</span><span class="token punctuation">(</span>val <span class="token operator">&lt;</span> translateY<span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 顶部 <span class="token operator">--</span><span class="token operator">&gt;</span>
      z<span class="token operator">-</span>index <span class="token operator">=</span> <span class="token number">10</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>image<span class="token punctuation">.</span>style<span class="token punctuation">.</span>paddingTop <span class="token operator">=</span> <span class="token number">0</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>image<span class="token punctuation">.</span>style<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token string">'40px'</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>playwrapper<span class="token punctuation">.</span>style<span class="token punctuation">.</span>display<span class="token operator">=</span><span class="token string">'none'</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>image<span class="token punctuation">.</span>style<span class="token punctuation">.</span>paddingTop <span class="token operator">=</span> <span class="token string">'7-%'</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>image<span class="token punctuation">.</span>style<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token number">0</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>playwrapper<span class="token punctuation">.</span>style<span class="token punctuation">.</span>display<span class="token operator">=</span><span class="token string">''</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>image<span class="token punctuation">.</span>index <span class="token operator">=</span> zIndex

  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>实现向下拉图片 图片放大效果</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> scale<span class="token operator">=</span><span class="token number">1.0</span>
<span class="token keyword">const</span> present<span class="token operator">=</span>Math<span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span>val <span class="token operator">/</span> <span class="token keyword">this</span><span class="token punctuation">.</span>imageHeight<span class="token punctuation">)</span> <span class="token comment">//这样就可以是图片层的高度变为1+放大的高度</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>val <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  scale<span class="token operator">=</span><span class="token number">1</span> <span class="token operator">+</span> present
  z<span class="token operator">-</span>Index <span class="token operator">=</span> <span class="token number">10</span>
<span class="token punctuation">}</span>

····
<span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>image<span class="token punctuation">.</span>style<span class="token punctuation">[</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">transform</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">scale(</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>scale<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">)</span><span class="token template-punctuation string">`</span></span>
</code></pre></div><p>综上 歌手详情页就开发完成 使用到了 scroll 组件 根据高度盖住图层 知道了 index 的重要性 后面开发开发中最难的组件-播放起组件 加油！！</p> <h3 id="播放器组件"><a href="#播放器组件" class="header-anchor">#</a> 播放器组件</h3> <h4 id="定义播放器底层数据"><a href="#定义播放器底层数据" class="header-anchor">#</a> 定义播放器底层数据</h4> <p>开发前先思考 播放器可能需要这几个数据</p> <ul><li>playing 暂停或者播放</li> <li>fullScreen 控制播放器是否全屏显示</li> <li>playlist 播放列表</li> <li>sequenceList 顺序播放模式歌曲列表</li> <li>mode 播放模式</li> <li>currentIndex 当前播放歌曲的下标(可以通过此下标得到currentSong:state.playlist[state.currentIndex])</li></ul> <p>OK,我们开始书写vuex相关</p> <div class="custom-block tip"><p class="custom-block-title">定义公共配置</p> <p>config.js</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">const</span> playMode <span class="token operator">=</span><span class="token punctuation">{</span>
  sequence<span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span>
  loop<span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span>
  random<span class="token operator">:</span><span class="token number">2</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <h3>state.js</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>playMode<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'config.js'</span>
<span class="token keyword">const</span> state <span class="token operator">=</span><span class="token punctuation">{</span>
  singer<span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  playing<span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">,</span>
  fullScreen<span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">,</span>
  playlist<span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  sequencelist<span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  mode<span class="token operator">:</span>playMode<span class="token punctuation">.</span>sequence<span class="token punctuation">,</span>
  currentIndex<span class="token operator">:</span><span class="token operator">-</span><span class="token number">1</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> state
</code></pre></div><h3>mutations-type 定义函数名</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token constant">SET_PLAYING</span><span class="token operator">=</span><span class="token string">'SET_PLAYING'</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token constant">SET_FULLSCREEN</span><span class="token operator">=</span><span class="token string">'SET_FULLSCREEN'</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token constant">SET_PLAYLIST</span><span class="token operator">=</span><span class="token string">'SET_PLAYLIST'</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token constant">SET_SEQUENCE</span><span class="token operator">=</span><span class="token string">'SET_SEQUENCE'</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token constant">SET_MODE</span><span class="token operator">=</span><span class="token string">'SET_MODE'</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token constant">SET_CURRENTINDEX</span><span class="token operator">=</span><span class="token string">'SET_CURRENTINDEX'</span>
</code></pre></div><h3>mutation.js 修改数据</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> mutations <span class="token operator">=</span><span class="token punctuation">{</span>
  <span class="token punctuation">[</span>types<span class="token punctuation">.</span><span class="token constant">SET_PLAYING</span><span class="token punctuation">]</span><span class="token punctuation">(</span>state<span class="token punctuation">,</span>flag<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    state<span class="token punctuation">.</span>playing<span class="token operator">=</span>flag
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span>types<span class="token punctuation">.</span><span class="token constant">SET_FULLSCREEN</span><span class="token punctuation">]</span><span class="token punctuation">(</span>state<span class="token punctuation">,</span>flag<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    state<span class="token punctuation">.</span>fullScreen<span class="token operator">=</span>flag
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span>types<span class="token punctuation">.</span><span class="token constant">SET_PLAYLIST</span><span class="token punctuation">]</span><span class="token punctuation">(</span>state<span class="token punctuation">,</span>list<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    state<span class="token punctuation">.</span>playlist<span class="token operator">=</span>list
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span>types<span class="token punctuation">.</span><span class="token constant">SET_SEQUENCE</span><span class="token punctuation">]</span><span class="token punctuation">(</span>state<span class="token punctuation">,</span>list<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    state<span class="token punctuation">.</span>sequence<span class="token operator">=</span>list
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span>types<span class="token punctuation">.</span><span class="token constant">SET_MODE</span><span class="token punctuation">]</span><span class="token punctuation">(</span>state<span class="token punctuation">,</span>mode<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    state<span class="token punctuation">.</span>mode<span class="token operator">=</span>mode
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span>types<span class="token punctuation">.</span><span class="token constant">SETCURRENTINDEX</span><span class="token punctuation">]</span><span class="token punctuation">(</span>state<span class="token punctuation">,</span>index<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    state<span class="token punctuation">.</span>currentIndex<span class="token operator">=</span>index
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> mutations
</code></pre></div><h3>getters.js</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">+</span><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">playing</span> <span class="token operator">=</span> <span class="token parameter">state</span> <span class="token operator">=&gt;</span> state<span class="token punctuation">.</span>playing

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">fullScreen</span> <span class="token operator">=</span> <span class="token parameter">state</span> <span class="token operator">=&gt;</span> state<span class="token punctuation">.</span>fullScreen

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">playlist</span> <span class="token operator">=</span> <span class="token parameter">state</span> <span class="token operator">=&gt;</span> state<span class="token punctuation">.</span>playlist

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">sequencelist</span> <span class="token operator">=</span> <span class="token parameter">state</span> <span class="token operator">=&gt;</span> state<span class="token punctuation">.</span>sequencelist

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">mode</span> <span class="token operator">=</span> <span class="token parameter">state</span> <span class="token operator">=&gt;</span> state<span class="token punctuation">.</span>mode

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">currentIndex</span> <span class="token operator">=</span> <span class="token parameter">state</span> <span class="token operator">=&gt;</span> state<span class="token punctuation">.</span>currentIndex

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">currentSong</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">state</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> state<span class="token punctuation">.</span>playlist<span class="token punctuation">[</span>state<span class="token punctuation">.</span>currentIndex<span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="定义完数据之后先把play组件的基本代码书写"><a href="#定义完数据之后先把play组件的基本代码书写" class="header-anchor">#</a> 定义完数据之后先把play组件的基本代码书写</h4> <p><strong>基本dom结构</strong></p> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>player<span class="token punctuation">&quot;</span></span> <span class="token attr-name">v-show</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>playlist.length<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>transition</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>normal-player<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>normal-player<span class="token punctuation">&quot;</span></span> <span class="token attr-name">v-show</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>fullScreen<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- 背景图 --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>background<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>100%<span class="token punctuation">&quot;</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>100%<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>currentSong.image<span class="token punctuation">&quot;</span></span> <span class="token attr-name">alt</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- 顶部标题 --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>top<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>back<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>back<span class="token punctuation">&quot;</span></span> <span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>icon-back<span class="token punctuation">&quot;</span></span> <span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>i</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>title<span class="token punctuation">&quot;</span></span> <span class="token attr-name">v-html</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>currentSong.name<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>subtitle<span class="token punctuation">&quot;</span></span> <span class="token attr-name">v-html</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>currentSong.singer<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>tosinger<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- 中间部分cd唱片 歌曲歌词 --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>middle<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>middle-l<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>cd-wrapper<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>cd<span class="token punctuation">&quot;</span></span> <span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>image<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>currentSong.image<span class="token punctuation">&quot;</span></span> <span class="token attr-name">alt</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>play-lyric-wrapper<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>playing-lyric<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>middle-r<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>lyric-wrapper<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- 底部进度条 歌曲操作 --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>bottom<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- 滑块条 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>dot-wrapper<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- 进度条 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>progress-wrapper<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>progress-bar-wrapper<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- 操作区 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>operators<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>icon i-left<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>icon-sequence<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>i</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>icon i-left<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>icon-prev<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>i</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>icon i-center<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>icon-play<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>i</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>icon i-right<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>icon-next<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>i</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>icon i-right<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>icon icon-not-favorite<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>i</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>transition</span><span class="token punctuation">&gt;</span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>transition</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>min-player<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>mini-player<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>open<span class="token punctuation">&quot;</span></span> <span class="token attr-name">v-show</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>!fullScreen<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>image<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span>  <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>40<span class="token punctuation">&quot;</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>40<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>currentSong.image<span class="token punctuation">&quot;</span></span>  <span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>name<span class="token punctuation">&quot;</span></span> <span class="token attr-name">v-html</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>currentSong.name<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>singername<span class="token punctuation">&quot;</span></span> <span class="token attr-name">v-html</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>currentSong.singer<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>control<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>icon-mini icon-play-mini<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>i</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>control<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>icon-playlist<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>i</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>transition</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>audio</span> <span class="token attr-name">autoplay</span> <span class="token attr-name">muted</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>audio<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@canplay</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>getDuration<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>songsUrl<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>audio</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

</code></pre></div><blockquote><p>plaer分为全屏播放器和迷你播放器,全屏播放器里面有(模糊背景图 顶层(back图标 歌曲名 歌手名) 中间层(唱片图 歌词区 右划歌词区 进度条 dot区) 底层(操作区)) 迷你播放器(左(歌曲图) 中间(歌曲名 歌手名) 右边(歌曲暂停播放图标 进度 歌曲列表) )</p></blockquote> <div class="custom-block warning"><p class="custom-block-title">WARNING</p> <ul><li>迷你播放器flex布局最好,横轴改为纵轴 垂直方向居中 然后中间desc flex:1 其他都分配好宽度最好</li> <li>全屏播放器建议cd和操作区的样式难些 多练习</li></ul></div> <div class="language-stylus extra-class"><pre class="language-stylus"><code><span class="token selector">.player</span>
  <span class="token selector">.normal-player</span>
    <span class="token property-declaration"><span class="token property">position</span> fixed</span>
    <span class="token property-declaration"><span class="token property">left</span> <span class="token number">0</span></span>
    <span class="token property-declaration"><span class="token property">right</span> <span class="token number">0</span></span>
    <span class="token property-declaration"><span class="token property">bottom</span> <span class="token number">0</span></span>
    <span class="token property-declaration"><span class="token property">top</span> <span class="token number">0</span></span>
    <span class="token property-declaration"><span class="token property">z-index</span> <span class="token number">150</span></span>
    <span class="token property-declaration"><span class="token property">background</span> $color-background</span>
    <span class="token selector">.background</span>
      <span class="token comment">//高斯模糊背景图</span>
      <span class="token property-declaration"><span class="token property">position</span> absolute</span>
      <span class="token property-declaration"><span class="token property">left</span> <span class="token number">0</span></span>
      <span class="token property-declaration"><span class="token property">top</span> <span class="token number">0</span></span>
      <span class="token property-declaration"><span class="token property">width</span> <span class="token number">100%</span></span>
      <span class="token property-declaration"><span class="token property">height</span> <span class="token number">100%</span></span>
      <span class="token property-declaration"><span class="token property">z-index</span> <span class="token operator">-</span><span class="token number">1</span></span>
      <span class="token property-declaration"><span class="token property">opacity</span> <span class="token number">0.6</span></span>
      <span class="token property-declaration"><span class="token property">filter</span><span class="token punctuation">:</span><span class="token func"><span class="token function">blur</span><span class="token punctuation">(</span><span class="token number">20</span>px<span class="token punctuation">)</span></span></span>
    <span class="token selector">.top</span>
      <span class="token property-declaration"><span class="token property">position</span> relative</span>
      <span class="token property-declaration"><span class="token property">margin-bottom</span> <span class="token number">25</span>px</span>
      <span class="token selector">.back</span>
        <span class="token property-declaration"><span class="token property">position</span> absolute</span>
        <span class="token property-declaration"><span class="token property">left</span> <span class="token number">6</span>px</span>
        <span class="token property-declaration"><span class="token property">top</span> <span class="token number">0</span></span>
        <span class="token property-declaration"><span class="token property">z-index</span> <span class="token number">50</span></span>
        <span class="token selector">.icon-back</span>
          <span class="token property-declaration"><span class="token property">padding</span> <span class="token number">9</span>px</span>
          <span class="token property-declaration"><span class="token property">display</span> block</span>
          <span class="token property-declaration"><span class="token property">font-size</span> $font-size-large-x</span>
          <span class="token property-declaration"><span class="token property">color</span> $color-theme</span>
          <span class="token property-declaration"><span class="token property">transform</span> <span class="token func"><span class="token function">rotate</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">90</span>deg<span class="token punctuation">)</span></span></span>
      <span class="token selector">.title</span>
        <span class="token property-declaration"><span class="token property">width</span> <span class="token number">70%</span></span>
        <span class="token property-declaration"><span class="token property">margin</span> <span class="token number">0</span> auto</span>
        <span class="token property-declaration"><span class="token property">line-height</span> <span class="token number">40</span>px</span>
        <span class="token property-declaration"><span class="token property">text-align</span> center</span>
        <span class="token func"><span class="token function">no-wrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
        <span class="token property-declaration"><span class="token property">font-size</span> #font-size-large</span>
        <span class="token property-declaration"><span class="token property">color</span> $color-text</span>
      <span class="token selector">.subtitle</span>
        <span class="token property-declaration"><span class="token property">line-height</span> <span class="token number">20</span>px</span>
        <span class="token property-declaration"><span class="token property">text-align</span> center</span>
        <span class="token property-declaration"><span class="token property">font-size</span> $font-size-medium</span>
        <span class="token property-declaration"><span class="token property">color</span> $color-text</span>
    <span class="token selector">.middle</span>
      <span class="token property-declaration"><span class="token property">position</span> fixed</span>
      <span class="token property-declaration"><span class="token property">wdith</span> <span class="token number">100%</span></span>
      <span class="token property-declaration"><span class="token property">top</span> <span class="token number">80</span>px</span>
      <span class="token property-declaration"><span class="token property">bottom</span> <span class="token number">170</span>px</span>
      <span class="token property-declaration"><span class="token property">white-space</span> nowrap</span>
      <span class="token property-declaration"><span class="token property">font-size</span> <span class="token number">0</span></span>
      <span class="token selector">.middle-l</span>
        <span class="token property-declaration"><span class="token property">display</span> inline-block</span>
        <span class="token property-declaration"><span class="token property">vertical-align</span> top</span>
        <span class="token property-declaration"><span class="token property">position</span> relative</span>
        <span class="token property-declaration"><span class="token property">width</span> <span class="token number">100%</span></span>
        <span class="token property-declaration"><span class="token property">height</span> <span class="token number">0</span></span>
        <span class="token property-declaration"><span class="token property">padding</span> <span class="token number">80%</span></span>
        <span class="token selector">.cd-wrapepr</span>
          <span class="token property-declaration"><span class="token property">position</span> absolute</span>
          <span class="token property-declaration"><span class="token property">left</span> <span class="token number">10%</span></span>
          <span class="token property-declaration"><span class="token property">top</span> <span class="token number">0</span></span>
          <span class="token property-declaration"><span class="token property">width</span> <span class="token number">100%</span></span>
          <span class="token property-declaration"><span class="token property">height</span> <span class="token number">100%</span></span>
          <span class="token selector">.cd</span>
            <span class="token property-declaration"><span class="token property">width</span> <span class="token number">100%</span></span>
            <span class="token property-declaration"><span class="token property">height</span> <span class="token number">100%</span></span>
            <span class="token property-declaration"><span class="token property">box-sizing</span> border-box</span>
            <span class="token property-declaration"><span class="token property">border</span> <span class="token number">10</span>px solid <span class="token func"><span class="token function">rgba</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">,</span><span class="token number">255</span><span class="token punctuation">,</span><span class="token number">255</span><span class="token punctuation">,</span><span class="token number">0.1</span><span class="token punctuation">)</span></span></span>
            <span class="token property-declaration"><span class="token property">border-radius</span> <span class="token number">50%</span></span>
            <span class="token selector">.image</span>
              <span class="token property-declaration"><span class="token property">position</span> absolute</span>
              <span class="token property-declaration"><span class="token property">left</span> <span class="token number">0</span></span>
              <span class="token property-declaration"><span class="token property">top</span> <span class="token number">0</span></span>
              <span class="token property-declaration"><span class="token property">width</span> <span class="token number">100%</span></span>
              <span class="token property-declaration"><span class="token property">height</span> <span class="token number">100%</span></span>
              <span class="token selector">border-radius 50%</span>
               <span class="token punctuation">.</span>playing-lyric-wrapper
            <span class="token property-declaration"><span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">80%</span></span>
            <span class="token property-declaration"><span class="token property">margin</span><span class="token punctuation">:</span> <span class="token number">30</span>px auto <span class="token number">0</span> auto</span>
            <span class="token property-declaration"><span class="token property">overflow</span><span class="token punctuation">:</span> hidden</span>
            <span class="token property-declaration"><span class="token property">text-align</span><span class="token punctuation">:</span> center</span>
            <span class="token selector">.playing-lyric</span>
              <span class="token property-declaration"><span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">20</span>px</span>
              <span class="token property-declaration"><span class="token property">line-height</span><span class="token punctuation">:</span> <span class="token number">20</span>px</span>
              <span class="token property-declaration"><span class="token property">font-size</span><span class="token punctuation">:</span> $font-size-medium</span>
              <span class="token property-declaration"><span class="token property">color</span><span class="token punctuation">:</span> $color-text-l</span>
        <span class="token selector">.middle-r</span>
          <span class="token property-declaration"><span class="token property">display</span><span class="token punctuation">:</span> inline-block</span>
          <span class="token property-declaration"><span class="token property">vertical-align</span><span class="token punctuation">:</span> top</span>
          <span class="token property-declaration"><span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">100%</span></span>
          <span class="token property-declaration"><span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">100%</span></span>
          <span class="token property-declaration"><span class="token property">overflow</span><span class="token punctuation">:</span> hidden</span>
          <span class="token selector">.lyric-wrapper</span>
            <span class="token property-declaration"><span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">80%</span></span>
            <span class="token property-declaration"><span class="token property">margin</span><span class="token punctuation">:</span> <span class="token number">0</span> auto</span>
            <span class="token property-declaration"><span class="token property">overflow</span><span class="token punctuation">:</span> hidden</span>
            <span class="token property-declaration"><span class="token property">text-align</span><span class="token punctuation">:</span> center</span>
            <span class="token selector">.text</span>
              <span class="token property-declaration"><span class="token property">line-height</span><span class="token punctuation">:</span> <span class="token number">32</span>px</span>
              <span class="token property-declaration"><span class="token property">color</span><span class="token punctuation">:</span> $color-text-l</span>
              <span class="token property-declaration"><span class="token property">font-size</span><span class="token punctuation">:</span> $font-size-medium</span>
              <span class="token selector">&amp;.current</span>
                <span class="token property-declaration"><span class="token property">color</span><span class="token punctuation">:</span> $color-text</span>
      <span class="token selector">.bottom</span>
        <span class="token property-declaration"><span class="token property">position</span><span class="token punctuation">:</span> absolute</span>
        <span class="token property-declaration"><span class="token property">bottom</span><span class="token punctuation">:</span> <span class="token number">50</span>px</span>
        <span class="token property-declaration"><span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">100%</span></span>
        <span class="token selector">.dot-wrapper</span>
          <span class="token property-declaration"><span class="token property">text-align</span><span class="token punctuation">:</span> center</span>
          <span class="token property-declaration"><span class="token property">font-size</span><span class="token punctuation">:</span> <span class="token number">0</span></span>
          <span class="token selector">.dot</span>
            <span class="token property-declaration"><span class="token property">display</span><span class="token punctuation">:</span> inline-block</span>
            <span class="token property-declaration"><span class="token property">vertical-align</span><span class="token punctuation">:</span> middle</span>
            <span class="token property-declaration"><span class="token property">margin</span><span class="token punctuation">:</span> <span class="token number">0</span> <span class="token number">4</span>px</span>
            <span class="token property-declaration"><span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">8</span>px</span>
            <span class="token property-declaration"><span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">8</span>px</span>
            <span class="token property-declaration"><span class="token property">border-radius</span><span class="token punctuation">:</span> <span class="token number">50%</span></span>
            <span class="token property-declaration"><span class="token property">background</span><span class="token punctuation">:</span> $color-text-l</span>
            <span class="token selector">&amp;.active</span>
              <span class="token property-declaration"><span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">20</span>px</span>
              <span class="token property-declaration"><span class="token property">border-radius</span><span class="token punctuation">:</span> <span class="token number">5</span>px</span>
              <span class="token property-declaration"><span class="token property">background</span><span class="token punctuation">:</span> $color-text-ll</span>
        <span class="token selector">.progress-wrapper</span>
          <span class="token property-declaration"><span class="token property">display</span><span class="token punctuation">:</span> flex</span>
          <span class="token property-declaration"><span class="token property">align-items</span><span class="token punctuation">:</span> center</span>
          <span class="token property-declaration"><span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">80%</span></span>
          <span class="token property-declaration"><span class="token property">margin</span><span class="token punctuation">:</span> <span class="token number">0</span>px auto</span>
          <span class="token property-declaration"><span class="token property">padding</span><span class="token punctuation">:</span> <span class="token number">10</span>px <span class="token number">0</span></span>
          <span class="token selector">.time</span>
            <span class="token property-declaration"><span class="token property">color</span><span class="token punctuation">:</span> $color-text</span>
            <span class="token property-declaration"><span class="token property">font-size</span><span class="token punctuation">:</span> $font-size-small</span>
            <span class="token property-declaration"><span class="token property">flex</span><span class="token punctuation">:</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">30</span>px</span>
            <span class="token property-declaration"><span class="token property">line-height</span><span class="token punctuation">:</span> <span class="token number">30</span>px</span>
            <span class="token property-declaration"><span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">30</span>px</span>
            <span class="token selector">&amp;.time-l</span>
              <span class="token property-declaration"><span class="token property">text-align</span><span class="token punctuation">:</span> left</span>
            <span class="token selector">&amp;.time-r</span>
              <span class="token property-declaration"><span class="token property">text-align</span><span class="token punctuation">:</span> right</span>
          <span class="token selector">.progress-bar-wrapper</span>
            <span class="token property-declaration"><span class="token property">flex</span><span class="token punctuation">:</span> <span class="token number">1</span></span>
        <span class="token selector">.operators</span>
          <span class="token property-declaration"><span class="token property">display</span><span class="token punctuation">:</span> flex</span>
          <span class="token property-declaration"><span class="token property">align-items</span><span class="token punctuation">:</span> center</span>
          <span class="token selector">.icon</span>
            <span class="token property-declaration"><span class="token property">flex</span><span class="token punctuation">:</span> <span class="token number">1</span></span>
            <span class="token property-declaration"><span class="token property">color</span><span class="token punctuation">:</span> $color-theme</span>
            <span class="token selector">&amp;.disable</span>
              <span class="token property-declaration"><span class="token property">color</span><span class="token punctuation">:</span> $color-theme-d</span>
            <span class="token selector">i</span>
              <span class="token property-declaration"><span class="token property">font-size</span><span class="token punctuation">:</span> <span class="token number">30</span>px</span>
          <span class="token selector">.i-left</span>
            <span class="token property-declaration"><span class="token property">text-align</span><span class="token punctuation">:</span> right</span>
          <span class="token selector">.i-center</span>
            <span class="token property-declaration"><span class="token property">padding</span><span class="token punctuation">:</span> <span class="token number">0</span> <span class="token number">20</span>px</span>
            <span class="token property-declaration"><span class="token property">text-align</span><span class="token punctuation">:</span> center</span>
            <span class="token selector">i</span>
              <span class="token property-declaration"><span class="token property">font-size</span><span class="token punctuation">:</span> <span class="token number">40</span>px</span>
          <span class="token selector">.i-right</span>
            <span class="token property-declaration"><span class="token property">text-align</span><span class="token punctuation">:</span> left</span>
          <span class="token selector">.icon-favorite</span>
            <span class="token property-declaration"><span class="token property">color</span><span class="token punctuation">:</span> $color-sub-theme</span>
      <span class="token selector">&amp;.normal-enter-active<span class="token punctuation">,</span> &amp;.normal-leave-active</span>
        <span class="token property-declaration"><span class="token property">transition</span><span class="token punctuation">:</span> all <span class="token number">0.4</span>s</span>
        <span class="token selector">.top<span class="token punctuation">,</span> .bottom</span>
          <span class="token property-declaration"><span class="token property">transition</span><span class="token punctuation">:</span> all <span class="token number">0.4</span>s <span class="token func"><span class="token function">cubic-bezier</span><span class="token punctuation">(</span><span class="token number">0.86</span><span class="token punctuation">,</span> <span class="token number">0.18</span><span class="token punctuation">,</span> <span class="token number">0.82</span><span class="token punctuation">,</span> <span class="token number">1.32</span><span class="token punctuation">)</span></span></span>
      <span class="token selector">&amp;.normal-enter<span class="token punctuation">,</span> &amp;.normal-leave-to</span>
        <span class="token property-declaration"><span class="token property">opacity</span><span class="token punctuation">:</span> <span class="token number">0</span></span>
        <span class="token selector">.top</span>
          <span class="token property-declaration"><span class="token property">transform</span><span class="token punctuation">:</span> <span class="token func"><span class="token function">translate3d</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">100</span>px<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span></span></span>
        <span class="token selector">.bottom</span>
          <span class="token property-declaration"><span class="token property">transform</span><span class="token punctuation">:</span> <span class="token func"><span class="token function">translate3d</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">100</span>px<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span></span></span>
    <span class="token selector">.mini-player</span>
      <span class="token property-declaration"><span class="token property">display</span><span class="token punctuation">:</span> flex</span>
      <span class="token property-declaration"><span class="token property">align-items</span><span class="token punctuation">:</span> center</span>
      <span class="token property-declaration"><span class="token property">position</span><span class="token punctuation">:</span> fixed</span>
      <span class="token property-declaration"><span class="token property">left</span><span class="token punctuation">:</span> <span class="token number">0</span></span>
      <span class="token property-declaration"><span class="token property">bottom</span><span class="token punctuation">:</span> <span class="token number">0</span></span>
      <span class="token property-declaration"><span class="token property">z-index</span><span class="token punctuation">:</span> <span class="token number">180</span></span>
      <span class="token property-declaration"><span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">100%</span></span>
      <span class="token property-declaration"><span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">60</span>px</span>
      <span class="token property-declaration"><span class="token property">background</span><span class="token punctuation">:</span> $color-highlight-background</span>
      <span class="token selector">&amp;.mini-enter-active<span class="token punctuation">,</span> &amp;.mini-leave-active</span>
        <span class="token property-declaration"><span class="token property">transition</span><span class="token punctuation">:</span> all <span class="token number">0.4</span>s</span>
      <span class="token selector">&amp;.mini-enter<span class="token punctuation">,</span> &amp;.mini-leave-to</span>
        <span class="token property-declaration"><span class="token property">opacity</span><span class="token punctuation">:</span> <span class="token number">0</span></span>
      <span class="token selector">.icon</span>
        <span class="token property-declaration"><span class="token property">flex</span><span class="token punctuation">:</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">40</span>px</span>
        <span class="token property-declaration"><span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">40</span>px</span>
        <span class="token property-declaration"><span class="token property">padding</span><span class="token punctuation">:</span> <span class="token number">0</span> <span class="token number">10</span>px <span class="token number">0</span> <span class="token number">20</span>px</span>
        <span class="token selector">img</span>
          <span class="token property-declaration"><span class="token property">border-radius</span><span class="token punctuation">:</span> <span class="token number">50%</span></span>
          <span class="token selector">&amp;.play</span>
            <span class="token property-declaration"><span class="token property">animation</span><span class="token punctuation">:</span> rotate <span class="token number">10</span>s linear infinite</span>
          <span class="token selector">&amp;.pause</span>
            <span class="token property-declaration"><span class="token property">animation-play-state</span><span class="token punctuation">:</span> paused</span>
      <span class="token selector">.text</span>
        <span class="token property-declaration"><span class="token property">display</span><span class="token punctuation">:</span> flex</span>
        <span class="token property-declaration"><span class="token property">flex-direction</span><span class="token punctuation">:</span> column</span>
        <span class="token property-declaration"><span class="token property">justify-content</span><span class="token punctuation">:</span> center</span>
        <span class="token property-declaration"><span class="token property">flex</span><span class="token punctuation">:</span> <span class="token number">1</span></span>
        <span class="token property-declaration"><span class="token property">line-height</span><span class="token punctuation">:</span> <span class="token number">20</span>px</span>
        <span class="token property-declaration"><span class="token property">overflow</span><span class="token punctuation">:</span> hidden</span>
        <span class="token selector">.name</span>
          <span class="token property-declaration"><span class="token property">margin-bottom</span><span class="token punctuation">:</span> <span class="token number">2</span>px</span>
          <span class="token func"><span class="token function">no-wrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
          <span class="token property-declaration"><span class="token property">font-size</span><span class="token punctuation">:</span> $font-size-medium</span>
          <span class="token property-declaration"><span class="token property">color</span><span class="token punctuation">:</span> $color-text</span>
        <span class="token selector">.desc</span>
          <span class="token func"><span class="token function">no-wrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
          <span class="token property-declaration"><span class="token property">font-size</span><span class="token punctuation">:</span> $font-size-small</span>
          <span class="token property-declaration"><span class="token property">color</span><span class="token punctuation">:</span> $color-text-d</span>
      <span class="token selector">.control</span>
        <span class="token property-declaration"><span class="token property">flex</span><span class="token punctuation">:</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">30</span>px</span>
        <span class="token property-declaration"><span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">30</span>px</span>
        <span class="token property-declaration"><span class="token property">padding</span><span class="token punctuation">:</span> <span class="token number">0</span> <span class="token number">10</span>px</span>
        <span class="token selector">.icon-play-mini<span class="token punctuation">,</span> .icon-pause-mini<span class="token punctuation">,</span> .icon-playlist</span>
          <span class="token property-declaration"><span class="token property">font-size</span><span class="token punctuation">:</span> <span class="token number">30</span>px</span>
          <span class="token property-declaration"><span class="token property">color</span><span class="token punctuation">:</span> $color-theme-d</span>
        <span class="token selector">.icon-mini</span>
          <span class="token property-declaration"><span class="token property">font-size</span><span class="token punctuation">:</span> <span class="token number">32</span>px</span>
          <span class="token property-declaration"><span class="token property">position</span><span class="token punctuation">:</span> absolute</span>
          <span class="token property-declaration"><span class="token property">left</span><span class="token punctuation">:</span> <span class="token number">0</span></span>
          <span class="token property-declaration"><span class="token property">top</span><span class="token punctuation">:</span> <span class="token number">0</span></span>
</code></pre></div><p>在写两个交互动画
打开normal播放器或者mini播放器</p> <div class="language-stylus extra-class"><pre class="language-stylus"><code><span class="token selector">.normal-player-enter-active<span class="token punctuation">,</span>.normal-player-leave-active</span>
  <span class="token property-declaration"><span class="token property">translate</span> all <span class="token number">0.4</span>s</span>
  <span class="token punctuation">.</span>top,<span class="token punctuation">.</span>bottom
  <span class="token comment">//贝赛尔曲线定义环动 </span>
    <span class="token property-declaration"><span class="token property">transition</span> all <span class="token number">0.4</span>s <span class="token func"><span class="token function">cubic-bezier</span><span class="token punctuation">(</span><span class="token number">0.86</span><span class="token punctuation">,</span><span class="token number">0.18</span><span class="token punctuation">,</span><span class="token number">0.82</span><span class="token punctuation">,</span><span class="token number">1.32</span><span class="token punctuation">)</span></span></span>
<span class="token selector">.normal-player-enter<span class="token punctuation">,</span>.normal-player-leave-active</span>
  <span class="token property-declaration"><span class="token property">opcity</span> <span class="token number">0</span></span>
  <span class="token comment">//定义top初始向上100px bottom初始向下100px 动画自下而上 自上而下 渐隐渐现</span>
  <span class="token selector">.top</span>
    <span class="token property-declaration"><span class="token property">transform</span> <span class="token func"><span class="token function">translate3d</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">100</span>px<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span></span></span>
  <span class="token selector">.bottom </span>
    <span class="token property-declaration"><span class="token property">transform</span> <span class="token func"><span class="token function">translate3d</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">100</span>px<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span></span></span>

<span class="token selector">&amp;.min-player-enter-active<span class="token punctuation">,</span>&amp;.min-player-leave-active</span>
  <span class="token property-declaration"><span class="token property">transition</span> all <span class="token number">0.4</span>s</span>
<span class="token selector">&amp;.min-player-enter<span class="token punctuation">,</span>&amp;.min-player-leave-active</span>
  <span class="token property-declaration"><span class="token property">opcity</span> <span class="token number">0</span></span>
</code></pre></div><h4 id="逻辑部分书写"><a href="#逻辑部分书写" class="header-anchor">#</a> 逻辑部分书写</h4> <p>书写完player组件,由于他跟路由没啥关系,而且很多组件会用到,所以定义在app.vue中，莫忘记注册</p> <p>我们需要控制player的显示与隐藏,不然会盖住singer-detail</p> <div class="language-js extra-class"><pre class="language-js"><code>computed<span class="token operator">:</span><span class="token punctuation">{</span>
  <span class="token operator">...</span><span class="token function">mapGetters</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
    <span class="token string">'fullScreen'</span><span class="token punctuation">,</span>
    <span class="token string">'playlist'</span><span class="token punctuation">,</span>
    <span class="token string">'currentSong'</span>
  <span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
 <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;player&quot;</span> v<span class="token operator">-</span>show<span class="token operator">=</span><span class="token string">&quot;playlist.length &gt; 0&quot;</span><span class="token operator">&gt;</span>
 <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;normal-player&quot;</span> v<span class="token operator">-</span>show<span class="token operator">=</span><span class="token string">&quot;fullScreen&quot;</span><span class="token operator">&gt;</span>
 <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;mini-player&quot;</span> v<span class="token operator">-</span>show<span class="token operator">=</span><span class="token string">&quot;!fullScreen&quot;</span><span class="token operator">&gt;</span>     
</code></pre></div><p>这样就不会默认显示了,接下来我们去写songlist的事件</p> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>selectItem(song, index)<span class="token punctuation">&quot;</span></span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>(song, index) in songs<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>index<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>item<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>content<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>name<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{song.name}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>desc<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{getDesc(song)}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>
  
  .....
  methods:{
    selectItem(item,index) {
      this.$emit('select',item,index)
    }
  }
</code></pre></div><p>父组件music-list接受事件 因为这里我们需要将点击的歌曲信息传入vuex并修改 发现需要修改多个mutation，所以定义action.js</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> types <span class="token keyword">from</span> <span class="token string">'./mutations-type'</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">selectPlay</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span>commit<span class="token punctuation">,</span> state<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>list<span class="token punctuation">,</span> index<span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">commit</span><span class="token punctuation">(</span>types<span class="token punctuation">.</span><span class="token constant">SET_SEQUENCE</span><span class="token punctuation">,</span> list<span class="token punctuation">)</span>
  <span class="token function">commit</span><span class="token punctuation">(</span>types<span class="token punctuation">.</span><span class="token constant">SET_PLAYLIST</span><span class="token punctuation">,</span> list<span class="token punctuation">)</span>
  <span class="token function">commit</span><span class="token punctuation">(</span>types<span class="token punctuation">.</span><span class="token constant">SET_CURRENTINDEX</span><span class="token punctuation">,</span> index<span class="token punctuation">)</span>
  <span class="token function">commit</span><span class="token punctuation">(</span>types<span class="token punctuation">.</span><span class="token constant">SET_FULLSCREEN</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
  <span class="token function">commit</span><span class="token punctuation">(</span>types<span class="token punctuation">.</span><span class="token constant">SET_PLAYING</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>定义好了批量操作 传入数据修改mutation</p> <div class="language-js extra-class"><pre class="language-js"><code>@select<span class="token operator">=</span><span class="token string">&quot;selectItem&quot;</span>
<span class="token operator">...</span>
methods<span class="token operator">:</span><span class="token punctuation">{</span>
  <span class="token operator">...</span><span class="token function">mapActions</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
    <span class="token string">'selectplay'</span>
  <span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token function">selectItem</span><span class="token punctuation">(</span><span class="token parameter">item<span class="token punctuation">,</span>index</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">selectPlay</span><span class="token punctuation">(</span>
    <span class="token punctuation">{</span>
      list<span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>songs<span class="token punctuation">,</span>
      index
    <span class="token punctuation">}</span>
  <span class="token punctuation">)</span>

  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>接下来取出currentSong 挂到dom上,这里不详细介绍。
我们在点击歌曲后需要将fullScreen置为true,但是不能直接去修改getters的数据,需要进行mutations修改</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">...</span><span class="token function">mapMutations</span><span class="token punctuation">(</span>
<span class="token punctuation">{</span>
  setfullScreen<span class="token operator">:</span><span class="token string">'SET_FULLSCREEN'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

methods<span class="token operator">:</span><span class="token punctuation">{</span>
  <span class="token function">back</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setfullScreen</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  
  <span class="token function">play</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setfullScreen</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>这样就可以图标控制隐藏显示 或者迷你播放器打开 添加点击事件即可 下一节将介绍播放器核心部分</p> <h4 id="播放器飞入左下角动画"><a href="#播放器飞入左下角动画" class="header-anchor">#</a> 播放器飞入左下角动画</h4> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>vue的js钩子可以帮助我们实现这个动画</p> <ul><li>@enter=&quot;&quot;</li> <li>@after-enter=&quot;&quot;</li> <li>@leave=&quot;&quot;</li> <li>@after-leave=&quot;&quot;</li></ul></div> <p>首先引入第三方创建动画库<code>create-keyframe-animation</code>
具体思路:</p> <ol><li>计算两个圆心的坐标,根据坐标计算出水平竖直偏移量</li> <li>定义并使用动画</li> <li>清除动画</li></ol> <h3>定义函数计算出图片之间偏移量和缩放</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">_getPosAndScale</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// * 要做一个大图片从mini播放器飞到大图层cdWrapper的动画 使用到create-keyframe-animation第三方插键</span>
  <span class="token comment">// ! 思路：1.计算出偏移横纵坐标 2.横轴偏移(屏幕宽度/2-min播放器左侧偏移) 3.纵轴偏移(屏幕高度-大图层paddingTop-min播放器圆心距底部位置-cdwrapper的高度/2) 4.书写动画</span>
  <span class="token keyword">const</span> targetWidth <span class="token operator">=</span> <span class="token number">40</span><span class="token comment">//图片宽度</span>
  <span class="token keyword">const</span> paddingLeft <span class="token operator">=</span> <span class="token number">40</span><span class="token comment">//mini圆心左翩移</span>
  <span class="token keyword">const</span> paddingBottom <span class="token operator">=</span> <span class="token number">30</span><span class="token comment">//底部距圆心距离</span>
  <span class="token keyword">const</span> paddingTop <span class="token operator">=</span> <span class="token number">80</span> <span class="token comment">//顶部距圆心距离</span>
  <span class="token keyword">const</span> width <span class="token operator">=</span> window<span class="token punctuation">.</span>innerWidth <span class="token operator">*</span> <span class="token number">0.8</span> <span class="token comment">//整个cd-wrapper的宽度</span>
  <span class="token keyword">const</span> scale <span class="token operator">=</span> targetWidth <span class="token operator">/</span> width<span class="token comment">//原始缩放比例</span>
   <span class="token keyword">const</span> x <span class="token operator">=</span> <span class="token operator">-</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>innerWidth <span class="token operator">/</span> <span class="token number">2</span> <span class="token operator">-</span> paddingLeft<span class="token punctuation">)</span>
      <span class="token keyword">const</span> y <span class="token operator">=</span> window<span class="token punctuation">.</span>innerHeight <span class="token operator">-</span> paddingTop <span class="token operator">-</span> width <span class="token operator">/</span> <span class="token number">2</span> <span class="token operator">-</span> paddingBottom
      <span class="token keyword">return</span> <span class="token punctuation">{</span>
        x<span class="token punctuation">,</span>
        y<span class="token punctuation">,</span>
        scale
      <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre></div><h3>定义动画</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//import之后</span>
<span class="token comment">//进入时</span>
<span class="token function">enter</span><span class="token punctuation">(</span><span class="token parameter">el<span class="token punctuation">,</span>done</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>scale<span class="token punctuation">}</span> <span class="token operator">=</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_getPosAndScale</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token comment">// 定义动画</span>
  <span class="token keyword">let</span> animation <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token comment">// 底部飞到大图片 然后从60到100 scale先1.1然后回调</span>
    <span class="token number">0</span>：<span class="token punctuation">{</span>
      transform<span class="token operator">:</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">translate3d(</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>x<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">px,</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>y<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">px,scale(</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>scale<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">))</span><span class="token template-punctuation string">`</span></span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token number">60</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      transform<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">translate3d(0,0,0) scale(1.1)</span><span class="token template-punctuation string">`</span></span>

    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token number">100</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      transform <span class="token operator">:</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">translate3d(0,0,0) scale(1)</span><span class="token template-punctuation string">`</span></span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// 注册animation</span>
animations<span class="token punctuation">.</span><span class="token function">registerAnimation</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  name<span class="token operator">:</span><span class="token string">'move'</span><span class="token punctuation">,</span>
  animation<span class="token punctuation">,</span> <span class="token comment">//定义好的动画</span>
  presets<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token comment">// 预设参数</span>
  duration<span class="token operator">:</span><span class="token number">400</span><span class="token punctuation">,</span>
  easing<span class="token operator">:</span><span class="token string">'linear'</span>
  <span class="token punctuation">}</span> 
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token comment">// 运行animation</span>
animations<span class="token punctuation">.</span><span class="token function">runAnimation</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>cdWrapper<span class="token punctuation">,</span><span class="token string">'move'</span><span class="token punctuation">,</span>done<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 进入后清除</span>
<span class="token function">afterEnter</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 清除animation</span>
  animations<span class="token punctuation">.</span><span class="token function">unregisterAnimation</span><span class="token punctuation">(</span><span class="token string">'move'</span><span class="token punctuation">)</span> 
  <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>cdWrapper<span class="token punctuation">.</span>style<span class="token punctuation">.</span>animation <span class="token operator">=</span> <span class="token string">''</span>
<span class="token punctuation">}</span>
</code></pre></div><p>关闭窗口时 原理也是相似的</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">leave</span> <span class="token punctuation">(</span><span class="token parameter">el<span class="token punctuation">,</span>done</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> scale<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_getPosAndScale</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>cdWrapper<span class="token punctuation">.</span>style<span class="token punctuation">[</span><span class="token string">'transform'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">translate3d(</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>x<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">px,</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>y<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">px,0) scale(</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>scale<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">)</span><span class="token template-punctuation string">`</span></span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>cdWrapper<span class="token punctuation">.</span>style<span class="token punctuation">.</span>transition <span class="token operator">=</span> <span class="token string">'all 0.4s'</span>
  <span class="token comment">// 监听transitionend事件 之后执行afterLeave</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>cdWrapper<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'transitionend'</span><span class="token punctuation">,</span> done<span class="token punctuation">)</span>

  <span class="token comment">//清除transition transform</span>
   <span class="token function">afterLeave</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>cdWrapper<span class="token punctuation">.</span>style<span class="token punctuation">[</span><span class="token string">'transform'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">''</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>cdWrapper<span class="token punctuation">.</span>style<span class="token punctuation">.</span>transition <span class="token operator">=</span> <span class="token string">''</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><p>这样cd的打开关闭都会有一个效果不错的动画效果</p> <h3 id="💙播放器部分"><a href="#💙播放器部分" class="header-anchor">#</a> 💙播放器部分</h3> <p>歌曲的播放功能,主要是利用 html5 的 audio 标签实现</p> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>audio</span>
  <span class="token attr-name">autoplay</span>
  <span class="token attr-name">muted</span>
  <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>audio<span class="token punctuation">&quot;</span></span>
  <span class="token attr-name">@canplay</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>getDuration<span class="token punctuation">&quot;</span></span>
  <span class="token attr-name">@error</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>error<span class="token punctuation">&quot;</span></span>
  <span class="token attr-name">:src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>songsUrl<span class="token punctuation">&quot;</span></span>
  <span class="token attr-name">@timeupdate</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>UpdateTime<span class="token punctuation">&quot;</span></span>
<span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>audio</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h4 id="💜获取歌曲-url"><a href="#💜获取歌曲-url" class="header-anchor">#</a> 💜获取歌曲 url</h4> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>由于这个 webapp 使用到的 api 是网易云的 api，所以这里我们需要调用获取歌曲的 url</p></div> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">getMusic</span><span class="token punctuation">(</span><span class="token parameter">musicId</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> url <span class="token operator">=</span> <span class="token constant">HOST</span> <span class="token operator">+</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/music/url?id=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>musicId<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
  <span class="token keyword">return</span> axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>play 组件里面调用 api</strong></p> <div class="language-js extra-class"><pre class="language-js"><code> <span class="token function">currentSong</span> <span class="token punctuation">(</span><span class="token parameter">newSong<span class="token punctuation">,</span> oldSong</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">//  如果两首歌曲的id都一样 就不刷新currentSong</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>newSong<span class="token punctuation">.</span>id <span class="token operator">===</span> oldSong<span class="token punctuation">.</span>id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span>
      <span class="token punctuation">}</span>
      <span class="token function">getMusic</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>currentSong<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>songsUrl <span class="token operator">=</span> res<span class="token punctuation">.</span>data<span class="token punctuation">.</span>data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>url
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token comment">// 如果有歌词在播放 这个Lyric对象停止播放</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>currentLyric<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>currentLyric<span class="token punctuation">.</span><span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_getLyric</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>currentSong<span class="token punctuation">.</span>id<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><h4 id="💚播放器逻辑部分"><a href="#💚播放器逻辑部分" class="header-anchor">#</a> 💚播放器逻辑部分</h4> <p><strong>之后当歌曲 ready 的时候，才能点下一首歌，设置一个标志位控制加载成功</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">data</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    songReady<span class="token operator">:</span> <span class="token boolean">false</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>添加一个@canPlay 函数 当其 songReady 为 true 才能</strong></p> <div class="language-js extra-class"><pre class="language-js"><code>   <span class="token function">getDuration</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 获取到歌曲</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>duration <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>audio<span class="token punctuation">.</span>duration
      <span class="token keyword">this</span><span class="token punctuation">.</span>songsTime <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>audio<span class="token punctuation">.</span>duration
      <span class="token comment">// 可以播放 songReady置为true</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>songReady <span class="token operator">=</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span>
</code></pre></div><p><strong>写好了 songReady 之后,回到 next 和 prev 函数控制歌曲的上一首下一首 点击播放歌曲 togglePlaying()</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">next</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>songReady<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">let</span> index <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>currentIndex <span class="token operator">+</span> <span class="token number">1</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>index <span class="token operator">===</span> <span class="token keyword">this</span><span class="token punctuation">.</span>playlist<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 当切到最后一首歌</span>
    index <span class="token operator">=</span> <span class="token number">0</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setCurrentIndex</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span>
  <span class="token comment">// 切换到写一首歌时保证播放状态</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>playing<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">togglePlaying</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>songReady <span class="token operator">=</span> <span class="token boolean">false</span> <span class="token comment">//重置</span>
  <span class="token punctuation">}</span>
<span class="token operator">...</span><span class="token punctuation">.</span>
<span class="token function">prev</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>songReady<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">let</span> index <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>currentIndex <span class="token operator">-</span> <span class="token number">1</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>index <span class="token operator">===</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 第一首歌 index切换到最后一首歌的index</span>
    index <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>playlist<span class="token punctuation">.</span>length
  <span class="token punctuation">}</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">currentIndex</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>playing<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">togglePlaying</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>songReady <span class="token operator">=</span> <span class="token boolean">false</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token operator">...</span><span class="token punctuation">.</span>
<span class="token function">toggleplaying</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>songReady<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setPlaying</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>playing<span class="token punctuation">)</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>currentLyric<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>currentLyric<span class="token punctuation">.</span><span class="token function">togglePlay</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><p><strong>当按钮不能点击时 就是歌曲没有 songReady 的时候给按钮一个 disable 属性</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">disableCls</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>songReady <span class="token operator">?</span> <span class="token string">''</span><span class="token operator">:</span><span class="token string">'disable'</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>播放器进度条 dom</strong></p> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token comment">&lt;!-- 进度条 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>progress-wrapper<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>time time-l<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{format(currentTime)}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>progress-bar-wrapper<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>progressbar</span> <span class="token attr-name">:currentTime</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>currentTime<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:songsTime</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>songsTime<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:precent</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>precent<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@percentChangeEnd</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>onProgressBarChange<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>progressbar</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>time time-r<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{format(songsTime)}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p><strong>歌曲在播放时会派发 timeupdate 事件</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">updateTime</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>currentTime <span class="token operator">=</span> e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>currentTime
<span class="token punctuation">}</span>
</code></pre></div><p><strong>但是这个时间是小数点的 需要进行格式化</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">format</span> <span class="token punctuation">(</span><span class="token parameter">inteval</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  inteval <span class="token operator">=</span> inteval <span class="token operator">|</span> <span class="token number">0</span>
  <span class="token keyword">let</span> minute <span class="token operator">=</span> inteval <span class="token operator">/</span><span class="token number">60</span> <span class="token operator">|</span> <span class="token number">0</span>
  <span class="token keyword">let</span> second <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_pad</span><span class="token punctuation">(</span>inteval <span class="token operator">%</span> <span class="token number">60</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>minute<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>second<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
<span class="token punctuation">}</span>

<span class="token comment">// 当秒的字符串长度小于于2 就在前面补0</span>
<span class="token function">_pad</span><span class="token punctuation">(</span><span class="token parameter">num<span class="token punctuation">,</span>n<span class="token operator">=</span><span class="token number">2</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> len <span class="token operator">=</span> num<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length
  <span class="token keyword">while</span><span class="token punctuation">(</span>len <span class="token operator">&lt;</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    num <span class="token operator">=</span> <span class="token string">'0'</span> <span class="token operator">+</span> num
    len<span class="token operator">++</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> num
<span class="token punctuation">}</span>

</code></pre></div><p>调用格式化时间 然后挂在 dom 上</p> <h3>进度条组件</h3>
在play组件上的样式
<blockquote><p>flex布局,垂直居中,水平也居中,上下有两个padding 左右span文字对齐方式不同</p></blockquote> <div class="language-stylus extra-class"><pre class="language-stylus"><code><span class="token selector">.progress-wrapper</span>
  <span class="token property-declaration"><span class="token property">display</span> flex</span>
  <span class="token property-declaration"><span class="token property">align-items</span> center</span>
  <span class="token property-declaration"><span class="token property">width</span> <span class="token number">80%</span></span>
  <span class="token property-declaration"><span class="token property">margin</span> <span class="token number">0</span> auto</span>
  <span class="token property-declaration"><span class="token property">padding</span> <span class="token number">10</span>px <span class="token number">0</span></span>
  <span class="token selector">.time</span>
    <span class="token property-declaration"><span class="token property">color</span><span class="token punctuation">:</span>$color-text</span>
    <span class="token property-declaration"><span class="token property">font-size</span> $font-size-small</span>
    <span class="token property-declaration"><span class="token property">flex</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">30</span>px</span>
    <span class="token property-declaration"><span class="token property">line-height</span> <span class="token number">1.875</span>rem</span>
    <span class="token property-declaration"><span class="token property">width</span> <span class="token number">1.875</span>rem</span>
    <span class="token selector">&amp;.time-l</span>
      <span class="token property-declaration"><span class="token property">text-align</span> left</span>
    <span class="token selector">&amp;.time-r</span>
      <span class="token property-declaration"><span class="token property">text-align</span> right</span>
  <span class="token selector">.progress-bar-wrapper</span>
    <span class="token property-declaration"><span class="token property">flex</span> <span class="token number">1</span></span>
</code></pre></div><p>progress-bar 组件</p> <p>dom 结构：</p> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>progress-bar<span class="token punctuation">&quot;</span></span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>progressbar<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>progressClick<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- 总进度条 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>bar-inner<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token comment">&lt;!-- 进度条左侧 --&gt;</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>progress<span class="token punctuation">&quot;</span></span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>progress<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
      <span class="token comment">&lt;!-- 进度条按钮 --&gt;</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>progress-btn-wrapper<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span>
          <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>progress-btn<span class="token punctuation">&quot;</span></span>
          <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>progressbtn<span class="token punctuation">&quot;</span></span>
          <span class="token attr-name">@touchstart.prevent</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>progressTouchStart<span class="token punctuation">&quot;</span></span>
          <span class="token attr-name">@touchmove.prevent</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>progressTouchMove<span class="token punctuation">&quot;</span></span>
          <span class="token attr-name">@touchend.prevent</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>progressTouchEnd<span class="token punctuation">&quot;</span></span>
        <span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p><strong>进度条样式</strong></p> <div class="language-stylus extra-class"><pre class="language-stylus"><code><span class="token selector">.progress-bar</span>
  <span class="token property-declaration"><span class="token property">height</span> <span class="token number">30</span>px</span>
  <span class="token selector">.bar-inner</span>
    <span class="token property-declaration"><span class="token property">position</span> relative</span>
    <span class="token property-declaration"><span class="token property">top</span> <span class="token number">13</span>px</span>
    <span class="token property-declaration"><span class="token property">height</span> <span class="token number">4</span>px</span>
    <span class="token property-declaration"><span class="token property">background</span> <span class="token func"><span class="token function">rgba</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0.3</span><span class="token punctuation">)</span></span></span>
    <span class="token selector">.progress</span>
      <span class="token property-declaration"><span class="token property">position</span> absolute</span>
      <span class="token property-declaration"><span class="token property">height</span> <span class="token number">100%</span></span>
      <span class="token property-declaration"><span class="token property">background</span> $color-theme</span>
    <span class="token selector">.progress-btn-wrapper</span>
      <span class="token property-declaration"><span class="token property">position</span> absolute</span>
      <span class="token property-declaration"><span class="token property">left</span> <span class="token operator">-</span><span class="token number">8</span>px</span>
      <span class="token property-declaration"><span class="token property">top</span> <span class="token operator">-</span><span class="token number">13</span>px</span>
      <span class="token property-declaration"><span class="token property">width</span> <span class="token number">30</span>px</span>
      <span class="token property-declaration"><span class="token property">height</span> <span class="token number">30</span>px</span>
      <span class="token selector">.progress-btn</span>
        <span class="token property-declaration"><span class="token property">position</span> relative</span>
        <span class="token property-declaration"><span class="token property">top</span> <span class="token number">7</span>px</span>
        <span class="token property-declaration"><span class="token property">left</span> <span class="token number">7</span>px</span>
        <span class="token property-declaration"><span class="token property">box-sizing</span> border-box</span>
        <span class="token property-declaration"><span class="token property">wdith</span> <span class="token number">16</span>px</span>
        <span class="token property-declaration"><span class="token property">height</span> <span class="token number">16</span>px</span>
        <span class="token property-declaration"><span class="token property">border</span> <span class="token number">3</span>px solid $color-text</span>
        <span class="token property-declaration"><span class="token property">border-radius</span> <span class="token number">50%</span></span>
        <span class="token property-declaration"><span class="token property">background</span> $color-theme</span>
</code></pre></div><p><strong>对应的效果图</strong></p> <p><img src="https://i.loli.net/2020/01/18/yAONqK5FQR9wYL3.png" alt="QQ截图20200118213149.png"></p> <p><strong>挂到 play.vue 上</strong></p> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>progress-bar-wrapper<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>progressbar</span> <span class="token attr-name">:currentTime</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>currentTime<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:songsTime</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>songsTime<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:precent</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>precent<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@percentChangeEnd</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>onProgressBarChange<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>progressbar</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>precent 对 progress-bar 组件进度条有用</p> <div class="language-js extra-class"><pre class="language-js"><code>computed <span class="token operator">:</span><span class="token punctuation">{</span>
  <span class="token function">precent</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>currentTime <span class="token operator">/</span> <span class="token keyword">this</span><span class="token punctuation">.</span>songTime
  <span class="token punctuation">}</span>
 <span class="token punctuation">}</span>
</code></pre></div><p>使进度条睡着歌曲进度而改变</p> <div class="language-js extra-class"><pre class="language-js"><code>watch<span class="token operator">:</span><span class="token punctuation">{</span>
  <span class="token function">currentTime</span> <span class="token punctuation">(</span><span class="token parameter">val</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>val <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 总进度条长度</span>
      <span class="token keyword">const</span> progressTotalWidth <span class="token operator">=</span><span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>progressbar<span class="token punctuation">.</span>clientWidth <span class="token operator">-</span><span class="token number">16</span>
      <span class="token comment">// 左侧progress偏移</span>
      cost precentx <span class="token operator">=</span> val <span class="token operator">/</span><span class="token keyword">this</span><span class="token punctuation">.</span>somngTime
      <span class="token keyword">const</span> progressWidth <span class="token operator">=</span> progressTotalWidth <span class="token operator">*</span> precentx
      <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>progress<span class="token punctuation">.</span>style<span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>progressWidth<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">px</span><span class="token template-punctuation string">`</span></span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>progressbtn<span class="token punctuation">.</span>style<span class="token punctuation">[</span>transform<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">translate3d(</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>progressWidth<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">px,0,0)</span><span class="token template-punctuation string">`</span></span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="custom-block warning"><p class="custom-block-title">进度条拖拽</p> <p>实现方法:</p> <ul><li>定义好偏移函数</li> <li>使用 js 的三个钩子(<code>touchstart</code> <code>touchmove</code> <code>touchend</code>) 对进度条实现偏移</li> <li>向外派发事件 将当前 precent 转发到 play 组件</li></ul></div> <h3>定义偏移方法</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">_offset</span> <span class="token punctuation">(</span><span class="token parameter">offsetWidth</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>progress<span class="token punctuation">.</span>style<span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>offsetWidth<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">px</span><span class="token template-punctuation string">`</span></span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>progressbtn<span class="token punctuation">.</span>style<span class="token punctuation">[</span>transform<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">translate3d(</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>offsetWidth<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">px,0,0)</span><span class="token template-punctuation string">`</span></span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token function">created</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>touch <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// 记录第一次触屏位置 和初始进度条偏移</span>
<span class="token function">progressTouchStart</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>touch<span class="token punctuation">.</span>initiated <span class="token operator">=</span> <span class="token boolean">true</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>touch<span class="token punctuation">.</span>startX <span class="token operator">=</span> e<span class="token punctuation">.</span>touches<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>pageX
<span class="token keyword">this</span><span class="token punctuation">.</span>touch<span class="token punctuation">.</span>left <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>progress<span class="token punctuation">.</span>clientWidth
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token comment">// 记录拖动偏移量,现在偏移量等于初始偏移量+拖动偏移 但是不能呢个超过进度条的总宽度</span>
<span class="token function">progressTouchMove</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
 <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>touch<span class="token punctuation">.</span>initiated<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">const</span> moveWidth <span class="token operator">=</span> e<span class="token punctuation">.</span>touches<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>pageX <span class="token operator">-</span> <span class="token keyword">this</span><span class="token punctuation">.</span>touch<span class="token punctuation">.</span>startX
      <span class="token keyword">const</span> offsetWidth <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>progressbar<span class="token punctuation">.</span>clientWidth <span class="token operator">-</span> <span class="token number">16</span><span class="token punctuation">,</span> Math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>touch<span class="token punctuation">.</span>left <span class="token operator">+</span> moveWidth<span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_triggerPrecent</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_offset</span><span class="token punctuation">(</span>offsetWidth<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token comment">// 初始化为false 将拖动信息转发出去</span>
<span class="token function">progressTouchEnd</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>touch<span class="token punctuation">.</span>initiated <span class="token operator">=</span> <span class="token boolean">false</span>
<span class="token keyword">const</span> barWidth <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>progressbar<span class="token punctuation">.</span>clientWidth<span class="token operator">-</span><span class="token number">16</span>
<span class="token keyword">const</span> precent <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>progress<span class="token punctuation">.</span>clientWidth <span class="token operator">/</span> barWidth
<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">'percentChangeEnd'</span><span class="token punctuation">,</span>precent<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>

 <span class="token function">_triggerPrecent</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 派发当前precent</span>
      <span class="token keyword">const</span> progressTotalWidth <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>progressbar<span class="token punctuation">.</span>clientWidth <span class="token operator">-</span> <span class="token number">16</span>
      <span class="token keyword">const</span> precent <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>progress<span class="token punctuation">.</span>clientWidth <span class="token operator">/</span> progressTotalWidth
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">'precentChange'</span><span class="token punctuation">,</span> precent<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
</code></pre></div><p>**play 组件上监听转发事件 **</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">onProgressBarChange</span> <span class="token punctuation">(</span><span class="token parameter">precent</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 控制播放时间</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>audio<span class="token punctuation">.</span>currentTime <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>songTime <span class="token operator">*</span> precent
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>playing<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 如果拖动进度条暂停了 就继续播放</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">togglePlaying</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>currentLyric<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 寻找歌词</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>currentLyric<span class="token punctuation">.</span><span class="token function">seek</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>audio<span class="token punctuation">.</span>currentTime <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>实现效果图</p> <p><img src="https://i.loli.net/2020/01/19/a1WbrhY7UJPOQsV.gif" alt="GIF.gif"></p> <p>添加完了拖动事件，接下来添加点击变换进度条事件.</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>原理也是一样，也是计算 <code>progressgress</code> 偏移和 <code>progressbtn</code> 偏移，然后派发 precent 出去</p></div> <div class="language-js extra-class"><pre class="language-js"><code> <span class="token comment">// 点击进度条事件</span>
    <span class="token function">progressClick</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">//  ! e.pageX 获取到的位置有bug</span>
      <span class="token keyword">const</span> rect <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>progressbar<span class="token punctuation">.</span><span class="token function">getBoundingClientRect</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token comment">// rect.left 元素距离左边的距离</span>
      <span class="token comment">// e.pageX 点击距离左边的距离</span>
      <span class="token keyword">const</span> offsetWidth <span class="token operator">=</span> e<span class="token punctuation">.</span>pageX <span class="token operator">-</span> rect<span class="token punctuation">.</span>left
      <span class="token comment">// console.log(rect, e.pageX)</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_offset</span><span class="token punctuation">(</span>offsetWidth<span class="token punctuation">)</span>
      <span class="token keyword">const</span> barWidth <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>progressbar<span class="token punctuation">.</span>clientWidth <span class="token operator">-</span> <span class="token number">16</span>
      <span class="token keyword">const</span> percent <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>progress<span class="token punctuation">.</span>clientWidth <span class="token operator">/</span> barWidth
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">'percentChangeEnd'</span><span class="token punctuation">,</span> percent<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><div class="custom-block danger"><p class="custom-block-title">bug</p> <p>此处如果直接使用 <code>e.pageX</code> 记录元素距左边的位置会有 bug,我们这里使用 <code>getBoundClientRect()</code>相对视口位置 bar 相对浏览器的左侧视口位置 偏移量就等于 <code>e.pageX-rect</code></p></div> <p>这样我们就完成了进度条的点击和拖拽进度效果</p> <p>接着我们要给 <code>min-player</code> 也制作一个圆形播放进度条效果
同样我们创建 <code>progress-circle</code> 基础组件</p> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>progresscircle<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- wdith height 是svg圈的大小 stroke-dasharray是描边总周长 dashOffset描边偏移量  --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>svg</span>
      <span class="token attr-name">:width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>radius<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">:height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>radius<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">viewBox</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>0 0 100 100<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">version</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>1.1<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>http://www.w3.org/2000/svg<span class="token punctuation">&quot;</span></span>
    <span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span>
        <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>progress-background<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>50<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>50<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>50<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>transparent<span class="token punctuation">&quot;</span></span>
      <span class="token punctuation">/&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span>
        <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>progress-bar<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>50<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>50<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>50<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>transparent<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">:stroke-dasharray</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>dashArray<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">:stroke-dashoffset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>dashOffset<span class="token punctuation">&quot;</span></span>
      <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>svg</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>slot</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>slot</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">'progresscircle'</span><span class="token punctuation">,</span>
  props<span class="token operator">:</span> <span class="token punctuation">{</span>
    radius<span class="token operator">:</span> <span class="token punctuation">{</span>
      type<span class="token operator">:</span> Number<span class="token punctuation">,</span>
      <span class="token keyword">default</span><span class="token operator">:</span> <span class="token number">100</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    precent<span class="token operator">:</span> <span class="token punctuation">{</span>
      type<span class="token operator">:</span> Number<span class="token punctuation">,</span>
      <span class="token keyword">default</span><span class="token operator">:</span> <span class="token number">0</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      dashArray<span class="token operator">:</span> <span class="token number">314</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  components<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>

  computed<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">dashOffset</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> <span class="token keyword">this</span><span class="token punctuation">.</span>precent<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token keyword">this</span><span class="token punctuation">.</span>dashArray
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token function">beforeMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token function">mounted</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>

  methods<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>

  watch<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>stylus<span class="token punctuation">&quot;</span></span> <span class="token attr-name">scoped</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
@import <span class="token string">'~@/common/stylus/variable.styl'</span>
 .progresscircle
    <span class="token property">position</span><span class="token punctuation">:</span> relative
    circle
      <span class="token property">stroke-width</span><span class="token punctuation">:</span> 6px
      <span class="token property">transform-origin</span><span class="token punctuation">:</span> center
      &amp;.progress-background
        <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">scale</span><span class="token punctuation">(</span>0.9<span class="token punctuation">)</span>
        <span class="token property">stroke</span><span class="token punctuation">:</span> $color-theme-d
      &amp;.progress-bar
        <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">scale</span><span class="token punctuation">(</span>0.9<span class="token punctuation">)</span> <span class="token function">rotate</span><span class="token punctuation">(</span>-90deg<span class="token punctuation">)</span>
        <span class="token property">stroke</span><span class="token punctuation">:</span> $color-theme
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h3>组件接受两个参数</h3> <ul><li>radius radius 用来控制 svg 图的宽高 我们这里 radius 传入 32</li> <li>precent svg 图下 progress-bar 有两个参数
<ul><li><strong>stroke-dasharray</strong>描边周长 这里应该是 314(2<em>3.14</em>50)</li> <li><strong>stroke-dashoffset</strong> 外层有颜色描边的长度 这里我们用(1-precent)*dasharray 来表示当前进度</li></ul></li></ul> <h4 id="💛播放器模式切换"><a href="#💛播放器模式切换" class="header-anchor">#</a> 💛播放器模式切换</h4> <p>一开始播放模式我们是写死的 icon,接下来就不用写死了</p> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>icon i-left<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>changeMode<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span> <span class="token attr-name">:class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>iconMode<span class="token punctuation">&quot;</span></span> <span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>i</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
.... iconMode () { return this.mode === playMode.sequence ? 'icon-sequence' :
this.mode === playMode.loop ? 'icon-loop' : 'icon-random' }
</code></pre></div><p>更换模式的实现，模式以共有三种所以我们设置模式 3 个里面循环</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">changeMode</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> mode <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>mode <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">3</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setMode</span><span class="token punctuation">(</span>mode<span class="token punctuation">)</span>
  <span class="token keyword">let</span> list <span class="token operator">=</span><span class="token keyword">null</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token punctuation">.</span>mode <span class="token operator">===</span> playMode<span class="token punctuation">.</span>random<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    list <span class="token operator">=</span> <span class="token function">shuffle</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>sequencelist<span class="token punctuation">)</span>
     <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">resetCurrentIndex</span><span class="token punctuation">(</span>list<span class="token punctuation">)</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setsplaylist</span><span class="token punctuation">(</span>list<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
        list <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>sequencelist
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">resetCurrentIndex</span><span class="token punctuation">(</span>list<span class="token punctuation">)</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setsplaylist</span><span class="token punctuation">(</span>list<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token operator">...</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token function">洗牌函数</span><span class="token punctuation">(</span>遍历数组用array<span class="token punctuation">[</span>i<span class="token punctuation">]</span>去和随机的min到max下标的数祖元素去交换 这样数组就会很乱<span class="token punctuation">)</span>

<span class="token keyword">function</span> <span class="token function">getRandomInt</span><span class="token punctuation">(</span><span class="token parameter">min<span class="token punctuation">,</span>max</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token comment">// 保证取到min-max的随机数</span>
  <span class="token keyword">return</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>max <span class="token operator">-</span> min <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> min<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">shuffle</span><span class="token punctuation">(</span><span class="token parameter">arr</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">let</span> _arr <span class="token operator">=</span> arr<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i<span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>_arr<span class="token punctuation">.</span>length<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">let</span> j<span class="token operator">=</span> <span class="token function">getRandomInt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>i<span class="token punctuation">)</span>
    <span class="token keyword">let</span> t <span class="token operator">=</span> _arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
    _arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> _arr<span class="token punctuation">[</span>j<span class="token punctuation">]</span>
    _arr<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> t
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> _arr
<span class="token punctuation">}</span>

</code></pre></div><div class="custom-block warning"><p class="custom-block-title">注意</p> <p>这里用到的定义的两个方法</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">resetCurrentIndex</span><span class="token punctuation">(</span><span class="token parameter">list</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
<span class="token comment">// 找到当前歌曲id相同的list元素索引 这样歌曲就不会再切换了模式之后 list改变 currentSong改变 当前歌曲被切换了</span>
<span class="token keyword">let</span> index1 <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">finIndex</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
  <span class="token keyword">return</span> itlem<span class="token punctuation">.</span>id <span class="token operator">===</span> <span class="token keyword">this</span><span class="token punctuation">.</span>currentSong<span class="token punctuation">.</span>id
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setCurrentindex</span><span class="token punctuation">(</span>index1<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 然后我们在监听currentSong时这样去写</span>
<span class="token function">currentSong</span><span class="token punctuation">(</span><span class="token parameter">newSomng<span class="token punctuation">,</span>oldSong</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>newSong<span class="token punctuation">.</span>id <span class="token operator">===</span> oldSong<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <h3>接下来就是播放器的一些问题解决</h3> <ol><li>歌曲播放到末尾 自动切换下一首</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 监听ended事件</span>
 <span class="token function">End</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>mode <span class="token operator">===</span> playMode<span class="token punctuation">.</span>loop<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">loop</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre></div><ol start="2"><li>循环播放模式设置</li></ol> <div class="language-JS extra-class"><pre class="language-js"><code><span class="token function">loop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>audio<span class="token punctuation">.</span>currentTime <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>audio<span class="token punctuation">.</span><span class="token function">play</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">1000</span><span class="token punctuation">)</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>currentLyric<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>currentLyric<span class="token punctuation">,</span><span class="token function">seek</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ol start="3"><li>实现封面随机播放</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 添加点击事件</span>
<span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">randomPlay</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    list<span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>songs
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>


<span class="token comment">// 这里需要设置actions</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">randomPlay</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span>commit<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>list<span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">commit</span><span class="token punctuation">(</span>types<span class="token punctuation">.</span><span class="token constant">SET_PLAY_MODE</span><span class="token punctuation">,</span> playMode<span class="token punctuation">.</span>random<span class="token punctuation">)</span>
  <span class="token function">commit</span><span class="token punctuation">(</span>types<span class="token punctuation">.</span><span class="token constant">SET_SEQUENCE</span><span class="token punctuation">,</span> list<span class="token punctuation">)</span>
  <span class="token keyword">let</span> randomlist <span class="token operator">=</span> <span class="token function">shuffle</span><span class="token punctuation">(</span>list<span class="token punctuation">)</span>
  <span class="token function">commit</span><span class="token punctuation">(</span>types<span class="token punctuation">.</span><span class="token constant">SET_CURRENTINDEX</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
  <span class="token function">commit</span><span class="token punctuation">(</span>types<span class="token punctuation">.</span><span class="token constant">SET_PLAYLIST</span><span class="token punctuation">,</span> randomlist<span class="token punctuation">)</span>
  <span class="token function">commit</span><span class="token punctuation">(</span>types<span class="token punctuation">.</span><span class="token constant">SET_FULLSCREEN</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
  <span class="token function">commit</span><span class="token punctuation">(</span>types<span class="token punctuation">.</span><span class="token constant">SET_PLAYING</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

</code></pre></div><h4 id="❤️播放器歌词部分"><a href="#❤️播放器歌词部分" class="header-anchor">#</a> ❤️播放器歌词部分</h4> <p>获取歌词部分</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> axios <span class="token keyword">from</span> <span class="token string">'axios'</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">getLyric</span><span class="token punctuation">(</span><span class="token parameter">id</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> url <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">http://neteasemusic.yangxiansheng.top/lyric?id=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
  <span class="token keyword">return</span> axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>methods 里面定义好获取歌词方法</p> <div class="language-js extra-class"><pre class="language-js"><code> <span class="token function">_getLyric</span> <span class="token punctuation">(</span><span class="token parameter">id</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">getLyric</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">// 调用第三方库 将currentLyric转化为一个time-text对象</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>currentLyric <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Lyric</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>data<span class="token punctuation">.</span>lrc<span class="token punctuation">.</span>lyric<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>handleLyric<span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>playing<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span>currentLyric<span class="token punctuation">.</span><span class="token function">play</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><blockquote><p>这里使用到了第三方库<code>Lyric-parser</code> 这个插件的作用就是讲 currentLyric 转化为一个 time-text 对象 便于使用</p></blockquote> <p>在 watch 里面监听 currentSong 调用</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">currentSong</span><span class="token punctuation">(</span><span class="token parameter">newSong<span class="token punctuation">,</span>oldSong</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>newSong<span class="token punctuation">.</span>id <span class="token operator">===</span> oldSong<span class="token punctuation">.</span>id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span>
  <span class="token punctuation">}</span>
  <span class="token function">getMusic</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>currentSong<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>songurl<span class="token operator">=</span> res<span class="token punctuation">.</span>data<span class="token punctuation">.</span>data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>url
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>currentSong<span class="token punctuation">.</span>id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>currentLyric<span class="token punctuation">.</span><span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_getLyric</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>currentSong<span class="token punctuation">.</span>id<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>这样就可以实现歌词的自动跳转</p> <p><img src="https://i.loli.net/2020/01/19/nskZdBEUqrLKuyC.gif" alt="GIF.gif"></p> <p>我们要实现歌词到了第五行后面自动向下滚动</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">handleLyric</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span>lineNum<span class="token punctuation">,</span>txt<span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 当前行</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>currentLineNum <span class="token operator">=</span> lineNum
  <span class="token keyword">if</span><span class="token punctuation">(</span>lineNum <span class="token operator">&gt;</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">let</span> LineEl <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>lyricLine<span class="token punctuation">[</span>lineNum<span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">]</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>lyricList<span class="token punctuation">.</span><span class="token function">scrollToElement</span><span class="token punctuation">(</span>LineEl<span class="token punctuation">,</span><span class="token number">500</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>lyricList<span class="token punctuation">.</span><span class="token function">scrollTo</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1000</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 记录歌词</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>currentLyrictxt <span class="token operator">=</span> txt
<span class="token punctuation">}</span>
</code></pre></div><p>实现歌词左右滑动 切换(同样使用到了 touch 事件)</p> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Scroll</span>
  <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>middle-r<span class="token punctuation">&quot;</span></span>
  <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>lyricList<span class="token punctuation">&quot;</span></span>
  <span class="token attr-name">:data</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>currentLyric &amp;&amp; currentLyric.lines<span class="token punctuation">&quot;</span></span>
<span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>lyric-wrapper<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>currentLyric<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>lyricLine<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">:class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>{'current':currentLineNum === index}<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>(line,index) in currentLyric.lines<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>index<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{line.txt}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Scroll</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>滑动处理</p> <div class="language-js extra-class"><pre class="language-js"><code>  <span class="token comment">//  todo:左右滑动效果展示歌词</span>
    <span class="token function">midleTouchStart</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 设置标志位已经初始化</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>touch<span class="token punctuation">.</span>initiated <span class="token operator">=</span> <span class="token boolean">true</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>touch<span class="token punctuation">.</span>startX <span class="token operator">=</span> e<span class="token punctuation">.</span>touches<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>pageX
      <span class="token keyword">this</span><span class="token punctuation">.</span>touch<span class="token punctuation">.</span>startY <span class="token operator">=</span> e<span class="token punctuation">.</span>touches<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>pageY
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">midleTouchMove</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>touch<span class="token punctuation">.</span>initiated<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span>
      <span class="token punctuation">}</span>
      <span class="token comment">// 拿到差值</span>
      <span class="token keyword">const</span> deltaX <span class="token operator">=</span> e<span class="token punctuation">.</span>touches<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>pageX <span class="token operator">-</span> <span class="token keyword">this</span><span class="token punctuation">.</span>touch<span class="token punctuation">.</span>startX
      <span class="token keyword">const</span> deltaY <span class="token operator">=</span> e<span class="token punctuation">.</span>touches<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>pageY <span class="token operator">-</span> <span class="token keyword">this</span><span class="token punctuation">.</span>touch<span class="token punctuation">.</span>startY
      <span class="token comment">// 歌词纵向滚动 当纵向偏移大于左右偏移的时候 我们不应该左右移动</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span>deltaY<span class="token punctuation">)</span> <span class="token operator">&gt;</span> Math<span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span>deltaX<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span>
      <span class="token punctuation">}</span>
      <span class="token comment">// 拿到滚动过程中middle-r距离左右两侧的屏幕的差值</span>
      <span class="token keyword">const</span> left <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>currentShow <span class="token operator">===</span> <span class="token string">'cd'</span> <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> <span class="token operator">-</span>window<span class="token punctuation">.</span>innerWidth
      <span class="token keyword">const</span> offsetWidth <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> Math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token operator">-</span>window<span class="token punctuation">.</span>innerWidth<span class="token punctuation">,</span> left <span class="token operator">+</span> deltaX<span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>touch<span class="token punctuation">.</span>percent <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span>offsetWidth <span class="token operator">/</span> window<span class="token punctuation">.</span>innerWidth<span class="token punctuation">)</span>
      <span class="token comment">// lyricList是一个Vue(scroll)组件，是无法直接造作它的dom的，用$el来代替它的dom</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>lyricList<span class="token punctuation">.</span>$el<span class="token punctuation">.</span>style<span class="token punctuation">[</span>transform<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">translate3d(</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>offsetWidth<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">px,0,0)</span><span class="token template-punctuation string">`</span></span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>lyricList<span class="token punctuation">.</span>$el<span class="token punctuation">.</span>style<span class="token punctuation">[</span>transitionDuration<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span>
      <span class="token comment">// 透明度的渐变</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>middleL<span class="token punctuation">.</span>style<span class="token punctuation">.</span>opacity <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">-</span> <span class="token keyword">this</span><span class="token punctuation">.</span>touch<span class="token punctuation">.</span>percent
      <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>middleL<span class="token punctuation">.</span>style<span class="token punctuation">[</span>transitionDuration<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">middleTouchEnd</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 用来决定停在哪个位置</span>
      <span class="token keyword">let</span> offsetWidth
      <span class="token keyword">let</span> opacity
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>currentShow <span class="token operator">===</span> <span class="token string">'cd'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 从右向左滑，只需要滑10%就行</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>touch<span class="token punctuation">.</span>percent <span class="token operator">&gt;</span> <span class="token number">0.1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          offsetWidth <span class="token operator">=</span> <span class="token operator">-</span>window<span class="token punctuation">.</span>innerWidth <span class="token comment">// 最终停止的位置</span>
          opacity <span class="token operator">=</span> <span class="token number">0</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span>currentShow <span class="token operator">=</span> <span class="token string">'lyric'</span> <span class="token comment">// 改变dot的css样式</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
          offsetWidth <span class="token operator">=</span> <span class="token number">0</span> <span class="token comment">// 否则就回到原来的位置</span>
          opacity <span class="token operator">=</span> <span class="token number">1</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span> <span class="token comment">// 从右向左滑，看的是0.9</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>touch<span class="token punctuation">.</span>percent <span class="token operator">&lt;</span> <span class="token number">0.9</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          offsetWidth <span class="token operator">=</span> <span class="token number">0</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span>currentShow <span class="token operator">=</span> <span class="token string">'cd'</span>
          opacity <span class="token operator">=</span> <span class="token number">1</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
          offsetWidth <span class="token operator">=</span> <span class="token operator">-</span>window<span class="token punctuation">.</span>innerWidth
          opacity <span class="token operator">=</span> <span class="token number">0</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
</code></pre></div><p>dot区域</p> <div class="language-vue extra-class"><pre class="language-vue"><code>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>dot-wrapper<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>dot<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>{'active':currentShow === 'cd'}<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>dot<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>{'active':currentShow === 'lyric'}<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>后面发现一个问题 就是iphone无法播放出声音，这是因为iphone设备或者微信浏览器对用户流量进行监控 不允许用户在浏览器上对audio进行播放 对此我采用了监听<code>touchstart</code>事件对audio标签进行播放</p> <div class="language-js extra-class"><pre class="language-js"><code> <span class="token function">firstPlay</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>audio<span class="token punctuation">.</span><span class="token function">play</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><h4 id="mixin方式解决滚动bug"><a href="#mixin方式解决滚动bug" class="header-anchor">#</a> mixin方式解决滚动bug</h4> <p>我们发现实现后的滚动条的组件 滚动到底部几乎不能被看到,这是因为背mini播放器阻挡住了，所以我们需要给这些组件的scroll重新refresh，然后给组件设置mini播放器高的bottom</p> <h3>定义mixin</h3>
通过mixin的方式引入代码到组件是一个很方便的方法，这些代码会被复用，然后merge到组件的原来的钩子上
<div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>mapGetters<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vuex'</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> playlistMixin <span class="token operator">=</span><span class="token punctuation">{</span>
  computed<span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token operator">...</span><span class="token function">mapGetters</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
      <span class="token string">'playlist'</span>
    <span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">mounted</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">handlePlaylist</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>playlist<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// keep-alive的方法</span>
  <span class="token function">activated</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">handlePlaylistMixin</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>playlist<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  watch<span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token function">playlist</span><span class="token punctuation">(</span><span class="token parameter">newval</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">handlePlaylist</span><span class="token punctuation">(</span>newval<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  methods<span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token function">handlePlaylist</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      thorw <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">' methods must be define'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <h4 id="🌟总结"><a href="#🌟总结" class="header-anchor">#</a> 🌟总结</h4> <p>综上,播放器组件全部写完，里面包含了player组件 progress-bar组件 progress-circle组件，使用到了vuex实现状态管理，学习到了样式处理 播放状态管理 以及模式切换涉及到的知识等等,接下来就是开发榜单组件，加油~~~</p> <p>附上效果图</p> <p><img src="https://i.loli.net/2020/01/19/TpaQiOYkyRcSsVr.gif" alt="GIF.gif"></p></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/assets/js/app.81dd3622.js" defer></script><script src="/assets/js/2.d1b1e148.js" defer></script><script src="/assets/js/3.103e70cb.js" defer></script><script src="/assets/js/4.a3faee54.js" defer></script>
  </body>
</html>
