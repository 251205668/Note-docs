<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>webpack 4.0 学习 | 前端面试知识总结</title>
    <meta name="description" content="自家使用,暂不外传">
    <meta name="generator" content="VuePress 1.3.1">
    <link rel="icon" href="/favicon.ico">
    
    <link rel="preload" href="/assets/css/0.styles.6a4803ab.css" as="style"><link rel="preload" href="/assets/js/app.81dd3622.js" as="script"><link rel="preload" href="/assets/js/2.d1b1e148.js" as="script"><link rel="preload" href="/assets/js/32.d42beb3f.js" as="script"><link rel="preload" href="/assets/js/4.a3faee54.js" as="script"><link rel="prefetch" href="/assets/js/10.42124fbe.js"><link rel="prefetch" href="/assets/js/11.bdef2e64.js"><link rel="prefetch" href="/assets/js/12.9c5e83ed.js"><link rel="prefetch" href="/assets/js/13.3db43aaf.js"><link rel="prefetch" href="/assets/js/14.8f2ec86d.js"><link rel="prefetch" href="/assets/js/15.c6286125.js"><link rel="prefetch" href="/assets/js/16.5da2b31d.js"><link rel="prefetch" href="/assets/js/17.c9deef07.js"><link rel="prefetch" href="/assets/js/18.13ed30af.js"><link rel="prefetch" href="/assets/js/19.f1a01180.js"><link rel="prefetch" href="/assets/js/20.30f7288c.js"><link rel="prefetch" href="/assets/js/21.477730e4.js"><link rel="prefetch" href="/assets/js/22.ab119ff1.js"><link rel="prefetch" href="/assets/js/23.9bbc22fc.js"><link rel="prefetch" href="/assets/js/24.cb1899b8.js"><link rel="prefetch" href="/assets/js/25.64669f1d.js"><link rel="prefetch" href="/assets/js/26.f3040183.js"><link rel="prefetch" href="/assets/js/27.2938dd4c.js"><link rel="prefetch" href="/assets/js/28.cd87026d.js"><link rel="prefetch" href="/assets/js/29.b92287f4.js"><link rel="prefetch" href="/assets/js/3.103e70cb.js"><link rel="prefetch" href="/assets/js/30.af43d48f.js"><link rel="prefetch" href="/assets/js/31.8c7148f5.js"><link rel="prefetch" href="/assets/js/33.223bba8e.js"><link rel="prefetch" href="/assets/js/34.04b12083.js"><link rel="prefetch" href="/assets/js/35.19c65fa0.js"><link rel="prefetch" href="/assets/js/36.a1a664b9.js"><link rel="prefetch" href="/assets/js/37.d2e7a2dd.js"><link rel="prefetch" href="/assets/js/38.4f737159.js"><link rel="prefetch" href="/assets/js/39.fcdeadea.js"><link rel="prefetch" href="/assets/js/40.40a9daf9.js"><link rel="prefetch" href="/assets/js/5.2f32d917.js"><link rel="prefetch" href="/assets/js/6.d92ecc16.js"><link rel="prefetch" href="/assets/js/7.a09f8ef2.js"><link rel="prefetch" href="/assets/js/8.5b00daa2.js"><link rel="prefetch" href="/assets/js/9.9d06f44a.js">
    <link rel="stylesheet" href="/assets/css/0.styles.6a4803ab.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">前端面试知识总结</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/guide/" class="nav-link router-link-active">
  指南
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="项目" class="dropdown-title"><span class="title">项目</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/project/shop/" class="nav-link">
  大型电商
</a></li><li class="dropdown-item"><!----> <a href="/project/music/" class="nav-link">
  vue实现音乐app
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/guide/" class="nav-link router-link-active">
  指南
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="项目" class="dropdown-title"><span class="title">项目</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/project/shop/" class="nav-link">
  大型电商
</a></li><li class="dropdown-item"><!----> <a href="/project/music/" class="nav-link">
  vue实现音乐app
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>目录</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/guide/" class="sidebar-link">项目介绍</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>css基础到进阶</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/guide/css/test.html" class="sidebar-link">移动端问题</a></li><li><a href="/guide/css/layout.html" class="sidebar-link">前端常见布局</a></li><li><a href="/guide/css/alwaysCode.html" class="sidebar-link">常用css片段</a></li><li><a href="/guide/css/iconfont.html" class="sidebar-link">全局stylus配置及使用iconfont</a></li><li><a href="/guide/css/css-skill.html" class="sidebar-link">灵活使用css技巧</a></li><li><a href="/guide/css/code.html" class="sidebar-link">code pratice</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>js基础</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/guide/js/base.html" class="sidebar-link">基础</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>js进阶</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/guide/js/higher.html" class="sidebar-link">js??</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>MVVM分析</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/guide/vue/vue.html" class="sidebar-link">vue 基础部分</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Webpack实战分析</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/guide/webpack/test.html" class="active sidebar-link">webpack 4.0 学习</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/guide/webpack/test.html#安装并入门使用-webpack" class="sidebar-link">安装并入门使用 webpack</a></li><li class="sidebar-sub-header"><a href="/guide/webpack/test.html#模块化的概念-有哪些-webpack-模块" class="sidebar-link">模块化的概念,有哪些 webpack 模块</a></li><li class="sidebar-sub-header"><a href="/guide/webpack/test.html#webpack-配置文件和打包方式" class="sidebar-link">webpack 配置文件和打包方式</a></li><li class="sidebar-sub-header"><a href="/guide/webpack/test.html#webpack-核心" class="sidebar-link">Webpack 核心</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/guide/webpack/test.html#loader-和简单使用" class="sidebar-link">Loader 和简单使用</a></li><li class="sidebar-sub-header"><a href="/guide/webpack/test.html#打包图片" class="sidebar-link">打包图片</a></li><li class="sidebar-sub-header"><a href="/guide/webpack/test.html#打包样式文件" class="sidebar-link">打包样式文件</a></li><li class="sidebar-sub-header"><a href="/guide/webpack/test.html#webpack-常用插件使用" class="sidebar-link">Webpack 常用插件使用</a></li><li class="sidebar-sub-header"><a href="/guide/webpack/test.html#其他-重要配置插件" class="sidebar-link">其他(重要配置插件)</a></li></ul></li></ul></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Node.js基础到进阶</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>面试题总结</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="webpack-4-0-学习"><a href="#webpack-4-0-学习" class="header-anchor">#</a> webpack 4.0 学习</h1> <p><img src="https://raw.githubusercontent.com/imageList/imglist/master/20200722154349.png" alt="20200722154349"></p> <p><code>webpack</code>简单来说就是一个模块打包工具,他可以支持不光是<code>ES module</code>模块翻译,还可以支持多种形式的模块打包。</p> <h2 id="安装并入门使用-webpack"><a href="#安装并入门使用-webpack" class="header-anchor">#</a> 安装并入门使用 webpack</h2> <p>首先在文件夹下用<code>npm</code>初始化,然后执行命令</p> <blockquote><p>不建议全局安装 webpack,可能会因为版本原因导致项目运行不起来</p></blockquote> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># webpack脚手架</span>
$ cnpm <span class="token function">install</span> webpack-cli --save-dev
<span class="token comment"># webpack</span>
$ cnpm <span class="token function">install</span> webpack --save
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>可以指定<code>webpack</code>版本号进行安装脚手架</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ <span class="token function">npm</span> <span class="token function">install</span> webpack@4.43.0 webpack-cli -D
</code></pre></div></div> <p>然后找到使用到模块化主入口文件,例如我这里的<code>index.js</code></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token constant">P</span> <span class="token keyword">from</span> <span class="token string">'./p'</span>
<span class="token keyword">new</span> <span class="token class-name">P</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>之后执行打包命令</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ npx webpack index.js
</code></pre></div><p>打包完成之后会自动在项目根目录生成一个<code>dist</code>文件夹,里面包含<code>main.js</code>就是打包翻译后的文件。</p> <h2 id="模块化的概念-有哪些-webpack-模块"><a href="#模块化的概念-有哪些-webpack-模块" class="header-anchor">#</a> 模块化的概念,有哪些 webpack 模块</h2> <p>开发者将程序分解成<code>离散功能块</code>(discrete chunks of functionality)，并称之为模块。</p> <p>每个模块具有比完整程序<strong>更小的接触面</strong>，使得<code>校验</code>、<code>调试</code>、<code>测试</code>轻而易举。 精心编写的模块提供了可靠的抽象和封装界限，使得应用程序中每个模块都具有<code>条理清楚的设计</code>和<code>明确的目的</code>。</p> <p><code>webpack模块</code>包含以下:</p> <ul><li><code>ES2015 import</code> 语句</li> <li><code>CommonJS require()</code> 语句</li> <li><code>AMD define</code> 和 require 语句</li> <li><code>css/sass/less</code> 文件中的 <code>@import</code> 语句。</li> <li>样式(<code>url(...)</code>)或 HTML 文件(<code>&lt;img src=...&gt;</code>)中的图片链接(image url)</li></ul> <h2 id="webpack-配置文件和打包方式"><a href="#webpack-配置文件和打包方式" class="header-anchor">#</a> webpack 配置文件和打包方式</h2> <p><code>webpack</code>默认寻找的配置文件是<code>webpack.config.js</code>,如果需要更换配置文件,需要运行命令</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ npx webpack --config fileName.js
</code></pre></div><p><strong>基础配置</strong></p> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// 入口文件,这里是简写，entry:{main:'./src/index.js'}</span>
  entry<span class="token operator">:</span> <span class="token string">'./src/index.js'</span><span class="token punctuation">,</span>
  <span class="token comment">// 打包配置</span>
  output<span class="token operator">:</span> <span class="token punctuation">{</span>
    filename<span class="token operator">:</span> <span class="token string">'bundle.js'</span><span class="token punctuation">,</span>
    <span class="token comment">// 打包文件路径 当前配置文件根目录下的dist文件夹</span>
    path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'dist'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><p>最终打包效果:</p> <p><img src="https://raw.githubusercontent.com/imageList/imglist/master/20200722170005.png" alt="20200722170005"></p> <p><strong>配置 entry 和 output</strong></p> <p>如果需要打包多个文件,只需要设置<code>entry</code>对象即可</p> <div class="language-js extra-class"><pre class="language-js"><code>entry<span class="token operator">:</span><span class="token punctuation">{</span>
  main<span class="token operator">:</span> <span class="token string">'./src/index.js'</span><span class="token punctuation">,</span>
  sub<span class="token operator">:</span> <span class="token string">'./src/index.js'</span>
<span class="token punctuation">}</span>
</code></pre></div><p>最终生成的打包文件还配置一下<code>output</code>,否则会冲突</p> <div class="language-js extra-class"><pre class="language-js"><code>output<span class="token operator">:</span><span class="token punctuation">{</span>
  filename<span class="token operator">:</span><span class="token string">'[name].js'</span><span class="token punctuation">,</span>
  path<span class="token operator">:</span>path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span><span class="token string">'dist'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>运行<code>webpack</code>打包有几种方式</strong></p> <p>前提条件需要安装<code>webpack-cli</code>,他的作用是识别<code>webpack</code>命令。</p> <ul><li>使用全局打包,前提条件是全局环境安装了<code>webpack-cli</code></li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code>$ cnpm  <span class="token function">install</span> webpack -g
$ webpack index.js
</code></pre></div><ul><li>局部打包</li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code>$ npx webapck index.js
</code></pre></div><ul><li>配置<code>package.json</code>的<code>script</code>脚本进行打包</li></ul> <p><strong>打包输出结果分析</strong></p> <p><img src="https://raw.githubusercontent.com/imageList/imglist/master/20200722170654.png" alt="20200722170654"></p> <ul><li>Hash: 代表本次打包的唯一 hash</li> <li>Version: 本次打包的 webpack 版本号</li> <li>Time: 打包时间</li> <li>Asset: 打包生成文件，Size:文件大小,Chunks: 打包文件中可能是多个文件相互依赖的,其他文件打包也会把<code>JS文件对应的id值</code>放到<code>Chunks</code>下面,Chunk Names: 对应的名字。</li></ul> <p>这里的警告输出是因为没有指定模式,默认的<code>mode</code>配置是<code>production</code>,默认是压缩的。还可以设置开发环境模式(development)、</p> <h2 id="webpack-核心"><a href="#webpack-核心" class="header-anchor">#</a> Webpack 核心</h2> <h3 id="loader-和简单使用"><a href="#loader-和简单使用" class="header-anchor">#</a> Loader 和简单使用</h3> <p>有的时候需要打包的文件不一定只是<code>js</code>文件,可能是图片还可能是<code>vue</code>或者<code>jsx</code>等等文件。这个时候<code>webpack</code>默认是不支持打包的,<code>loader</code>就可以帮组快速打包这些非 js 文件。</p> <p><strong><code>loader</code>作用</strong>: 允许你打包除 <code>JavaScript</code> 之外的任何静态资源。首先将文件移动到打包路径,然后返回名称。</p> <p><strong>使用<code>loader</code>步骤</strong>: 1.定义<code>module</code>,配置规则 2.配置匹配规则和指定使用哪一个<code>loader</code> 3. 在<code>use</code>里面配置<code>loader配置项</code></p> <p><strong>简单的使用<code>file-loader</code>打包图片</strong></p> <p>首先在入口文件中引入图片,然后安装一下<code>file-loader</code></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> avatar <span class="token keyword">from</span> <span class="token string">'./avatar.jpg'</span>
</code></pre></div><p>然后需要在配置文件中配置打包规则</p> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token operator">...</span>

  <span class="token comment">// 模块打包规则</span>
  module<span class="token operator">:</span><span class="token punctuation">{</span>
    rules<span class="token operator">:</span><span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token comment">// 匹配规则</span>
        test<span class="token operator">:</span><span class="token regex">/\.(jpg|png|gif)$/</span><span class="token punctuation">,</span>
        <span class="token comment">// 使用到的loader</span>
        use<span class="token operator">:</span><span class="token punctuation">{</span>
          loader<span class="token operator">:</span><span class="token string">'file-loader'</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>接下来运行<code>webpack</code>打包命令即可</p> <p><img src="https://raw.githubusercontent.com/imageList/imglist/master/20200722175133.png" alt="20200722175133"></p> <h3 id="打包图片"><a href="#打包图片" class="header-anchor">#</a> 打包图片</h3> <ol><li>使用<code>file-loader</code>打包图片到指定目录</li></ol> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  mode<span class="token operator">:</span> <span class="token string">'production'</span><span class="token punctuation">,</span>
  extry<span class="token operator">:</span> <span class="token punctuation">{</span>
    main<span class="token operator">:</span> <span class="token string">'./src/index.js'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  module<span class="token operator">:</span> <span class="token punctuation">{</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex">/\.(jpg|png|gif)$/</span><span class="token punctuation">,</span>
        use<span class="token operator">:</span> <span class="token punctuation">{</span>
          loader<span class="token operator">:</span> <span class="token string">'file-loader'</span><span class="token punctuation">,</span>
          <span class="token comment">// 打包到 dist/images下</span>
          options<span class="token operator">:</span> <span class="token punctuation">{</span>
            name<span class="token operator">:</span> <span class="token string">'[name].[etc]'</span><span class="token punctuation">,</span>
            outputPath<span class="token operator">:</span> <span class="token string">'images/'</span><span class="token punctuation">,</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  output<span class="token operator">:</span> <span class="token punctuation">{</span>
    filename<span class="token operator">:</span> <span class="token string">'bundle.js'</span><span class="token punctuation">,</span>
    path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'dist'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><ol start="2"><li>使用<code>url-loader</code>打包</li></ol> <p>设置<code>limit:size</code>这个属性后,当文件超过这个大小,文件就会按照配置的规则进行打包输出到指定文件,如果没有超过,图片就会以 <code>base64</code> 格式保存在打包文件中,这样就有一个缺点,文件会越撑越大。</p> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token operator">...</span>
  module<span class="token operator">:</span><span class="token punctuation">{</span>
    rules<span class="token operator">:</span><span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        test<span class="token operator">:</span><span class="token regex">/\.(png|jpg|gif)$/</span><span class="token punctuation">,</span>
        use<span class="token operator">:</span><span class="token punctuation">{</span>
          loader<span class="token operator">:</span><span class="token string">'url-loader'</span><span class="token punctuation">,</span>
          options<span class="token operator">:</span><span class="token punctuation">{</span>
              name<span class="token operator">:</span><span class="token string">'[name].[etc]'</span><span class="token punctuation">,</span>
              outputPath<span class="token operator">:</span><span class="token string">'images/'</span><span class="token punctuation">,</span>
              <span class="token comment">// 配置大小限制,超过则按此规则打包</span>
              limit<span class="token operator">:</span><span class="token number">20480</span>
          <span class="token punctuation">}</span>

        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="打包样式文件"><a href="#打包样式文件" class="header-anchor">#</a> 打包样式文件</h3> <p>打包<code>css</code>文件的原理是先通过 <code>css-loader</code> 打包<code>css</code>文件到指定目录,然后通过 <code>style-loader</code> 将样式挂载到<code>header</code>。其他的模块化的<code>sass</code>、<code>less</code>、<code>stylus</code>则需要先转译成<code>css</code>文件然后同样的挂载。</p> <ol><li><strong>打包普通<code>css</code>文件</strong></li></ol> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token operator">...</span>
  module<span class="token operator">:</span><span class="token punctuation">{</span>
    rules<span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">{</span>
      test<span class="token operator">:</span><span class="token regex">/\.css$/</span><span class="token punctuation">,</span>
      <span class="token comment">// loader执行顺序是从下到上 从右到左</span>
      use<span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">'style-loader'</span><span class="token punctuation">,</span><span class="token string">'css-loader'</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>打包后<code>css</code>先通过 loader 打包成 css 代码,然后挂载到 header 上</p> <ol start="2"><li><strong>打包<code>Sass</code>文件,并且配置浏览器兼容性前缀</strong></li></ol> <p>打包<code>Sass</code>文件需要使用到的<code>loader</code>为: <code>Sass-loader</code>,首先先安装</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ <span class="token function">npm</span> <span class="token function">install</span> sass-loader node-sass  --save-dev
</code></pre></div><p>然后开始配置浏览器的兼容性前缀(例如:<code>-webkit-transform: translate(100px,100px)</code>),这里需要使用到<strong>postcss-loader</strong>，然后配合<strong>autoprefixer</strong>插件自动在生成<code>css</code>文件时加上前缀。</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ <span class="token function">npm</span> i -D postcss-loader
$ <span class="token function">npm</span> i -D autoprefixer
</code></pre></div><p>安装之后创建<code>postcss.config.js</code></p> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'autoprefixer'</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><p>最后就是配置<code>webpack.config.js</code>了</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">...</span>
module<span class="token operator">:</span><span class="token punctuation">{</span>
    rules<span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">{</span>
      test<span class="token operator">:</span><span class="token regex">/\.scss$/</span><span class="token punctuation">,</span>
      <span class="token comment">// loader执行顺序是从下到上 从右到左</span>
      use<span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">'style-loader'</span><span class="token punctuation">,</span><span class="token string">'css-loader'</span><span class="token punctuation">,</span><span class="token string">'sass-loader'</span><span class="token punctuation">,</span><span class="token string">'postcss-loader'</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
</code></pre></div><p>改进打包 Scss 文件中的<code>css-loader</code>,这里设置<code>module:true</code>的作用是避免耦合性,(style.avatar) 打包成<code>模块化的css</code>,如果直接引入的话,页面上的其他<code>js</code>模块也使用到了该样式会造成污染。<code>importLoaders:2</code>保证<code>sass</code>文件里面引入的<code>sass</code>文件也能正常打包。</p> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token operator">...</span>
  module<span class="token operator">:</span><span class="token punctuation">{</span>
    rules<span class="token operator">:</span><span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        test<span class="token operator">:</span><span class="token regex">/\.scss$/</span><span class="token punctuation">,</span>
        use<span class="token operator">:</span><span class="token punctuation">[</span>
          <span class="token string">'style-loader'</span><span class="token punctuation">,</span>
          <span class="token punctuation">{</span>
            loader<span class="token operator">:</span><span class="token string">'css-loader'</span><span class="token punctuation">,</span>
            options<span class="token operator">:</span><span class="token punctuation">{</span>
              module<span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token comment">//开启css模块化,</span>
              importLoaders<span class="token operator">:</span><span class="token number">2</span> <span class="token comment">//保证前两个loader一定执行</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token string">'sass-loader'</span><span class="token punctuation">,</span>
          <span class="token string">'postcss-loader'</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ol start="3"><li><strong>打包图标字体文件</strong></li></ol> <p>配置选项:</p> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  entry<span class="token operator">:</span> <span class="token punctuation">{</span>
    main<span class="token operator">:</span> <span class="token string">'./src/index.js'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  module<span class="token operator">:</span> <span class="token punctuation">{</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex">/\.(evt|svg|ttf)$/</span><span class="token punctuation">,</span>
        use<span class="token operator">:</span> <span class="token string">'file-loader'</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex">/\.scss$/</span><span class="token punctuation">,</span>
        use<span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token string">'style-loader'</span><span class="token punctuation">,</span>
          <span class="token punctuation">{</span>
            loader<span class="token operator">:</span> <span class="token string">'css-loader'</span><span class="token punctuation">,</span>
            options<span class="token operator">:</span> <span class="token punctuation">{</span>
              importLoaders<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token string">'scss-loader'</span><span class="token punctuation">,</span>
          <span class="token string">'postcss-loader'</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  output<span class="token operator">:</span> <span class="token punctuation">{</span>
    filename<span class="token operator">:</span> <span class="token string">'bundle.js'</span><span class="token punctuation">,</span>
    path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'dist'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><p>然后直接在页面上正常引入字体文件<code>class</code>即可显示图片</p> <h3 id="webpack-常用插件使用"><a href="#webpack-常用插件使用" class="header-anchor">#</a> Webpack 常用插件使用</h3> <p>插件是帮助我们在<code>webpack</code>打包的节点上做事情的,类似于生命周期钩子。</p> <ul><li><p><a href="https://www.webpackjs.com/plugins/html-webpack-plugin/" target="_blank" rel="noopener noreferrer">html-webpack-plugin<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 帮助在打包过程中自动生成一个<code>html</code>文件,并且将打包生成的<code>js</code>填入</p></li> <li><p><a href="https://github.com/johnagan/clean-webpack-plugin" target="_blank" rel="noopener noreferrer">clean-webpack-plugin<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 帮助在打包之前删除之前打包的文件夹</p></li></ul> <p>使用案例:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token punctuation">{</span>CleanWebpackPlugin<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'clean-webpack-plugin'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> HtmlWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'html-webpack-plugin'</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token operator">...</span>
  plugins<span class="token operator">:</span><span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">CleanWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token comment">// 指定html模板</span>
      template<span class="token operator">:</span><span class="token string">'src/index.html'</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><p>打包后效果:</p> <p><img src="https://raw.githubusercontent.com/imageList/imglist/master/20200723160824.png" alt="20200723160824"></p> <h3 id="其他-重要配置插件"><a href="#其他-重要配置插件" class="header-anchor">#</a> 其他(重要配置插件)</h3> <p><strong>开启 source-map 模式</strong></p> <p><code>source-map</code>的作用一个映射关系。比如源代码的第二行出错,普通情况下打包后在控制台报的错误是打包后的文件中报错代码行,很难去排查源代码错误,这个时候<code>source-map</code>就起作用了,通过配置<code>source-map</code>就可以将打包文件映射到源代码,实现监听源代码的效果。</p> <p>开启<code>source-map</code>很简单,只需要将<code>devtool</code>设置为<code>source-map</code></p> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  entry<span class="token operator">:</span><span class="token punctuation">{</span>
    main<span class="token operator">:</span><span class="token string">'./src/index.js'</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// none则代表关闭</span>
  devtool<span class="token operator">:</span><span class="token string">'source-map'</span>
  <span class="token operator">...</span>
<span class="token punctuation">}</span>

</code></pre></div><p><strong>使用 webpack-dev-server</strong></p> <p>如果使用<code>webpack --watch</code>这个命令去监听<code>打包更新</code>的话不是很好,首先每次都需要手动打开入口<code>html文件</code>,而且打开的协议都是<code>file协议</code>不能支持<code>ajax请求</code>,所以这个时候需要配置<code>devServer</code>去开启一个服务,监听更新。</p> <p><a href="https://www.webpackjs.com/configuration/dev-server/" target="_blank" rel="noopener noreferrer">官网配置<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ cnpm i webpack-dev-server -D
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  devServer<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 提供bundle的目录</span>
    contentBase<span class="token operator">:</span> <span class="token string">'./dist'</span><span class="token punctuation">,</span>
    port<span class="token operator">:</span> <span class="token number">8080</span><span class="token punctuation">,</span>
    open<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token comment">// 配置跨域</span>
    proxy<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token string">'/api'</span><span class="token operator">:</span> <span class="token string">'http://localhost:3000'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>热模块更新</strong> 🍎</p> <p>在<code>webpack</code>中开启热模块更新,首先需要引入<code>webpack</code>,然后配置<code>devServer</code>，之后需要使用到<code>HotModuleReplacement</code>进行热更新模块加载</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> webpack <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack'</span><span class="token punctuation">)</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  devServer<span class="token operator">:</span> <span class="token punctuation">{</span>
    port<span class="token operator">:</span> <span class="token number">8080</span><span class="token punctuation">,</span>
    contentBase<span class="token operator">:</span> <span class="token string">'./dist'</span><span class="token punctuation">,</span>
    <span class="token comment">// 开启热更新</span>
    hot<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token comment">// 每次更新,浏览器不会重复刷新</span>
    hotOnly<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>HotModuleReplcaement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><p>例子: 当你只需要改变一个模块代码时,不想影响另一个模块的代码,并且不希望浏览器自动刷新，这时就需要配置<code>HotModuleReplcaement</code></p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p><code>css</code>模块的更新就不需要这样处理,因为他们的<code>loader</code>内置了对模块的监控更新操作</p></div> <p>index.js</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token string">'./number'</span>
<span class="token keyword">import</span> <span class="token string">'./test'</span>

<span class="token comment">// 我只希望更新test,然后监听test模块更新去执行新的业务逻辑</span>
</code></pre></div><p>首先配置热模块更新</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> webpack <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack'</span><span class="token punctuation">)</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  devServer<span class="token operator">:</span><span class="token punctuation">{</span>
    port<span class="token operator">:</span><span class="token number">8080</span><span class="token punctuation">,</span>
    contentBase<span class="token operator">:</span><span class="token string">'./dist'</span><span class="token punctuation">,</span>
    hot<span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span>
    hotOnly<span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span>
    open<span class="token operator">:</span><span class="token boolean">true</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token operator">...</span>
  plugins<span class="token operator">:</span><span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>HotModuleReplacement</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><p>然后配置完成之后在<code>index.js</code>上挂上一个钩子监听</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">if</span><span class="token punctuation">(</span>module<span class="token punctuation">.</span>hot<span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token comment">// 监听模块更新触发钩子函数 第一个参数是指定模块的路径 第二个是func</span>
  module<span class="token punctuation">.</span>hot<span class="token punctuation">.</span><span class="token function">accept</span><span class="token punctuation">(</span><span class="token string">'./number'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    <span class="token operator">...</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>热更新的原理(<strong>重点</strong>):</p> <p><strong>使用 Babel 处理 ES6</strong></p> <p>首先需要安装<code>babel-loader</code>搭建<code>babel</code>和<code>webpack</code>之间的桥梁,然后配置<code>babel-presset</code>进行语法翻译，追后需要使用<code>babel-polyfill</code>进行低版本兼容性处理</p> <p>首先安装相关包 @babel-</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> --save-dev babel-loader @babel/core  @babel/preset-env @babel-polyfill
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token operator">...</span>
  module<span class="token operator">:</span><span class="token punctuation">{</span>
    rules<span class="token operator">:</span><span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex">/\.js$/</span><span class="token punctuation">,</span>
        <span class="token comment">// 配置不需要使用babel转译的路径</span>
        exclude<span class="token operator">:</span> <span class="token regex">/node_modules/</span><span class="token punctuation">,</span>
        loader<span class="token operator">:</span> <span class="token string">&quot;babel-loader&quot;</span><span class="token punctuation">,</span>
        options<span class="token operator">:</span><span class="token punctuation">{</span>
          <span class="token comment">// 翻译规则 然后按需加载polyfill</span>
          presets<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'@babel/preset-env'</span><span class="token punctuation">,</span><span class="token punctuation">{</span>
            useBuiltIns<span class="token operator">:</span><span class="token string">'usage'</span>
          <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
        <span class="token punctuation">}</span>

      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><p>然后需要在入口文件中引入<code>@babel/polyfill</code>即可实现<code>ES6</code>转为<code>ES5</code></p> <p>Babel 原理(<strong>重点</strong>):</p> <p><strong>TreeShaking</strong></p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last update:</span> <span class="time">7/22/2020, 8:59:20 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/guide/vue/vue.html" class="prev">
        vue 基础部分
      </a></span> <span class="next"><a href="/guide/node/koa.html">
        基础
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/assets/js/app.81dd3622.js" defer></script><script src="/assets/js/2.d1b1e148.js" defer></script><script src="/assets/js/32.d42beb3f.js" defer></script><script src="/assets/js/4.a3faee54.js" defer></script>
  </body>
</html>
