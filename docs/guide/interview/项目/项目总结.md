# 项目总结

[[toc]]

## 悦读ECUT

### 使用flyio改造wx.request请求库

由于原生 `wx.request` 是基于 request库进行开发的，并不支持 `promise`,所以在调用这个API的时候会比较麻烦，这里借助到一个请求库并将它改根据自己的需求封装自己的请求方法。

方法： 1. 创建fly实例，需要利用 `mpvuePlatform` 判断是否是 `wx平台`
      2. 使用fly请求数据，返回一个Promise对象，对响应数据做处理 

```js
function createFly () {
  // 判断平台
  if (mpvuePlatform === 'wx') {
    const Fly = require('flyio/dist/npm/wx')
    return new Fly()
  } else {
    return null
  }
}
function hanldeError (err) {
  console.log(err)
}
// 封装get请求
export function get (url, params = {}) {
  const fly = createFly()
  if (fly) {
    return new Promise((resolve, reject) => {
      fly.get(url, params).then(response => {
        if (response && response.data) {
          resolve(response)
        } else {
          const msg = (response && response.data && response.data.msg) || '请求失败'
          mpvue.showToast({
            title: msg,
            duration: 2000
          })
          reject(response)
        }
      }).catch(err => {
        hanldeError(err)
        reject(err)
      })
    })
  }
}
```

### 引入lin-ui和vant组件库部分组件配合完成页面开发

### 首页图书展示动态多栏布局

因为首页布局会遇到很多种不同分栏情况，比如一行分四栏，或者两行两列

![](https://image.yangxiansheng.top/img/20210113232140.png?imglist)

解决办法：编写一个通用组件，**传入行和列，根据传入的行和列将数据改造成对应的多维数组，多维数组的元素个数就是行，每个元素数组的元素个数就是列**。然后使用 `flex` 布局进行布局。左右布局和上下布局可以通过传入一个 `mode`控制 ，然后使用 `v-if` 配合 `flex布局`进行控制。

改造数据：

```js
    bookData () {
      // 将数组数据结构转换成想要的数据结构(传入行列)
      if (this.data && this.data.length > 0) {
        this.data.forEach((item) => {
          // 增加中文分类名属性
          item.text = CATEGORY[item.categoryText.toLowerCase()]
        })
        const number = this.row * this.col
        const _bookdata = this.data.slice(0, number)
        const _BookDataByRow = []
        let _row = 0
        while (_row < this.row) {
          _BookDataByRow.push(
            _bookdata.slice(_row * this.col, _row * this.col + this.col)
          )
          _row++
        }
        return _BookDataByRow
      } else {
        return []
      }
    }
```

配合 `template` 布局

```vue
   <div class="home-book-content">
      <div class="home-book-row"
           v-for="(item,index) in bookData"
           :key="index">
        <div class="home-book-col"
             :style="{flex :'0 0 '+(100/col)+'%'}"
             v-for="(book,index1) in item"
             :key="index1">
          <div class="home-book-wrapper"
               :style="{flexDirection : Mode ==='col' ?'row':'column'}"
               v-if=" Mode==='row'|| Mode==='col'">
            <van-image @click="ToDetail(book)" v-if="Mode === 'row' && colStyle"  width="101" height="147" fit="cover" lazy-load :src="book.cover"></van-image>
              <van-image @click="ToDetail(book)" v-if="Mode === 'row' && !colStyle"  width="68" height="99" fit="cover" lazy-load :src="book.cover"></van-image>
             <van-image @click="ToDetail(book)" v-if="Mode === 'col'" width="64" height="88" fit="cover" lazy-load :src="book.cover"></van-image>
            <div class="book-title-wrapper book-title-row"
                 v-if="Mode === 'row'">
              <div class="book-title">
                {{book.title}}
              </div>
            </div>
            <!-- 两栏布局 -->
            <div class="book-title-wrapper book-title-col"
                 v-if="Mode === 'col'">
              <div class="book-title">
                {{book.title}}
              </div>
              <div class="book-author">
                {{book.author}}
              </div>
              <div class="book-cate">
                {{book.categoryText}}
              </div>
            </div>
          </div>
          <div class="category-wrappper"
               @click.stop="toTypeList(book)"
               v-if="Mode==='cate'">
                   <div class="cate-text">{{book.text}}</div>
            <div class="cate-num">{{book.num}}本书</div>
          
            <div class="image-wrapper">
              <div class="img1">
                <imageview :src="book.cover"></imageview>
              </div>
              <div class="img2">
                <imageview :src="book.cover2"></imageview>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
```

### 利用开源库epubjs完成阅读器目录，主题，进度条，字体开发

目录部分：



切换主题：

进度条拖拽：

切换字号字体：


### 使用小程序 wx.getBackgroundAudioManager 完成音乐播放器兼歌单开发

播放器进度条拖拽：

随机播放：

## student-admin

### 利用routes.addRoute()改造原项目的动态路由

利用 addRoute 配合Vuex改造登录请求方法，根据权限跳转到指定的页面

根据用户角色生成对应动态路由，渲染页面


### 使用element-ui完成复杂表单表格文件上传等开发

### 对接口使用模块化的形式进行封装，并完成前端项目的统一异常处理

### 使用springboot+jpa独立完成管理系统的25个接口开发

### 引入Echart库完成学生首页成绩分析大屏数据


## 解忧炸货铺

### 原生微信程序使用JWT令牌方式校验身份

### 改造原生请求库，统一异常处理和实现二次重刷机制

### 使用锁思想对触底加载更多需求抽象出分页请求方法

### 对返回的SPU和对应的SKU数据进行改造，完成SKU面板展示和联动选择效果

SPU和SKU关系梳理

利用面向对象的思想改造服务端数据，清晰结构方便使用

利用矩阵和排列组合完成联动效果

### 合理使用Storage对购物车模块进行封装，并且实现本地和服务端同步

购物车和本地缓存管理

购物车商品选中全选等操作实现状态更新

购物车和服务器数据同步




