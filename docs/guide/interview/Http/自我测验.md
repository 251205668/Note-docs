## 12.21网络

1. TCP面向连接，面向字节流，有状态，具备拥塞控制能力，可以保证可靠交付，点对点传播，有序
2. UDP无连接，面向数据包，无状态，不能保证可靠交付，不具备拥塞控制能力，广播、多波，无序

1. HTTP建立在应用层，TCP建立在传输层协议
2. HTTP是建立在TCP的基础的
3. HTTP协议包含了数据的分发，TCP协议只负责连接

HTTP请求报文： 请求行、请求头、空行、请求数据

请求行是由：请求方法字段+URL+HTTP协议版本

请求头：每次发送的请求头都会告诉服务器一些客户端的信息

1.user-agent: 请求的浏览器类型

 2.accept： 客户端能识别的内容列表

3.  host;主机地址
4. content-type,代表请求体的MIME类型，常见有：application/json

响应报文： 状态行、响应头、空行、响应正文

1. get请求会被浏览器缓存，请求体的长度有限，浏览器进行回退操作时无害的，一般请求都不会携带请求体，发送一个TCP数据包
2. POST是安全的，编码方式多样，POST请求可以发送较大的数据，浏览在回退操作之后会再次发送一次请求，一般POST请求会携带请求体，POST发送两个TCP数据包

1. 客户端向服务端发送SYN连接包，代表我要向你发起连接了
2. 服务端接收到了客户端的SYN包直接，确认建立连接，将自己的SYN包和确认包ACK发送给客户端
3. 为了检验双方都有收发能力，客户端再次向服务端发送ACK确认包，表示三次握手成功

否，如果在没有缓存的情况下，请求头设置了`connnection:keep-alive`，第二次请求之后就不会三次握手了

第二次和第二次是不可以的，第三次双方都已经进入establish状态，这个时候是可以发送数据的

DNS：

DNS是域名转为为IP地址服务，简称域名系统，DNS协议依赖UDP协议，涉及到的端口号是53

1. 本地输入一个IP地址，电脑向本地DNS服务器发送一个请求
2. 本地DNS服务器如果有缓存，就直接返回结果，如果没有就像跟服务器发送请求
3. 跟服务器上如果也没有域名和IP地址的关系，就会告诉本地继续要域服务器发送请求查找，并且返回域服务器的地址
4. 本地DNS服务器向域服务器发送请求，返回解析的域名服务器的IP地址
5. 本地DNS向域名服务器发送请求，返回IP和域名关系
6. 本地DNS服务器将整个IP地址返回给电脑，然后缓存备份，以便下次使用

因为TCP协议会有连接时延

- 获取一个IP地址，向多个域名服务器发送请求，这样每次请求都会产生连接时延，这样会造成堵塞
- 本地获取IP地址，通常是在浏览器输入地址，然后发送情求，如果使用TCP的话，浏览器请求页面会很慢

CND：简称内容分发网络，是一组分布在不同的地理位置的web服务器

CDN解决了什么：由于服务器距离越远，延迟越高，CDN就是为了解决这一现状，从而缩短请求时间

CDN原理

1. 浏览器输入IP地址，向本地DNS服务器发送请求
2. 本地DNS服务器会依次向跟服务器，顶级域名服务器，权限服务器发送请求，获取到全局负载均衡的IP地址
3. 本地DNS系统会向全局负载均衡系统发送请求，获取到最近的本地负载均衡系统的IP地址
4. 本地DNS会向本地负载均衡系统发送请求
5. 本地负载均衡系统会返回一个最有效的缓存服务器地址给浏览器
6. 本地DNS向缓存服务器发送请求
7. 如果缓存服务器上有该ip的记录，会直接返还资源给浏览器，否则会请求原服务器，返还资源



Keep-alive ：持续连接，高效复用模式，持续连接能够维持客户端和服务端的持久连接，高效指的是，当浏览器再次向服务端发送请求时，不会去从新创建TCP连接，而是直接复用同一个连接，减少开销

TCP侧重于持续连接，会不定时的发送一个心跳包检测双方是否断开连接，如果不这样样做会对服务器资源影响很大

HTTP侧重于复用

URL：协议+IP地址/域名+地址+端口号+参数+锚点

对头阻塞：每个HTTP请求，都会任务队列的形式进行串行执行，每当对头请求过慢，就会阻塞后续请求操作

- 并发连接
- 域名分片
